{
  "content": [
    {
      "type": "text",
      "text": "# Spinach (software)\n\n|latest release version = 2.8\n|latest release date    =\n|programming language = Matlab\n|operating system = Windows, Linux, macOS\n|language = English\n|genre = Magnetic resonance\n|developer = Ilya Kuprov (lead developer)\n|license = MIT License\n|website =\n}}\nSpinach is an open-source magnetic resonance simulation package initially released in 2011 and continuously updated since. The package is written in Matlab and makes use of the built-in parallel computing and GPU interfaces of Matlab.\nThe name of the package whimsically refers to the physical concept of spin and to  Popeye the Sailor who, in the eponymous comic books, becomes stronger after consuming spinach.\nNMR spectrum of strychnine alkaloid simulated using Spinach.]]\nOverview\nSpinach implements magnetic resonance spectroscopy and imaging simulations by solving the equation of motion for the density matrix \\mathbf{\\rho }\\left( t \\right) in the time domain:\n\\begin{matrix}\n\\frac{\\partial }{\\partial t}\\mathbf{\\rho }\\left( t \\right)=-i\\mathbf{L}\\left( t \\right)\\mathbf{\\rho }\\left( t \\right) \\\\\n\\Downarrow  \\\\\n\\mathbf{\\rho }\\left( t+dt \\right)=\\exp \\left[ -i\\mathbf{L}\\left( t \\right)dt \\right]\\mathbf{\\rho }\\left( t \\right) \\\\\n\\end{matrix}\nwhere the Liouvillian superoperator \\mathbf{L}\\left( t \\right) is a sum of the Hamiltonian commutation superoperator \\mathbf{H}\\left( t \\right), relaxation superoperator \\mathbf{R}, kinetics superoperator \\mathbf{K}, and potentially other terms that govern spatial dynamics and coupling to other degrees of freedom:\n\\mathbf{L}\\left( t \\right)=\\mathbf{H}\\left( t \\right)+i\\mathbf{R}+i\\mathbf{K}+...\nComputational efficiency is achieved through the use of reduced state spaces, sparse matrix arithmetic, on-the-fly trajectory analysis, and dynamic parallelization.\nStandard functionality\nAs of 2023, Spinach is cited in over 300 academic publications. According to the documentation and academic papers citing its features, the most recent version 2.8 of the package performs:\n* Time-domain nuclear magnetic resonance (NMR) simulations of:\n** Standard NMR experiments (DEPT, COSY, NOESY, HSQC, TOCSY, etc.).\n** Protein and nucleic acid NMR experiments (HNCA, HNCOCA, HNCO, etc.).\n** Magic angle spinning NMR experiments (CP-MAS, MQMAS, WISE, etc.).\n** Experiments involving residual dipolar coupling and other residual order effects.\n** Zero- and ultra-low field experiments, including Earth's field NMR.\n** Nuclear quadrupole resonance, including overtone NMR.\n* Time-domain magnetic resonance imaging (MRI) simulations, including:\n** Standard and user-specified imaging sequences.\n** Diffusion coefficient and diffusion tensor imaging.\n** Three-dimensional point-resolved NMR spectroscopy.\n** Ultrafast spatially encoded NMR spectroscopy.\n* Time-domain electron spin resonance (ESR) simulations of:\n** Standard pulsed ESR experiments (HYSCORE, ENDOR, ESEEM, etc.).\n** Pulsed dipolar spectroscopy (DEER, RIDME, etc.).\n** Dynamic nuclear polarization for static and spinning samples.\nCommon models of spin relaxation (Redfield theory, stochastic Liouville equation, Lindblad theory) and chemical kinetics are supported, and a library of powder averaging grids is included with the package.\nOptimal control module\nSpinach contains an implementation the gradient ascent pulse engineering (GRAPE) algorithm for quantum optimal control. The documentation and the book describing the optimal control module of the package list the following features:\n* L-BFGS quasi-Newton and Newton-Raphson GRAPE optimizers.\n* Spin system trajectory analysis by coherence and correlation order.\n* Spectrogram analysis of the pulse waveform.\n* Prefixes, suffixes, keyholes, and freeze masks.\n* Optimization of cooperative pulses and phase cycles.\n* Waveform penalty functionals and instrument response.\nDissipative background evolution generators and control operators are supported, as well as ensemble control over distributions in common instrument calibration parameters, such as control channel power and offset.\nReferences"
    }
  ]
}