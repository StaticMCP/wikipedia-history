{
  "content": [
    {
      "type": "text",
      "text": "# Kingman's subadditive ergodic theorem\n\nIn mathematics, '''Kingman's subadditive ergodic theorem''' is one of several ergodic theorems. It can be seen as a generalization of Birkhoff's ergodic theorem.\nIntuitively, the subadditive ergodic theorem is a kind of random variable version of Fekete's lemma (hence the name ergodic). As a result, it can be rephrased in the language of probability, e.g. using a sequence of random variables and expected values.  The theorem is named after John Kingman.\nStatement of theorem\nLet T be a measure-preserving transformation on the probability space (\\Omega,\\Sigma,\\mu), and let \\{g_n\\}_{n\\in\\mathbb{N}} be a sequence of L^1 functions such that g_{n+m}(x)\\le g_n(x)+g_m(T^nx) (subadditivity relation). Then\n: \\lim_{n\\to\\infty}\\frac{g_n(x)}{n}=:g(x)\\ge-\\infty\nfor \\mu-a.e. x, where g(x) is T-invariant.\nIn particular, if T is ergodic, then g(x) is a constant.\nEquivalent statement\nGiven a family of real random variables X(m, n), with 0 \\leq m , such that they are subadditive in the sense that\\begin{aligned}\n& X(m+1, n+1)=X(m, n) \\circ T \\\\\n& X(0, n) \\leq X(0, m)+X(m, n)\n\\end{aligned}Then there exists a random variable Y such that Y \\in [-\\infty, +\\infty), Y is invariant with respect to T, and \\lim_n \\frac 1n X(0, n) = Y a.s..\nThey are equivalent by setting\n* g_n = X(0, n) with n \\geq 1;\n* X(m, m+n) = g_n \\circ T^m with m \\geq 0.\nProof\nProof due to (J. Michael Steele, 1989).\nSubadditivity by partition\nFix some n\\geq 1. By subadditivity, for any l\\in 1:n-1\ng_n \\leq g_{n-l} + g_l \\circ T^{n-l}\nWe can picture this as starting with the set 0:n-1, and then removing its lengthl tail.\nRepeating this construction until the set 0:n-1 is all gone, we have a one-to-one correspondence between upper bounds of g_n and partitions of 1:n-1.\nSpecifically, let \\{k_i : (k_i + l_i - 1)\\}_i be a partition of 0:n-1, then we have\ng_n \\leq \\sum_i g_{l_i}\\circ T^{k_i}\nConstructing g\nLet g := \\liminf g_n/n, then it is T-invariant.\nBy subadditivity, \\frac{g_{n+1}}{n+1} \\leq\\frac{g_1 + g_n \\circ T}{n+1}\nTaking the n\\to \\infty limit, we have g \\leq g\\circ T We can visualize T as hill-climbing on the graph of g. If T actually causes a nontrivial amount of hill-climbing, then we would get a spatial contraction, and so T does not preserve measure. Therefore g = g\\circ T a.e.\nLet c\\in \\R, then \\{g \\geq c\\} \\subset \\{g\\circ T \\geq c\\} = T^{-1}(\\{g \\geq c\\}) and since both sides have the same measure, by squeezing, they are equal a.e..\nThat is, g(x) \\geq c \\iff g(Tx) \\geq c, a.e..\nNow apply this for all rational c.\nReducing to the case of gn ≤ 0\nBy subadditivity, using the partition of 0:n-1 into singletons.\n\\begin{aligned}\ng_1 &\\leq g_1 \\\\\ng_2 &\\leq g_1 + g_1 \\circ T \\\\\ng_3 &\\leq g_1 + g_1 \\circ T + g_1 \\circ T^2 \\\\\n& \\cdots\n\\end{aligned}\nNow, construct the sequence\n\\begin{aligned}\nf_1 &= g_1 - g_1 \\\\\nf_2 &= g_2 - (g_1 + g_1 \\circ T) \\\\\nf_3 &= g_3 - (g_1 + g_1 \\circ T + g_1 \\circ T^2) \\\\\n& \\cdots\n\\end{aligned}\nwhich satisfies f_n \\leq 0 for all n.\nBy the special case, f_n/n converges a.e. to a T-invariant function.\nBy Birkhoff's pointwise ergodic theorem, the running average \\frac 1n (g_1 + g_1 \\circ T + g_1 \\circ T^2 + \\cdots ) converges a.e. to a T-invariant function. Therefore, their sum does as well.\nBounding the truncation\nFix arbitrary \\epsilon, M > 0, and construct the truncated function, still T-invariant: g' := \\max(g, -M) With these, it suffices to prove an a.e. upper bound\\limsup g_n/n \\leq g' + \\epsilonsince it would allow us to take the limit \\epsilon = 1/1, 1/2, 1/3, \\dots, then the limit M = 1, 2, 3, \\dots, giving us a.e.\n\\limsup g_n/n \\leq \\liminf g_n/n =: g\nAnd by squeezing, we have g_n/n converging a.e. to g.\nDefine two families of sets, one shrinking to the empty set, and one growing to the full set. For each \"length\" L = 1, 2, 3, \\dots, defineB_L := \\{x : g_l/l > g' + \\epsilon, \\forall l \\in 1, 2, \\dots, L\\} A_L := B_L^c = \\{x : g_l/l \\leq g' + \\epsilon, \\exists l \\in 1, 2, \\dots, L\\}Since g' \\geq \\liminf g_n/n, the B family shrinks to the empty set.\nFix x \\in X. Fix L \\in \\N. Fix n > L. The ordering of these qualifiers is vitally important, because we will be removing the qualifiers one by one in the reverse order.\nTo prove the a.e. upper bound, we must use the subadditivity, which means we must construct a partition of the set 0:n-1. We do this inductively:Take the smallest k not already in a partition.If T^k x \\in A_N, then g_l(T^k x)/l \\leq g'(x) + \\epsilon for some l\\in 1, 2, \\dots L. Take one such l – the choice does not matter.If k+l-1 \\leq n-1, then we cut out \\{k, \\dots, k+l-1\\}. Call these partitions \"type 1\". Else, we cut out \\{k\\}. Call these partitions \"type 2\".Else, we cut out \\{k\\}. Call these partitions \"type 3\".\nNow convert this partition into an inequality:\ng_n(x) \\leq \\sum_i g_{l_i}(T^{k_i}x)\nwhere k_i are the heads of the partitions, and l_i are the lengths.\nSince all g_n \\leq 0, we can remove the other kinds of partitions:\ng_n(x) \\leq \\sum_{i: \\text{type 1}} g_{l_i}(T^{k_i}x)\nBy construction, each g_{l_i}(T^{k_i}x) \\leq l_i(g'(x) + \\epsilon), thus\n\\frac 1n g_n(x) \\leq g'(x) \\frac 1n \\sum_{i: \\text{type 1}} l_i + \\epsilon\nNow it would be tempting to continue with g'(x) \\frac 1n \\sum_{i: \\text{type 1}} l_i \\leq g'(x), but unfortunately g' \\leq 0, so the direction is the exact opposite. We must lower bound the sum \\sum_{i: \\text{type 1}} l_i.\nThe number of type 3 elements is equal to\n\\sum_{k\\in 0:n-1} 1_{B_L}(T^k x)\nIf a number k is of type 2, then it must be inside the last L-1 elements of 0:n-1. Thus the number of type 2 elements is at most L-1.\nTogether, we have the lower bound:\n\\frac 1n  \\sum_{i: \\text{type 1}} l_i \\geq 1 - \\frac{L-1}{n} - \\frac 1n \\sum_{k\\in 0:n-1} 1_{B_L}(T^k x)\nPeeling off the first qualifier\nRemove the n>L qualifier by taking the n\\to \\infty limit.\nBy Birkhoff's pointwise ergodic theorem, there exists an a.e. pointwise limit\n\\lim_n \\frac 1n \\sum_{k\\in 0:n-1} 1_{B_L}(T^k x) \\to \\bar 1_{B_L}(x)\nsatisfying\n\\int \\bar 1_{B_L}  = \\mu(B_L); \\quad \\bar 1_{B_L}(x) \\in [0, 1]\nAt the limit, we find that for a.e. x\\in X, L \\in \\N,\n\\limsup_n \\frac{g_n(x)}{n} \\leq g'(x) (1- \\bar 1_{B_L}(x) )  + \\epsilon\nPeeling off the second qualifier\nRemove the L \\in \\N qualifier by taking the L\\to \\infty limit.\nSince we have\n\\int \\bar 1_{B_L}  = \\mu(B_L) \\to 0\nand \\bar 1_{B_L} \\geq \\bar 1_{B_{L+1}} \\geq \\cdots as 1_{B_{L}} \\geq 1_{B_{L+1}} \\geq \\cdots, we can apply the same argument used for proving Markov's inequality, to obtain\n\\limsup_n \\frac{g_n(x)}{n} \\leq g'(x)  + \\epsilon\nfor a.e. x\\in X.\nIn detail, the argument is as follows: since \\bar 1_{B_L} \\geq \\bar 1_{B_{L+1}} \\geq \\cdots \\geq 0, and  \\int \\bar 1_{B_L} \\to 0, we know that for any small \\delta, \\delta' > 0, all large enough L satisfies \\bar 1_{B_L}(x)  everywhere except on a set of size \\geq \\delta'. Thus,\n\\limsup_n \\frac{g_n(x)}{n} \\leq g'(x)(1-\\delta)  + \\epsilon\nwith probability \\geq 1-\\delta'. Now take both \\delta, \\delta' \\to 0.\nApplications\nTaking g_n(x):=\\sum_{j=0}^{n-1}f(T^jx) recovers Birkhoff's pointwise ergodic theorem.\nTaking all g_n constant functions, we recover the Fekete's subadditive lemma.\nKingman's subadditive ergodic theorem can be used to prove statements about Lyapunov exponents. It also has applications to percolations and longest increasing subsequence.\nLongest increasing subsequence\nTo study the longest increasing subsequence of a random permutation \\pi, we generate it in an equivalent way. A random permutation on 1:n is equivalently generated by uniformly sampling n points in a square, then find the longest increasing subsequence of that.\nNow, define the Poisson point process with density 1 on [0, \\infty)^2, and define the random variables M^*_k to be the length of the longest increasing subsequence in the square [0, k)^2. Define the measure-preserving transform T by shifting the plane by (-1, -1), then chopping off the parts that have fallen out of [0, \\infty)^2.\nThe process is subadditive, that is,  M_{k+m}^* \\geq M_{k}^* + M_{m}^* \\circ T^k. To see this, notice that the right side constructs an increasing subsequence first in the square [0, k)^2, then in the square [k, k+m)^2, and finally concatenate them together. This produces an increasing subsequence in [0, k+m)^2, but not necessarily the longest one.\nAlso, T is ergodic, so by Kingman's theorem, M_k^* /k converges to a constant almost surely. Since at the limit, there are n = k^2 points in the square, we have L_n^* / \\sqrt n converging to a constant almost surely.\nReferences"
    }
  ]
}