{
  "content": [
    {
      "type": "text",
      "text": "# Kolmogorov backward equations (diffusion)\n\nThe Kolmogorov backward equation (KBE) and its adjoint, the Kolmogorov forward equation, are partial differential equations (PDE) that arise in the theory of continuous-time continuous-state Markov processes.  Both were published by Andrey Kolmogorov in 1931.  Later it was realized that the forward equation was already known to physicists under the name Fokker&ndash;Planck equation;  the KBE on the other hand was new.\nOverview\nThe Kolmogorov forward equation is used to evolve the state of a system forward in time. Given an initial probability distribution p_t(x) for a system being in state x at time t, the forward PDE is integrated to obtain p_s(x) at later times s>t. A common case takes the initial value p_t(x) to be a Dirac delta function centered on the known initial state x.\nThe Kolmogorov backward equation is used to estimate the probability of the current system evolving so that it's future state at time s>t is given by some fixed probability function p_s(x). That is, the probability distribution in the future is given as a boundary condition, and the backwards PDE is integrated backwards in time.\nA common boundary condition is to ask that the future state is contained in some subset of states B, the target set. Writing the set membership function as 1_B, so that 1_B(x)=1 if x\\in B and zero otherwise, the backward equation expresses the hit probability p_t(x) that in the future, the set membership will be sharp, given by p_s(x) = 1_B(x)/\\Vert B\\Vert. Here, \\Vert B\\Vert is just the size of the set B, a normalization so that the total probability at time s integrates to one.\nKolmogorov backward equation\nLet \\{X_{t}\\}_{0 \\le t \\le T} be the solution of the stochastic differential equation\n:\ndX_t \\;=\\; \\mu\\bigl(t, X_t\\bigr)\\,dt \\;+\\; \\sigma\\bigl(t, X_t\\bigr)\\,dW_t,\n\\quad 0 \\;\\le\\; t \\;\\le\\; T,\nwhere W_t is a (possibly multi-dimensional) Wiener process (Brownian motion), \\mu is the drift coefficient, and \\sigma is related to the diffusion coefficient D as D=\\sigma^2/2. Define the transition density (or fundamental solution) p(t,x;\\,T,y) by\n:\np(t,x;\\,T,y)\n\\;=\\;\n\\frac{\\mathbb{P}[\\,X_T \\in dy \\,\\mid\\, X_t = x\\,]}{dy},\n\\quad\nt\nThen the usual Kolmogorov backward equation for p is\n:\n\\frac{\\partial p}{\\partial t}(t, x;\\,T, y)\n\\;+\\;\nA\\, p(t, x;\\,T, y)\n\\;=\\;\n0,\n\\quad\n\\lim_{t \\to T}\\, p(t,x;\\,T,y)\n\\;=\\;\n\\delta_{y}(x),\nwhere \\delta_{y}(x) is the Dirac delta in x centered at y, and A is the infinitesimal generator of the diffusion:\n:\nA\\,f(x)\n\\;=\\;\n\\sum_{i}\\,\\mu_{i}(x)\\,\\frac{\\partial f}{\\partial x_{i}}(x)\n\\;+\\;\n\\frac12\\,\\sum_{i,j}\\,\n\\bigl[\\sigma(x)\\,\\sigma(x)^{\\mathsf{T}}\\bigr]_{ij}\\,\n\\frac{\\partial^2 f}{\\partial x_{i}\\,\\partial x_{j}}(x).\nFeynman–Kac formula\nThe backward Kolmogorov equation can be used to derive the Feynman–Kac formula. Given a function F that satisfies the boundary value problem\n:\n\\frac{\\partial F}{\\partial t}(t,x)\n\\;+\\;\n\\mu(t,x)\\,\\frac{\\partial F}{\\partial x}(t,x)\n\\;+\\;\n\\frac{1}{2}\\,\\sigma^2(t,x)\\,\\frac{\\partial^2 F}{\\partial x^2}(t,x)\n\\;=\\;\n0,\n\\quad\n0 \\le t \\le T,\n\\quad\nF(T,x) \\;=\\; \\Phi(x)\nand given \\{X_t\\}_{0 \\le t \\le T}, that, just as before, is a solution of\n:\ndX_t \\;=\\; \\mu(t, X_t)\\,dt \\;+\\; \\sigma(t, X_t)\\,dW_t,\n\\quad\n0 \\le t \\le T,\nthen if the expectation value is finite\n:\n\\int_{0}^{T}\\,\n\\mathbb{E}\\!\\Bigl[\n\\bigl(\\sigma(t, X_t)\\,\\frac{\\partial F}{\\partial x}(t, X_t)\\bigr)^2\n\\Bigr]\\,\ndt\n\\;\nthen the Feynman–Kac formula is obtained:\n:\nF(t,x)\n\\;=\\;\n\\mathbb{E}\\!\\bigl[\\;\\Phi(X_T)\\,\\big|\\;X_t = x\\bigr].\nProof. Apply Itô’s formula to F(s, X_s) for t \\le s \\le T:\n:\nF(T, X_T)\n\\;=\\;\nF(t, X_t)\n\\;+\\;\n\\int_{t}^{T}\\!\\Bigl\\{\n\\frac{\\partial F}{\\partial s}(s, X_s)\n\\;+\\;\n\\mu(s, X_s)\\,\\frac{\\partial F}{\\partial x}(s, X_s)\n\\;+\\;\n\\tfrac12\\,\\sigma^2(s, X_s)\\,\\frac{\\partial^2 F}{\\partial x^2}(s, X_s)\n\\Bigr\\}\\,ds\n\\;+\\;\n\\int_{t}^{T}\\!\\sigma(s, X_s)\\,\\frac{\\partial F}{\\partial x}(s, X_s)\\,dW_s.\nBecause F solves the PDE, the first integral is zero.  Taking conditional expectation and using the martingale property of the Itô integral gives\n:\n\\mathbb{E}\\!\\bigl[F(T, X_T)\\,\\big|\\;X_t=x\\bigr]\n\\;=\\;\nF(t, x).\nSubstitute F(T, X_T) = \\Phi(X_T) to conclude\n:\nF(t,x)\n\\;=\\;\n\\mathbb{E}\\!\\bigl[\\;\\Phi(X_T)\\,\\big|\\;X_t = x\\bigr].\nDerivation of the backward Kolmogorov equation\nThe Feynman–Kac representation can be used to find the PDE solved by the transition densities of solutions to SDEs. Suppose\n:\ndX_t \\;=\\;\n\\mu(t, X_t)\\,dt\n\\;+\\;\n\\sigma(t, X_t)\\,dW_t.\nFor any set B, define\n:\np_B(t, x;\\,T)\n\\;\\triangleq\\;\n\\mathbb{P}\\!\\bigl[X_T \\in B \\,\\mid\\, X_t = x\\bigr]\n\\;=\\;\n\\mathbb{E}\\!\\bigl[\\mathbf{1}_B(X_T)\\,\\big|\\;X_t = x\\bigr].\nBy Feynman–Kac (under integrability conditions), taking \\Phi=\\mathbf{1}_B, then\n:\n\\frac{\\partial p_B}{\\partial t}(t, x;\\,T)\n\\;+\\;\nA\\,p_B(t, x;\\,T)\n\\;=\\;0,\n\\quad\np_B(T, x;\\,T)\n\\;=\\;\\mathbf{1}_B(x),\nwhere\n:\nA\\,f(t, x)\n\\;=\\;\n\\mu(t, x)\\,\\frac{\\partial f}{\\partial x}(t, x)\n\\;+\\;\n\\tfrac12\\,\\sigma^2(t, x)\\,\\frac{\\partial^2 f}{\\partial x^2}(t, x).\nAssuming Lebesgue measure as the reference, write |B| for its measure.  The transition density p(t, x;\\,T, y) is\n:\np(t, x;\\,T, y)\n\\;\\triangleq\\;\n\\lim_{B \\to y}\\,\\frac{1}{|B|}\\,\\mathbb{P}\\!\\bigl[X_T \\in B\\,\\mid\\,X_t = x\\bigr].\nThen\n:\n\\frac{\\partial p}{\\partial t}(t, x;\\,T, y)\n\\;+\\;\nA\\,p(t, x;\\,T, y)\n\\;=\\;0,\n\\quad\np(t, x;\\,T, y)\n\\;\\to\\;\n\\delta_y(x)\n\\quad\n\\text{as } t\\;\\to\\;T.\nDerivation of the forward Kolmogorov equation\nThe Kolmogorov forward equation is\n:\n\\frac{\\partial}{\\partial T}\\,p\\bigl(t, x;\\,T, y\\bigr)\n\\;=\\;\nA^{*}\\!\\bigl[p\\bigl(t, x;\\,T, y\\bigr)\\bigr],\n\\quad\n\\lim_{T \\to t}\\,p(t,x;\\,T,y)\n\\;=\\;\n\\delta_{y}(x).\nFor T > r > t, the Markov property implies\n:\np(t, x;\\,T, y)\n\\;=\\;\n\\int_{-\\infty}^{\\infty}\np\\bigl(t, x;\\,r, z\\bigr)\\,\np\\bigl(r, z;\\,T, y\\bigr)\n\\,dz.\nDifferentiate both sides w.r.t. r:\n:\n0\n\\;=\\;\n\\int_{-\\infty}^{\\infty}\n\\Bigl[\n\\frac{\\partial}{\\partial r}\\,p\\bigl(t, x;\\,r, z\\bigr)\\,\\cdot\\,p\\bigl(r, z;\\,T, y\\bigr)\n\\;+\\;\np\\bigl(t, x;\\,r, z\\bigr)\\,\\cdot\\,\n\\frac{\\partial}{\\partial r}\\,p\\bigl(r, z;\\,T, y\\bigr)\n\\Bigr]\\,dz.\nFrom the backward Kolmogorov equation:\n:\n\\frac{\\partial}{\\partial r}\\,p\\bigl(r, z;\\,T, y\\bigr)\n\\;=\\;\n-\\,A\\,p\\bigl(r, z;\\,T, y\\bigr).\nSubstitute into the integral:\n:\n0\n\\;=\\;\n\\int_{-\\infty}^{\\infty}\n\\Bigl[\n\\frac{\\partial}{\\partial r}\\,p\\bigl(t, x;\\,r, z\\bigr)\\,\\cdot\\,p\\bigl(r, z;\\,T, y\\bigr)\n\\;-\\;\np\\bigl(t, x;\\,r, z\\bigr)\\,\\cdot\\,\nA\\,p\\bigl(r, z;\\,T, y\\bigr)\n\\Bigr]\n\\,dz.\nBy definition of the adjoint operator A^{*}:\n:\n\\int_{-\\infty}^{\\infty}\n\\bigl[\n\\frac{\\partial}{\\partial r}\\,p\\bigl(t, x;\\,r, z\\bigr)\n\\;-\\;\nA^{*}\\,p\\bigl(t, x;\\,r, z\\bigr)\n\\bigr]\\,\np\\bigl(r, z;\\,T, y\\bigr)\n\\,dz\n\\;=\\;\n0.\nSince p(r,z;\\,T,y) can be arbitrary, the bracket must vanish:\n:\n\\frac{\\partial}{\\partial r}\\,p\\bigl(t, x;\\,r,z\\bigr)\n\\;=\\;\nA^{*}\\bigl[p\\bigl(t, x;\\,r,z\\bigr)\\bigr].\nRelabel r \\to T and z \\to y, yielding the forward Kolmogorov equation:\n:\n\\frac{\\partial}{\\partial T}\\,p\\bigl(t, x;\\,T, y\\bigr)\n\\;=\\;\nA^{*}\\!\\bigl[p\\bigl(t, x;\\,T, y\\bigr)\\bigr],\n\\quad\n\\lim_{T \\to t}\\,p(t,x;\\,T,y)\n\\;=\\;\n\\delta_{y}(x).\nFinally,\n:\nA^{*}\\,g(x)\n\\;=\\;\n-\\sum_{i}\\,\\frac{\\partial}{\\partial x_{i}}\n\\bigl[\\mu_{i}(x)\\,g(x)\\bigr]\n\\;+\\;\n\\frac12\\,\n\\sum_{i,j}\\,\n\\frac{\\partial^2}{\\partial x_{i}\\,\\partial x_{j}}\n\\Bigl[\n\\bigl(\\sigma(x)\\,\\sigma(x)^{\\mathsf{T}}\\bigr)_{ij}\\,g(x)\n\\Bigr].\nSee also\n* Feynman–Kac formula\n* Fokker–Planck equation\n* Kolmogorov equations\nReferences\n*"
    }
  ]
}