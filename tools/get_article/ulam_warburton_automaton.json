{
  "content": [
    {
      "type": "text",
      "text": "# Ulam–Warburton automaton\n\nThe Ulam–Warburton cellular automaton (UWCA) is a 2-dimensional fractal pattern that grows on a regular grid of cells consisting of squares. Starting with one square initially ON and all others OFF, successive iterations are generated by turning ON all squares that share precisely one edge with an ON square. This is the von Neumann neighborhood. The automaton is named after the Polish-American mathematician and scientist Stanislaw Ulam and the Scottish engineer, inventor and amateur mathematician Mike Warburton.\n]]\nProperties and relations\nThe UWCA is a 2D 5-neighbor outer totalistic cellular automaton using rule 686.\nThe number of cells turned ON in each iteration is denoted  u(n), with an explicit formula:\nu(0)=0, u(1)=1, and for  n \\ge 2\nu(n) = 4\\cdot 3^{wt(n-1)-1}\nwhere wt(n) is the Hamming weight function which counts the number of 1's in the binary expansion of n\nwt(n)=n-\\sum_{k=1}^{\\infty} \\left\\lfloor\\frac{n}{2^k}\\right\\rfloor\nThe minimum upper bound of summation for k is such that  2^k \\geq n\nThe total number of cells turned ON is denoted  U(n)\nU(n)=\\sum_{i \\mathop =0}^n u(i)  =  \\frac{4}{3}\\sum_{i \\mathop =0}^{n-1} 3^{wt(i)}-\\frac{1}{3}\nTable of wt(n), u(n) and U(n)\nThe table shows that different inputs to wt(n) can lead to the same output.\nThis surjective property emerges from the simple rule of growth – a new cell is born if it shares only one-edge with an existing ON cell - the process appears disorderly and is modeled by functions involving wt(n) but within the chaos there is regularity.\n{| class=\"wikitable\" border=\"2\" style=\"text-align:center\"\n|-\n!n!!wt(n)!!u(n)!!U(n)!!n!!wt(n)!!u(n)!!U(n)\n|-\n| 0 || 0||  0|| 0||10|| 2||  12|| 101\n|-\n| 1 || 1|| 1|| 1||11|| 3||  12||113\n|-\n| 2 || 1|| 4|| 5||12|| 2||  36||149\n|-\n| 3 || 2|| 4|| 9||13|| 3||  12|| 161\n|-\n| 4 || 1|| 12|| 21||14|| 3||  36||197\n|-\n| 5 || 2|| 4|| 25||15|| 4||  36|| 233\n|-\n| 6 || 2||12||37||16|| 1||  108||341\n|-\n| 7 || 3|| 12|| 49||17|| 2||  4|| 345\n|-\n| 8 || 1|| 36|| 85||18|| 2||  12||357\n|-\n| 9|| 2|| 4|| 89||19|| 3||  12||369\n|}\nU(n) is OEIS sequence [https://oeis.org/A147562 A147562] and u(n) is OEIS sequence [https://oeis.org/A147582 A147582]\nCounting cells with quadratics\nFor all integer sequences of the form n_m=m\\cdot2^k where  m \\ge 1 and  k \\ge 0\nLet\na_m=\\sum_{i \\mathop =0}^{m-1} 3^{wt(i)}\n(a_m is OEIS sequence [https://oeis.org/A130665 A130665])\nThen the total number of ON cells in the integer sequence n_m is given by\nU_m(n_m)=\\frac{a_m}{m^2}\\frac{4}{3}n_m^2 - \\frac{1}{3}\nOr in terms of k we have\nU_m(k)=a_m\\frac{4}{3}2^{2k} - \\frac{1}{3}\nTable of integer sequences nm and Um\n{| class=\"wikitable\" border=\"2\" style=\"text-align:center\"\n|-\n!k!!n_1!!U_1!!n_3!!U_3!!n_5!!U_5!!n_7!!U_7\n|-\n| 0 || 1||  1|| 3||9|| 5||  25|| 7||49\n|-\n| 1 || 2|| 5|| 6||37|| 10||  101||14||197\n|-\n| 2 || 4|| 21|| 12||149||20||  405||28||789\n|-\n| 3 || 8|| 85|| 24||597||40|| 1,621|| 56||3,157\n|-\n| 4 || 16|| 341|| 48||2,389||80|| 6,485||112||12,629\n|-\n| 5 || 32|| 1,365|| 96||9,557||160|| 25,941|| 224||50,517\n|}\nUpper and lower bounds\n]]\nU(n) has fractal-like behavior with a sharp upper bound for  n\\ge 1 given by\n: U_\\text{sub}(n)=\\frac{4}{3}n^2-\\frac{1}{3}\nThe upper bound only contacts U(n) at 'high-water' points when n=2^k.\nThese are also the generations at which the UWCA based on squares, the Hex–UWCA based on hexagons and the Sierpinski triangle  return to their base shape.\nLimit superior and limit inferior\nWe have\n:0.9026116569...=\\liminf_{n\\to\\infty}\\frac{U(n)}{n^2}\nThe lower limit was obtained by Robert Price (OEIS sequence [https://oeis.org/A261313 A261313] ) and took several weeks to compute and is believed to be twice the lower limit of  \\frac{T(n)}{n^2}  where T(n) is the total number of toothpicks in the toothpick sequence up to generation  n\nRelationship to\n- generation 11]]\nHexagonal UWCA\nThe Hexagonal-Ulam–Warburton cellular automaton (Hex-UWCA) is a 2-dimensional fractal pattern that grows on a regular grid of cells consisting of hexagons. The same growth rule for the UWCA applies and the pattern returns to a hexagon in generations n=2^k, when the first hexagon is considered as generation 1.\nThe UWCA has two reflection lines that pass through the corners of the initial cell dividing the square into four quadrants, similarly the Hex-UWCA has three reflection lines dividing the hexagon into six sections and the growth rule follows the symmetries. Cells whose centers lie on a line of reflection symmetry are never born.\nThe Hex-UWCA pattern can be explored [http://oeis.org/A139250/a139250.anim.html here].\nSierpinski triangle\n- generation 16]]\nThe Sierpinski triangle appears in 13th century Italian floor mosaics. Wacław Sierpiński described the triangle in 1915.\nIf we consider the growth of the triangle, with each row corresponding to a generation and the top row generation 1 is a single triangle, then like the UWCA and the Hex-UWCA it returns to its starting shape, in generations n=2^k.\nToothpick sequence\n- generation 13]]\nThe toothpick pattern is constructed by placing a single toothpick of unit length on a square grid, aligned with the vertical axis. At each subsequent stage, for every exposed toothpick end, place a perpendicular toothpick centred at that end. The resulting structure has a fractal-like appearance.\nThe toothpick and UWCA structures are examples of cellular automata defined on a graph and when considered as a subgraph of the infinite square grid the structure is a tree.\nThe toothpick sequence returns to its base rotated ‘H’ shape in generations n=2^k  where k \\ge 1\nThe toothpick sequence and various toothpick-like sequences can be explored [http://oeis.org/A139250/a139250.anim.html here].\nCombinatorial game theory\nA subtraction game called LIM, in which two players alternately modify three piles of tokens by taking an equal amount of tokens from two of the piles and adding the same amount to the third pile, has a set of winning positions that can be described using the Ulam–Warburton automaton.\nHistory\nThe beginnings of automata go back to a conversation Ulam had with Stanislaw Mazur in a coffee house in Lwów Poland when Ulam was twenty in 1929.  Ulam worked with John von Neumann during the war years when they became good friends and discussed cellular automaton. Von Neumann’s used these ideas in his concept of a universal constructor and the digital computer. Ulam focussed on biological and ‘crystal like’ patterns publishing a sketch of the growth of a square based cell structure using a simple rule in 1962. Mike Warburton is an amateur mathematician working in probabilistic number theory who was educated at George Heriot's School in Edinburgh. His son's mathematics GCSE coursework involved investigating the growth of equilateral triangles or squares in the Euclidean plane with the rule – a new generation is born if and only if connected to the last by only one-edge. That coursework concluded with a recursive formula for the number of ON cells born in each generation. Later, Warburton found the sharp upper bound formula which he wrote up as a note in the Open University’s M500 magazine in 2002. David Singmaster read the article, analysed the structure and named the object the Ulam-Warburton cellular automaton in his 2003 article. Since then it has given rise to numerous integer sequences.\nReferences\nExternal links\n* Explore the UWCA, Hex-UWCA and related integer sequence [http://oeis.org/A139250/a139250.anim.html animations]\n* [https://www.youtube.com/watch?v=_UtCli1SgjI Neil Sloane: Terrific Toothpick Patterns - Numberphile. (The UWCA starts at time 8:20)]"
    }
  ]
}