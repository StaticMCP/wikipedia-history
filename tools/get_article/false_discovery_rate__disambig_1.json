{
  "content": [
    {
      "type": "text",
      "text": "# False discovery rate__disambig_1\n\nIn statistics, the false discovery rate (FDR) is a method of conceptualizing the rate of type I errors in null hypothesis testing when conducting multiple comparisons. FDR-controlling procedures are designed to control the FDR, which is the expected proportion of \"discoveries\" (rejected null hypotheses) that are false (incorrect rejections of the null). Equivalently, the FDR is the expected ratio of the number of false positive classifications (false discoveries) to the total number of positive classifications (rejections of the null). The total number of rejections of the null include both the number of false positives (FP) and true positives (TP). Simply put, FDR = FP / (FP + TP). FDR-controlling procedures provide less stringent control of Type I errors compared to family-wise error rate (FWER) controlling procedures (such as the Bonferroni correction), which control the probability of at least one Type I error. Thus, FDR-controlling procedures have greater power, at the cost of increased numbers of Type I errors.\nHistory\nTechnological motivations\nThe modern widespread use of the FDR is believed to stem from, and be motivated by, the development in technologies that allowed the collection and analysis of a large number of distinct variables in several individuals (e.g., the expression level of each of 10,000 different genes in 100 different persons). By the late 1980s and 1990s, the development of \"high-throughput\" sciences, such as genomics, allowed for rapid data acquisition.  This, coupled with the growth in computing power, made it possible to seamlessly perform a very high number of statistical tests on a given data set. The technology of microarrays was a prototypical example, as it enabled thousands of genes to be tested simultaneously for differential expression between two biological conditions.\nAs high-throughput technologies became common, technological and/or financial constraints led researchers to collect datasets with relatively small sample sizes (e.g. few individuals being tested) and large numbers of variables being measured per sample (e.g. thousands of gene expression levels). In these datasets, too few of the measured variables showed statistical significance after classic correction for multiple tests with standard multiple comparison procedures.  This created a need within many scientific communities to abandon FWER and unadjusted multiple hypothesis testing for other ways to highlight and rank in publications those variables showing marked effects across individuals or treatments that would otherwise be dismissed as non-significant after standard correction for multiple tests.  In response to this, a variety of error rates have been proposed—and become commonly used in publications—that are less conservative than FWER in flagging possibly noteworthy observations. The FDR is useful when researchers are looking for \"discoveries\" that will give them followup work (E.g.: detecting promising genes for followup studies), and are interested in controlling the proportion of \"false leads\" they are willing to accept.\nLiterature\nThe FDR concept was formally described by Yoav Benjamini and Yosef Hochberg in 1995 (BH procedure) as a less conservative and arguably more appropriate approach for identifying the important few from the trivial many effects tested. The FDR has been particularly influential, as it was the first alternative to the FWER to gain broad acceptance in many scientific fields (especially in the life sciences, from genetics to biochemistry, oncology and plant sciences). In 2005, the Benjamini and Hochberg paper from 1995 was identified as one of the 25 most-cited statistical papers.\nPrior to the 1995 introduction of the FDR concept, various precursor ideas had been considered in the statistics literature. In 1979, Holm proposed the Holm procedure, a stepwise algorithm for controlling the FWER that is at least as powerful as the well-known Bonferroni adjustment. This stepwise algorithm sorts the p-values and sequentially rejects the hypotheses starting from the smallest p-values.\nBenjamini (2010) said that the false discovery rate, and the paper Benjamini and Hochberg (1995), had its origins in two papers concerned with multiple testing:\n* The first paper is by Schweder and Spjotvoll (1982) who suggested plotting the ranked p-values and assessing the number of true null hypotheses (m_0) via an eye-fitted line starting from the largest p-values. The p-values that deviate from this straight line then should correspond to the false null hypotheses. This idea was later developed into an algorithm and incorporated the estimation of m_0 into procedures such as Bonferroni, Holm or Hochberg. This idea is closely related to the graphical interpretation of the BH procedure.\n* The second paper is by Branko Soric (1989) which introduced the terminology of \"discovery\" in the multiple hypothesis testing context. Soric used the expected number of false discoveries divided by the number of discoveries \\left (E[V]/R \\right ) as a warning that \"a large part of statistical discoveries may be wrong\". This led Benjamini and Hochberg to the idea that a similar error rate, rather than being merely a warning, can serve as a worthy goal to control.\nThe BH procedure was proven to control the FDR for independent tests in 1995 by Benjamini and Hochberg.  In 1986, R. J. Simes offered the same procedure as the \"Simes procedure\", in order to control the FWER in the weak sense (under the intersection null hypothesis) when the statistics are independent.\nDefinitions\nBased on definitions below we can define  as the proportion of false discoveries among the discoveries (rejections of the null hypothesis):\nQ = \\frac{V}{R} = \\frac{V}{V+S}.\nwhere V is the number of false discoveries and S is the number of true discoveries.\nThe false discovery rate (FDR) is then simply the following:\n\\mathrm{FDR} = Q_e =  \\operatorname{E}[Q],\nwhere \\operatorname{E}[Q] is the expected value of Q. The goal is to keep FDR below a given threshold q. To avoid division by zero, Q is defined to be 0 when  R = 0 . Formally, {{nowrap| \\mathrm{FDR} = \\operatorname{E}[V/R \\mid R>0] \\cdot \\operatorname{P}(R>0) .}}\nClassification of multiple hypothesis tests\nControlling procedures\nThe settings for many procedures is such that we have H_1, \\ldots, H_m null hypotheses tested and P_1, \\ldots, P_m their corresponding p-values. We list these p-values in ascending order and denote them by P_{(1)}, \\ldots, P_{(m)}.  A procedure that goes from a small test-statistic to a large one will be called a step-up procedure.  In a similar way, in a \"step-down\" procedure we move from a large corresponding test statistic to a smaller one.\nBenjamini–Hochberg procedure\nThe Benjamini–Hochberg procedure (BH step-up procedure) controls the FDR at level \\alpha. It works as follows:\n# For a given \\alpha, find the largest  for which P_{(k)} \\leq \\frac{k}{m} \\alpha\n#Reject the null hypothesis (i.e., declare discoveries) for all H_{(i)} for i = 1, \\ldots, k\nGeometrically, this corresponds to plotting P_{(k)}  vs.   (on the  and  axes respectively), drawing the line through the origin with slope \\frac\n\\alpha{m} , and declaring discoveries for all points on the left, up to, and including the last point that is not above the line.\nThe BH procedure is valid when the  tests are independent, and also in various scenarios of dependence, but is not universally valid.  It also satisfies the inequality:\nE(Q) \\leq \\frac{m_0}{m}\\alpha \\leq \\alpha\nIf an estimator of m_0 is inserted into the BH procedure, it is no longer guaranteed to achieve FDR control at the desired level. Adjustments may be needed in the estimator and several modifications have been proposed.\nNote that the mean \\alpha for these  tests is {{nowrap|\\frac{\\alpha(m+1)}{2m},}} the Mean(FDR \\alpha) or MFDR, \\alpha adjusted for  independent or positively correlated tests (see AFDR below). The MFDR expression here is for a single recomputed value of \\alpha and is not part of the Benjamini and Hochberg method.\nBenjamini–Yekutieli procedure\nThe Benjamini–Yekutieli procedure controls the false discovery rate under arbitrary dependence assumptions. This refinement modifies the threshold and finds the largest  for which\nP_{(k)} \\leq \\frac{k}{m \\cdot c(m)} \\alpha.\n* If the tests are independent or positively correlated (as in Benjamini–Hochberg procedure): c(m)=1\n* Under arbitrary dependence (including the case of negative correlation), c(m) is the harmonic number: c(m) = \\sum _{i=1} ^m \\frac{1}{i}.  Note that c(m) can be approximated by using the Taylor series expansion and the Euler–Mascheroni constant  \\sum_{i=1} ^m \\frac{1}{i} \\approx \\ln(m) + \\gamma + \\frac{1}{2m}.\nUsing MFDR and formulas above, an adjusted MFDR (or AFDR) is the minimum of the mean \\alpha for &nbsp;dependent tests, i.e.,\n: \\frac\\mathrm{MFDR}{c(m)} = \\frac{\\alpha(m+1)}{2m[\\ln(m)+\\gamma]+1}.\nAnother way to address dependence is by bootstrapping and rerandomization.\nStorey–Tibshirani procedure\nIn the Storey–Tibshirani procedure, q-values are used for controlling the FDR.\nProperties\nAdaptive and scalable\nUsing a multiplicity procedure that controls the FDR criterion is adaptive and scalable. Meaning that controlling the FDR can be very permissive (if the data justify it), or conservative (acting close to control of FWER for sparse problem) - all depending on the number of hypotheses tested and the level of significance.\nThe FDR criterion adapts so that the same number of false discoveries (V) will have different implications, depending on the total number of discoveries (R).  This contrasts with the family-wise error rate criterion. For example, if inspecting 100 hypotheses (say, 100 genetic mutations or SNPs for association with some phenotype in some population):\n* If we make 4 discoveries (R), having 2 of them be false discoveries (V) is often very costly.  Whereas,\n* If we make 50 discoveries (R), having 2 of them be false discoveries (V) is often not very costly.\nThe FDR criterion is scalable in that the same proportion of false discoveries out of the total number of discoveries (Q), remains sensible for different number of total discoveries (R). For example:\n* If we make 100 discoveries (R), having 5 of them be false discoveries (q=5\\%) may not be very costly.\n* Similarly, if we make 1000 discoveries (R), having 50 of them be false discoveries (as before, q=5\\%) may still not be very costly.\nDependency among the test statistics\nControlling the FDR using the linear step-up BH procedure, at level q, has several properties related to the dependency structure between the test statistics of the  null hypotheses that are being corrected for.  If the test statistics are:\n* Independent: \\mathrm{FDR} \\le \\frac{m_0}{m}q\n* Independent and continuous: \\mathrm{FDR} = \\frac{m_0}{m}q\n* Positive dependent: \\mathrm{FDR} \\le \\frac{m_0}{m}q\n* In the general case: \\mathrm{FDR} \\le \\frac{m_0}{m} \\frac{q}{ 1 + \\frac{1}{2} + \\frac{1}{3} + \\cdots + \\frac{1}{m} } \\approx \\frac{m_0}{m} \\frac{q}{\\ln (m) + \\gamma + \\frac{1}{2m}}, where \\gamma is the Euler–Mascheroni constant.\nProportion of true hypotheses\nIf all of the null hypotheses are true (m_0=m), then controlling the FDR at level  guarantees control over the FWER (this is also called \"weak control of the FWER\"):  \\mathrm{FWER}=P\\left( V \\ge 1 \\right) = E\\left( \\frac{V}{R} \\right) = \\mathrm{FDR} \\le q, simply because the event of rejecting at least one true null hypothesis  \\{V \\ge 1\\}  is exactly the event  \\{V/R = 1\\} , and the event  \\{V = 0\\}  is exactly the event  \\{V/R = 0\\}  (when  V = R = 0 ,  V/R = 0  by definition).  But if there are some true discoveries to be made (m_0) then .  In that case there will be room for improving detection power.  It also means that any procedure that controls the FWER will also control the FDR.\nAverage power\nThe average power of the Benjamini–Hochberg procedure can be computed analytically\nRelated concepts\nThe discovery of the FDR was preceded and followed by many other types of error rates.  These include:\n*  (per-comparison error rate) is defined as: \\mathrm{PCER} = E \\left[ \\frac{V}{m} \\right] .  Testing individually each hypothesis at level  guarantees that \\mathrm{PCER} \\le \\alpha  (this is testing without any correction for multiplicity)\n*  (the family-wise error rate) is defined as: \\mathrm{FWER} = P(V \\ge 1) .  There are numerous procedures that control the FWER.\n* k\\text{-FWER} (The tail probability of the False Discovery Proportion), suggested by Lehmann and Romano, van der Laan at al,  is defined as: k\\text{-FWER} = P(V \\ge k) \\le q.\n* k\\text{-FDR} (also called the generalized FDR by Sarkar in 2007) is defined as: k\\text{-FDR} = E \\left( \\frac{V}{R}I_{(V>k)}  \\right) \\le q.\n* Q' is the proportion of false discoveries among the discoveries\", suggested by Soric in 1989, and is defined as: Q' = \\frac{E[V]}{R} . This is a mixture of expectations and realizations, and has the problem of control for m_0=m.\n* \\mathrm{FDR}_{-1}(or Fdr) was used by Benjamini and Hochberg, and later called \"Fdr\" by Efron (2008) and earlier.  It is defined as: \\mathrm{FDR}_{-1} = Fdr = \\frac{E[V]}{E[R]} . This error rate cannot be strictly controlled because it is 1 when m = m_0.\n* \\mathrm{FDR}_{+1} was used by Benjamini and Hochberg, and later called \"pFDR\" by Storey (2002).  It is defined as: \\mathrm{FDR}_{+1} = p\\mathrm{FDR} = E \\left[ \\frac{V}{R} \\, \\Big\\vert \\, R>0 \\right] .  This error rate cannot be strictly controlled because it is 1 when m = m_0. JD Storey promoted the use of the pFDR (a close relative of the FDR), and the q-value, which can be viewed as the proportion of false discoveries that we expect in an ordered table of results, up to the current line. Storey also promoted the idea (also mentioned by BH) that the actual number of null hypotheses, m_0, can be estimated from the shape of the probability distribution curve. For example, in a set of data where all null hypotheses are true, 50% of results will yield probabilities between 0.5 and 1.0 (and the other 50% will yield probabilities between 0.0 and 0.5). We can therefore estimate m_0 by finding the number of results with P > 0.5 and doubling it, and this permits refinement of our calculation of the pFDR at any particular cut-off in the data-set.\n* False exceedance rate (the tail probability of FDP), defined as: \\mathrm{P} \\left( \\frac{V}{R} > q \\right)\n* W\\text{-FDR} (Weighted FDR).  Associated with each hypothesis i is a weight w_i \\ge 0, the weights capture importance/price.  The W-FDR is defined as: W\\text{-FDR} = E\\left( \\frac{\\sum w_i V_i }{\\sum w_i R_i } \\right).\n*  (False Discovery Cost Rate).  Stemming from statistical process control: associated with each hypothesis i is a cost \\mathrm{c}_i and with the intersection hypothesis H_{00} a cost c_0.  The motivation is that stopping a production process may incur a fixed cost.  It is defined as:\n:: \\mathrm{FDCR} = E\\left( c_0 V_0 + \\frac{\\sum c_i V_i }{c_0 R_0 + \\sum c_i R_i } \\right)\n*  (per-family error rate) is defined as: \\mathrm{PFER} = E(V).\n*  (False non-discovery rates) by Sarkar; Genovese and Wasserman  is defined as\n:: \\mathrm{FNR} = E\\left( \\frac{T}{m - R} \\right) = E\\left( \\frac{m - m_0 - (R - V)}{m - R} \\right)\n* \\mathrm{FDR}(z) is defined as: \\mathrm{FDR}(z) = \\frac{p_0 F_0 (z)}{F(z)}\n* \\mathrm{fdr}, local-fdr is defined as: \\mathrm{fdr} = \\frac{p_0 f_0 (z)}{f(z)} in a local interval of z.\nFalse coverage rate\nThe false coverage rate (FCR) is, in a sense, the FDR analog to the confidence interval. FCR indicates the average rate of false coverage, namely, not covering the true parameters, among the selected intervals. The FCR gives a simultaneous coverage at a 1-\\alpha level for all of the parameters considered in the problem. Intervals with simultaneous coverage probability 1&nbsp;−&nbsp;q can control the FCR to be bounded by q. There are many FCR procedures such as: Bonferroni-Selected–Bonferroni-Adjusted, Adjusted BH-Selected CIs (Benjamini and Yekutieli (2005)), Bayes FCR (Zhao and Hwang (2012)), and other Bayes methods.\nBayesian approaches\nConnections have been made between the FDR and Bayesian approaches (including empirical Bayes methods), thresholding wavelets coefficients and model selection, and generalizing the confidence interval into the false coverage statement rate (FCR).\nStructural false discovery rate (sFDR)\nThe structural false discovery rate (sFDR) is a generalization of the classical false discovery rate (FDR) introduced by D. Meskaldji and collaborators in 2018.\nThe sFDR extends the FDR by replacing the linear denominator R in the expected ratio E[V/R] with a non-decreasing concave function s(R), yielding the criterion E[V/s(R)]. This approach allows the control of false discoveries to adapt to the scale of testing, so that prudence increases faster than linearly as the number of rejections grows.\nWhen s(R)&nbsp;=&nbsp;R, the classical FDR is recovered, while specific choices of s(R) can interpolate between FDR control and family-wise error control (k-FWER). The sFDR provides a structural connection between classical, local, and generalized false discovery concepts, and has been extended to online and adaptive settings.\nSoftware implementations\n*[https://strimmerlab.github.io/notes/fdr.html False Discovery Rate Analysis in R] – Lists links with popular R packages\n*[https://github.com/puolival/multipy False Discovery Rate Analysis in Python] – Python implementations of false discovery rate procedures\nSee also\n* Positive predictive value\nReferences\nExternal links\n* [https://www.youtube.com/watch?v=bV4OIv7hUWI The False Discovery Rate – Yoav Benjamini, Ruth Heller & Daniel Yekutieli] – Rousseeuw Prize for Statistics ceremony lecture from 2024.\n*[https://brainder.org/2011/09/05/fdr-corrected-fdr-adjusted-p-values/ False Discovery Rate: Corrected & Adjusted P-values] – MATLAB/GNU Octave implementation and discussion on the difference between corrected and adjusted FDR p-values.\n*[https://eranraviv.com/understanding-false-discovery-rate/ Understanding False Discovery Rate] – blog post\n*\n*[https://riffyn.com/riffyn-blog/2017/10/29/false-discovery-rate Understanding False Discovery Rate] – Includes Excel VBA code to implement it, and an example in cell line development"
    }
  ]
}