{
  "content": [
    {
      "type": "text",
      "text": "# Working–Hotelling procedure\n\nIn statistics, particularly regression analysis, the Working–Hotelling procedure, named after Holbrook Working and Harold Hotelling, is a method of simultaneous estimation in linear regression models. One of the first developments in simultaneous inference, it was devised by Working and Hotelling for the simple linear regression model in 1929. It provides a confidence region for multiple mean responses, that is, it gives the upper and lower bounds of more than one value of a dependent variable at several levels of the independent variables at a certain confidence level. The resulting confidence bands are known as the Working–Hotelling–Scheffé confidence bands.\nLike the closely related Scheffé's method in the analysis of variance, which considers all possible contrasts, the Working–Hotelling procedure considers all possible values of the independent variables; that is, in a particular regression model, the probability that all the Working–Hotelling confidence intervals cover the true value of the mean response is the confidence coefficient. As such, when only a small subset of the possible values of the independent variable is considered, it is more conservative and yields wider intervals than competitors like the Bonferroni correction at the same level of confidence. It outperforms the Bonferroni correction as more values are considered.\nStatement\nSimple linear regression\nConsider a simple linear regression model Y = \\beta_0 + \\beta_1 X + \\varepsilon, where Y is the response variable and X the explanatory variable, and let b_0 and b_1 be the least-squares estimates of \\beta_0 and \\beta_1 respectively. Then the least-squares estimate of the mean response E(Y_i) at the level X = x_i is \\hat{Y_i} = b_0 + b_1 x_i . It can then be shown, assuming that the errors independently and identically follow the normal distribution, that an 1 - \\alpha confidence interval of the mean response at a certain level of X is as follows:\n: \\hat{y}_i \\in \\left[ b_0 + b_1 x_i \\pm t_{\\alpha/2,\\text{df}=n - 2} \\sqrt{ \\left(\\frac{1}{n - 2} \\sum_{j=1}^n e_j^{\\,2} \\right) \\cdot \\left(\\frac{1}{n} + \\frac{(x_i - \\bar{x})^2}{\\sum_{j=1}^n (x_j - \\bar{x})^2}\\right)}\\right],\nwhere \\left(\\frac{1}{n - 2} \\sum_{j=1}^n e_j^{\\,2} \\right) is the mean squared error and t_{\\alpha/2,\\text{df}=n - 2} denotes the upper \\frac{\\alpha}{2}^\\text{th} percentile of Student's t-distribution with n-2 degrees of freedom.\nHowever, as multiple mean responses are estimated, the confidence level declines rapidly. To fix the confidence coefficient at 1 - \\alpha, the Working–Hotelling approach employs an F-statistic:\n: \\hat{y}_i \\in \\left[ b_0 + b_1 x_i \\pm W \\sqrt{ \\left(\\frac{1}{n - 2} \\sum_{j=1}^n e_j^{\\,2} \\right) \\cdot \\left(\\frac{1}{n} + \\frac{(x_i - \\bar{x})^2}{\\sum_{j=1}^n(x_j - \\bar{x})^2}\\right)}\\right],\nwhere W^2 = 2F_{\\alpha,\\text{df}=(2,n-2)} and F denotes the upper \\alpha^\\text{th} percentile of the F-distribution with (2, n-2) degrees of freedom. The confidence level of is 1 - \\alpha over all values of X, i.e. x_i \\in \\mathbb{R}.\nMultiple linear regression\nThe Working–Hotelling confidence bands can be easily generalised to multiple linear regression. Consider a general linear model as defined in the linear regressions article, that is,\n:\n\\mathbf{Y} = \\mathbf{X}\\boldsymbol\\beta + \\boldsymbol\\varepsilon, \\,\nwhere\n:\n\\mathbf{Y} = \\begin{pmatrix} Y_1 \\\\ Y_2 \\\\ \\vdots \\\\ Y_n \\end{pmatrix}, \\quad\n\\mathbf{X}  = \\begin{pmatrix} \\mathbf{x}^{\\rm T}_1 \\\\ \\mathbf{x}^{\\rm T}_2 \\\\ \\vdots \\\\ \\mathbf{x}^{\\rm T}_n \\end{pmatrix} = \\begin{pmatrix} x_{11} & \\cdots & x_{1p}  \\\\\nx_{21} & \\cdots & x_{2p} \\\\\n\\vdots & \\ddots & \\vdots \\\\\nx_{n1} & \\cdots & x_{np}\n\\end{pmatrix},\n\\boldsymbol\\beta = \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\\\ \\vdots \\\\ \\beta_p \\end{pmatrix}, \\quad\n\\boldsymbol\\varepsilon = \\begin{pmatrix} \\varepsilon_1 \\\\ \\varepsilon_2 \\\\ \\vdots \\\\ \\varepsilon_n \\end{pmatrix}.\nAgain, it can be shown that the least-squares estimate of the mean response E(Y_i) = \\mathbf{x}^{\\rm T}_i \\boldsymbol\\beta is \\hat{Y}_i = \\mathbf{x}^{\\rm T}_i \\mathbf{b}, where \\mathbf{b} consists of least-square estimates of the entries in \\boldsymbol\\beta, i.e. \\mathbf{b} = (\\mathbf{X}^{\\rm T} \\mathbf{X})^{-1} \\mathbf{X}^{\\rm T}\\mathbf{Y}. Likewise, it can be shown that a 1 - \\alpha confidence interval for a single mean response estimate is as follows:\n: \\hat{y}_i \\in \\left[ \\mathbf{x}^{\\rm T}_i \\mathbf{b} \\pm t_{\\alpha/2,\\text{df}=n - p} \\sqrt{\\operatorname{MSE}(\\mathbf{x}^{\\rm T}_i (\\mathbf{X}^{\\rm T}\\mathbf{X})^{-1} \\mathbf{x}_i})\\right],\nwhere \\operatorname{MSE} is the observed value of the mean squared error (Y^{\\rm T} Y - \\mathbf{b}^{\\rm T} X^{\\rm T} Y).\nThe Working–Hotelling approach to multiple estimations is similar to that of simple linear regression, with only a change in the degrees of freedom:\n: \\hat{y}_i \\in \\left[ \\mathbf{x}^{\\rm T}_i \\mathbf{b} \\pm W \\sqrt{\\operatorname{MSE}(\\mathbf{x}^{\\rm T}_i (\\mathbf{X}^{\\rm T}\\mathbf{X})^{-1} \\mathbf{x}_i})\\right],\nwhere W^2 = 2F_{\\alpha,\\text{df}=(p,n-p)}.\nGraphical representation\nIn the simple linear regression case, Working–Hotelling–Scheffé confidence bands, drawn by connecting the upper and lower limits of the mean response at every level, take the shape of hyperbolas. In drawing, they are sometimes approximated by the Graybill–Bowden confidence bands, which are linear and hence easier to graph:\n: \\beta_0 + \\beta_1(x_i-\\bar{x}) \\in \\left[ b_0 + b_1(x_i-\\bar{x}) \\pm m_{\\alpha, 2, \\text{df}=n-2} \\cdot \\left(\\frac{1}{\\sqrt n}\n+ \\frac{|x_i-\\bar x|}{\\sqrt{\\sum_{j=1}^n (x_j-\\bar x)}} \\right) \\right]\nwhere m_{\\alpha, 2, \\text{df}=n-2}denotes the upper \\alpha^\\text{th} percentile of the Studentized maximum modulus distribution with two means and n - 2 degrees of freedom.\nNumerical example\nThe same data in ordinary least squares are utilised in this example:\n:{|class=\"wikitable\" style=\"text-align:right;\"\n|-\n! style=\"text-align:left;\" | Height (m)\n| 1.47 || 1.50 || 1.52 || 1.55 || 1.57 || 1.60 || 1.63 || 1.65 || 1.68 || 1.70 || 1.73 || 1.75 || 1.78 || 1.80 || 1.83\n|-\n! style=\"text-align:left;\" | Weight (kg)\n| 52.21 || 53.12 || 54.48 || 55.84 || 57.20 || 58.57 || 59.93 || 61.29 || 63.11 || 64.47 || 66.28 || 68.10 || 69.92 || 72.19 || 74.46\n|}\nA simple linear regression model is fit to this data. The values of b_0 and b_1 have been found to be −39.06 and 61.27 respectively. The goal is to estimate the mean mass of women given their heights at the 95% confidence level. The value of W^2 was found to be F_{0.95, \\text{df}=(2,15-2)} = 2.758828. It was also found that \\bar{x} = 1.651, \\sum_{j=1}^n e_j^{\\,2}= 7.490558, \\operatorname{MSE} = 0.5761968 and \\sum_{j=1}^n (x_j - \\bar{x})^2 = 693.3726. Then, to predict the mean mass of all women of a particular height, the following Working–Hotelling–Scheffé band has been derived:\n: \\hat{y}_i \\in \\left[ -39.06 + 61.27 x_i \\pm \\sqrt{ 2.758828 \\cdot 0.5761968 \\cdot \\left(\\frac{1}{15} + \\frac{(x_i - 1.651)^2}{693.3726} \\right)}\\right],\nwhich results in the graph on the left.\nComparison with other methods\nThe Working–Hotelling approach may give tighter or looser confidence limits compared to the Bonferroni correction. In general, for small families of statements, the Bonferroni bounds may be tighter, but when the number of estimated values increases, the Working–Hotelling procedure will yield narrower limits. This is because the confidence level of Working–Hotelling–Scheffé bounds is exactly 1 - \\alpha when all values of the independent variables, i.e. x_i \\in \\mathbb{R}, are considered. Alternatively, from an algebraic perspective, the critical value \\pm \\sqrt{W} remains constant as the number estimates of increases, whereas the corresponding values in Bonferonni estimates, \\pm t_{1-\\alpha/g, \\text{df}=n-p}, will be increasingly divergent as the number g of estimates increases. Therefore, the Working–Hotelling method is more suited for large-scale comparisons, whereas Bonferroni is preferred if only a few mean responses are to be estimated. In practice, both methods are usually used first and the narrower interval chosen.\nAnother alternative to the Working–Hotelling–Scheffé band is the Gavarian band, which is used when a confidence band is needed that maintains equal widths at all levels.\nThe Working–Hotelling procedure is based on the same principles as Scheffé's method, which gives family confidence intervals for all possible contrasts. Their proofs are almost identical. This is because both methods estimate linear combinations of mean response at all factor levels. However, the Working–Hotelling procedure does not deal with contrasts but with different levels of the independent variable, so there is no requirement that the coefficients of the parameters sum up to zero. Therefore, it has one more degree of freedom.\nSee also\n* Multiple comparisons\nFootnotes\nBibliography\n*\n*\n*\n*\n*\n*"
    }
  ]
}