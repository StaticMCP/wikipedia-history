{
  "content": [
    {
      "type": "text",
      "text": "# Focus stacking\n\nof a Tachinid fly. First two images illustrate typical DOF of a single image at f/10 while the third image is the composite of six images.]]\nlight microscopy. This example is of a diatom microfossil in diatomaceous earth. Three source images at different focus distances (top left) are combined with masks (top right) to obtain the contributions of their respective images to the final focus stacked image (bottom). Black is no contribution; white is full.]]\nFocus stackingalso called focal plane merging, z-stacking, focus bracketing or focus blendingis a digital image processing technique which combines multiple images taken at different focus distances to give a resulting image with a greater depth of field (DOF) than any of the individual source images. Focus stacking can be used in any situation where individual images have a very shallow depth of field; macro photography and optical microscopy are two typical examples. Focus stacking can also be useful in landscape photography.\nFocus stacking offers flexibility: since it is a computational technique, images with several different depths of field can be generated in post-processing and compared for best artistic merit or scientific clarity. Focus stacking also allows generation of images physically impossible with normal imaging equipment; images with nonplanar focus regions can be generated. Alternative techniques for generating images with increased or flexible depth of field include wavefront coding, light-field cameras and tilt.\nTechnique\nThe starting point for focus stacking is a series of images captured at different focus distances; in each image different areas of the sample will be in focus. While none of these images has the sample entirely in focus they collectively contain all the data required to generate an image which has all parts of the sample in focus. In-focus regions of each image may be detected automatically, for example via edge detection or Fourier analysis, or selected manually. The in-focus patches are then blended together to generate the final image.\nThis processing is also called z-stacking, focal plane merging (or  in French).\nIn photography\nGetting sufficient depth of field can be particularly challenging in macro photography, because depth of field is smaller (shallower) for objects nearer the camera, so if a small object fills the frame, it is often so close that its entire depth cannot be in focus at once. Depth of field is normally increased by stopping down aperture (using a larger f-number), but beyond a certain point, stopping down causes blurring due to diffraction, which counteracts the benefit of being in focus. It also reduces the luminosity of the image. Focus stacking allows the depth of field of images taken at the sharpest aperture to be effectively increased. The images at right illustrate the increase in DOF that can be achieved by combining multiple exposures.\n's first sampling hole in Mount Sharp. The hole is  wide and  deep.]]\nThe Mars Science Laboratory mission has a device called Mars Hand Lens Imager (MAHLI), which can take photos that can later be focus stacked.\nIn microscopy\nIn microscopy, high numerical apertures are desirable to capture as much light as possible from a small sample. A high numerical aperture (equivalent to a low f-number) gives a very shallow depth of field. Higher magnification objective lenses generally have shallower depth of field; a 100× objective lens with a numerical aperture of around 1.4 has a depth of field of approximately 1 μm. When observing a sample directly, the limitations of the shallow depth of field are easy to circumvent by focusing up and down through the sample; to effectively present microscopy data of a complex 3D structure in 2D, focus stacking is a very useful technique.\nAtomic resolution scanning transmission electron microscopy encounters similar difficulties, where specimen features are much larger than the depth of field. By taking a through-focal series, the depth of focus can be reconstructed to create a single image entirely in focus.\nSoftware/application\n{| class=\"wikitable sortable\"\n|+ Focus stacking software\n|-\n! Name\n! Primary author\n! Application type\n! Platform\n! License\n|-\n| Adobe Photoshop\n| Adobe\n| Desktop\n| Windows, Mac OS X\n| Proprietary\n|-\n| Affinity Photo 'Focus Merge'\n| Serif\n| Desktop\n| Windows, Mac OS X\n| Proprietary\n|-\n| Aphelion with Multifocus extension\n| ADCIS\n| Desktop\n| Windows\n| Proprietary, 30-day trial\n|-\n| Amira / Avizo 'Image Stack Projection'\n| Thermo Fisher\n| Desktop\n| Windows, Mac OS X, Linux\n| Proprietary\n|-\n| CamRanger\n| CamRanger\n| Desktop / Mobile\n| iOS, Android, Mac OS X, Windows\n| Proprietary\n|-\n| Chasys Draw IES\n| John Paul Chacha\n| Desktop\n| Windows\n| Proprietary\n|-\n| CombineZ\n| Alan Hadley\n| Desktop\n| Windows\n| GPL\n|-\n| CUVI Vision & Imaging Library\n| TunaCode\n| Desktop / Embedded\n| Windows, Linux\n| Proprietary\n|-\n| Enfuse (combined with align_image_stack or similar)\n| Andrew Mihal and hugin development team\n| Desktop\n| Multiplatform\n| GPL\n|-\n|FocusFusion\n|DelphiTools\n|Desktop\n|Windows\n|Proprietary\n|-\n| Focus Stacker\n| Alexander Boltnev, Olga Kacher\n| Desktop\n| Mac OS X\n| Proprietary\n|-\n| Focus Stacking Online\n| Focus Stacking Online\n| Web application\n| All\n| Proprietary\n|-\n| Helicon Focus\n| Danylo Kozub\n| Desktop\n| Windows, Mac OS X\n| Proprietary, 30-day trial\n|-\n| ImageJ with Extended Depth of Field Plugin\n| Alex Prudencio, Jesse Berent, Daniel Sage\n| Desktop\n| Unix, Linux, Windows, Mac OS 9 and Mac OS X\n| Public domain\n|-\n| MacroFusion\n| Dariusz Duma\n| Desktop\n| Linux\n| GPL\n|-\n| Mathematica via ImageFocusCombine\n| Wolfram Research\n| Desktop / Web\n| Windows, Mac OS X, Linux\n| Proprietary, 15-day trial\n|-\n| Picolay\n| Heribert Cypionka\n| Desktop\n| Windows\n| Freeware\n|-\n| QuickPHOTO with Deep Focus extension\n| Promicra\n| Desktop\n| Windows\n| Proprietary, 30-day trial\n|-\n| Shine Stacker\n| Luca Lista\n| Desktop\n| Windows, Max OS X, Linux\n| LGPL\n|-\n| Shutter Stream Product Photography Software\n| Iconasys\n| Desktop\n| Windows, Mac OS X\n| Proprietary\n|-\n| Zerene Stacker\n| Rik Littlefield\n| Desktop\n| Windows, Mac OS X, Linux\n| Proprietary, 30-day trial\n|}\nGallery\nPictures\nFile:Zassenhaus pepper mill - underside view - grinder (2019-08-06).jpg | Pepper mill, stack of 28 frames\nFile:Electric guide 3×2.5 mm.jpg | Stacked image of 3 × 2.5&nbsp;mm electric wires\nFile:Philips Series 7000 shaver head.jpg | Shaver head, stack of 36 frames, retouched\nFile:Macrolepiota procera Parasol -20191014-RM-165319.jpg | Macrolepiota procera, stack of 15 frames\nFile:Orchideenblüte 2019-05-22 11-34-28 (C)-PSD.jpg | Stacked image of the inner ridge of an orchid blossom\nFile:Two Arecaceae in the fields viewed through a hole in a tree trunk in Laos at golden hour.jpg | Stacked image of two Arecaceae viewed through a hole in a tree trunk\nFile:2013-06-07 14-57-13-bille-32f.JPG | Pellet, stack of 32 frames\nFile:2016-01-06 14-51-04 parc-tete-or 10f.jpg | Alluaudia comosa, stack of 10 frames\nFile:2013-12-28 19-51-33 Litchi-20f.jpg | Mold on Litchi chinensis, stack of 20 frames\nFile:Skull (front) - Dolmen de Marie Gaillard MHNT ANT 2017 0 54.jpg | Skull, stack of 6 frames\nFile:Sympetrum flaveolum male - Kulna.jpg| Sympetrum flaveolum male, stack of 36 frames\nFile:Pinot_Grigio-20201027-RM-114053.jpg| Pinot Gris grape, stack of 12 frames.\nVideos\nFile:Hindesite - Lily - Focus Stacking (by).ogv|Focus stacking images of a lily\nFile:Focus stacking NEC USB chip imgp0017 wp.ogv|Focus stacking images of a microchip\nDiagrams\nFile:Stack and Stitch Illustration.png | Software creates from the sharpest areas in a stack of sections.\nSee also\n* Brenizer Method\n* Deep focus\n* Epsilon photography\n* Focus bracketing\n* Frazier lens\n* High dynamic range imaging (HDR)\n* Image stitching\n* Image fusion\n*\n* Shift-and-add for stacking astrophotos\nReferences\n* Ray, Sidney. 2002. Applied Photographic Optics. 3rd ed. Oxford: Focal Press. .\nExternal links\n* [https://camerajabber.com/which-cameras-have-built-in-focus-stacking/ Which cameras have built-in focus stacking?] by Jeff Meyer, Camera Jabber Nov. 2019."
    }
  ]
}