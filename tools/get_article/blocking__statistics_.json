{
  "content": [
    {
      "type": "text",
      "text": "# Blocking (statistics)\n\nIn the  statistical theory of the design of experiments, blocking is the arranging of experimental units that are similar to one another in groups (blocks) based on one or more variables. These variables are chosen carefully to minimize the effect of their variability on the observed outcomes. There are different ways that blocking can be implemented, resulting in different confounding effects. However, the different methods share the same purpose: to control variability introduced by specific factors that could influence the outcome of an experiment. The roots of blocking originated from the statistician, Ronald Fisher, following his development of ANOVA.\nHistory\nThe use of blocking in experimental design has an evolving history that spans multiple disciplines. The foundational concepts of blocking date back to the early 20th century with statisticians like Ronald A. Fisher. His work in developing analysis of variance (ANOVA) set the groundwork for grouping experimental units to control for extraneous variables. Blocking evolved over the years, leading to the formalization of randomized block designs and Latin square designs. Today, blocking still plays a pivotal role in experimental design, and in recent years, advancements in statistical software and computational capabilities have allowed researchers to explore more intricate blocking designs.\nUse\nWe often want to reduce or eliminate the influence of some confounding factor when designing an experiment. We can sometimes do this by \"blocking\", which involves the separate consideration of blocks of data that have different levels of exposure to that factor.\nExamples\n*Male and female: An experiment is designed to test a new drug on patients. There are two levels of the treatment, drug, and placebo, administered to male and female patients in a double blind trial. The sex of the patient is a blocking factor accounting for treatment variability between males and females.  This reduces sources of variability and thus leads to greater precision.\n*Elevation: An experiment is designed to test the effects of a new pesticide on a specific patch of grass. The grass area contains a major elevation change and thus consists of two distinct regions – 'high elevation' and 'low elevation'. A treatment group (the new pesticide) and a placebo group are applied to both the high elevation and low elevation areas of grass. In this instance the researcher is blocking the elevation factor which may account for variability in the pesticide's application.\n*Intervention: Suppose a process is invented that intends to make the soles of shoes last longer, and a plan is formed to conduct a field trial. Given a group of n volunteers, one possible design would be to give n/2 of them shoes with the new soles and n/2 of them shoes with the ordinary soles, randomizing the assignment of the two kinds of soles. This type of experiment is a completely randomized design. Both groups are then asked to use their shoes for a period of time, and then measure the degree of wear of the soles. This is a workable experimental design, but purely from the point of view of statistical accuracy (ignoring any other factors), a better design would be to give each person one regular sole and one new sole, randomly assigning the two types to the left and right shoe of each volunteer. Such a design is called a \"randomized complete block design.\" This design will be more sensitive than the first, because each person is acting as his/her own control and thus the control group is more closely matched to the treatment group block design\nNuisance variables\nIn the examples listed above, a nuisance variable is a variable that is not the primary focus of the study but can affect the outcomes of the experiment. They are considered potential sources of variability that, if not controlled or accounted for, may confound the interpretation between the independent and dependent variables.\nTo address nuisance variables, researchers can employ different methods such as blocking or randomization. Blocking involves grouping experimental units based on levels of the nuisance variable to control for its influence. Randomization helps distribute the effects of nuisance variables evenly across treatment groups.\nBy using one of these methods to account for nuisance variables, researchers can enhance the internal validity of their experiments, ensuring that the effects observed are more likely attributable to the manipulated variables rather than extraneous influences.\nIn the first example provided above, the sex of the patient would be a nuisance variable. For example, consider if the drug was a diet pill and the researchers wanted to test the effect of the diet pills on weight loss. The explanatory variable is the diet pill and the response variable is the amount of weight loss. Although the sex of the patient is not the main focus of the experiment—the effect of the drug is—it is possible that the sex of the individual will affect the amount of weight lost.\nBlocking used for nuisance factors that can be controlled\nIn the statistical theory of the design of experiments, blocking is the arranging of experimental units in groups (blocks) that are similar to one another. Typically, a blocking factor is a source of variability that is not of primary interest to the experimenter.\nWhen studying probability theory the blocks method consists of splitting a sample into blocks (groups) separated by smaller subblocks so that the blocks can be considered almost independent. The blocks method helps proving limit theorems in the case of dependent random variables.\nThe blocks method was introduced by S. Bernstein:\nThe method was successfully applied in the theory of sums of dependent random variables and in extreme value theory.\nExample\nIn our previous diet pills example, a blocking factor could be the sex of a patient. We could put individuals into one of two blocks (male or female). And within each of the two blocks, we can randomly assign the patients to either the diet pill (treatment) or placebo pill (control).  By blocking on sex, this source of variability is controlled, therefore, leading to greater interpretation of how the diet pills affect weight loss.\nDefinition of blocking factors\nA nuisance factor is used as a blocking factor if every level of the primary factor occurs the same number of times with each level of the nuisance factor. The analysis of the experiment will focus on the effect of varying levels of the primary factor within each block of the experiment.\nBlock a few of the most important nuisance factors\nThe general rule is:\n:\"Block what you can; randomize what you cannot.\"\nBlocking is used to remove the effects of a few of the most important nuisance variables. Randomization is then used to reduce the contaminating effects of the remaining nuisance variables. For important nuisance variables, blocking will yield higher significance in the variables of interest than randomizing.\nImplementation\nImplementing blocking in experimental design involves a series of steps to effectively control for extraneous variables and enhance the precision of treatment effect estimates.\nIdentify nuisance variables\nIdentify potential factors that are not the primary focus of the study but could introduce variability.\nSelect appropriate blocking factors\nCarefully choose blocking factors based on their relevance to the study as well as their potential to confound the primary factors of interest.\nDefine block sizes\nThere are consequences to partitioning a certain sized experiment into a certain number of blocks as the number of blocks determines the number of confounded effects.\nAssign treatments to blocks\nYou may choose to randomly assign experimental units to treatment conditions within each block which may help ensure that any unaccounted for variability is spread evenly across treatment groups. However, depending on how you assign treatments to blocks, you may obtain a different number of confounded effects. Therefore, the number of as well as which specific effects get confounded can be chosen which means that assigning treatments to blocks is superior over random assignment.\nReplication\nBy running a different design for each replicate, where a different effect gets confounded each time, the interaction effects are partially confounded instead of completely sacrificing one single effect. Replication enhances the reliability of results and allows for a more robust assessment of treatment effects.\nExample\nTable\nOne useful way to look at a randomized block experiment is to consider it as a collection of completely randomized experiments, each run within one of the blocks of the total experiment.\n{| class=\"wikitable\"\n|+ Randomized block designs (RBD)\n|-\n! Name of design\n! Number of factors k\n! Number of runs n\n|-\n| 2-factor RBD\n| 2\n| L1 * L2\n|-\n| 3-factor RBD\n| 3\n| L1 * L2 * L3\n|-\n| 4-factor RBD\n| 4\n| L1 * L2 * L3 * L4\n|-\n| \\vdots\n| \\vdots\n| \\vdots\n|-\n| k-factor RBD\n| k\n| L1 * L2 * \\cdots * Lk\n|}\nwith\n:L1 = number of levels (settings) of factor 1\n:L2 = number of levels (settings) of factor 2\n:L3 = number of levels (settings) of factor 3\n:L4 = number of levels (settings) of factor 4\n::\\vdots\n:Lk = number of levels (settings) of factor k\nExample\nSuppose engineers at a semiconductor manufacturing facility want to test whether different wafer implant material dosages have a significant effect on resistivity measurements after a diffusion process taking place in a furnace. They have four different dosages they want to try and enough experimental wafers from the same lot to run three wafers at each of the dosages.\nThe nuisance factor they are concerned with is \"furnace run\" since it is known that each furnace run differs from the last and impacts many process parameters.\nAn ideal way to run this experiment would be to run all the 4x3=12 wafers in the same furnace run. That would eliminate the nuisance furnace factor completely. However, regular production wafers have furnace priority, and only a few experimental wafers are allowed into any furnace run at the same time.\nA non-blocked way to run this experiment would be to run each of the twelve experimental wafers, in random order, one per furnace run. That would increase the experimental error of each resistivity measurement by the run-to-run furnace variability and make it more difficult to study the effects of the different dosages. The blocked way to run this experiment, assuming you can convince manufacturing to let you put four experimental wafers in a furnace run, would be to put four wafers with different dosages in each of three furnace runs. The only randomization would be choosing which of the three wafers with dosage 1 would go into furnace run 1, and similarly for the wafers with dosages 2, 3 and 4.\nDescription of the experiment\nLet X1 be dosage \"level\" and X2 be the blocking factor furnace run. Then the experiment can be described as follows:\n:k = 2 factors (1 primary factor X1 and 1 blocking factor X2)\n:L1 = 4 levels of factor X1\n:L2 = 3 levels of factor X2\n:n = 1 replication per cell\n:N = L1 * L2 = 4 * 3 = 12 runs\nBefore randomization, the design trials look like:\n{| class=\"wikitable\"\n|-\n! X1\n! X2\n|-\n| 1\n| 1\n|-\n| 1\n| 2\n|-\n| 1\n| 3\n|-\n| 2\n| 1\n|-\n| 2\n| 2\n|-\n| 2\n| 3\n|-\n| 3\n| 1\n|-\n| 3\n| 2\n|-\n| 3\n| 3\n|-\n| 4\n| 1\n|-\n| 4\n| 2\n|-\n| 4\n| 3\n|}\nMatrix representation\nAn alternate way of summarizing the design trials would be to use a 4x3 matrix whose 4 rows are the levels of the treatment X1 and whose columns are the 3 levels of the blocking variable X2. The cells in the matrix have indices that match the X1, X2 combinations above.\n{| class=\"wikitable\"\n|-\n! Treatment\n! Block 1\n! Block 2\n! Block 3\n|-\n| 1\n| 1\n| 1\n| 1\n|-\n| 2\n| 1\n| 1\n| 1\n|-\n| 3\n| 1\n| 1\n| 1\n|-\n| 4\n| 1\n| 1\n| 1\n|}\nBy extension, note that the trials for any K-factor randomized block design are simply the cell indices of a k dimensional matrix.\nModel\nThe model for a randomized block design with one nuisance variable is\n:\nY_{ij} = \\mu + T_i + B_j + \\mathrm{random\\ error}\nwhere\n:Yij is any observation for which X1 = i and X2 = j\n:X1 is the primary factor\n:X2 is the blocking factor\n:&mu; is the general location parameter (i.e., the mean)\n:Ti is the effect for being in treatment i (of factor X1)\n:Bj is the effect for being in block j (of factor X2)\nEstimates\n:Estimate for &mu; : \\overline{Y} = the average of all the data\n:Estimate for Ti : \\overline{Y}_{i\\cdot} - \\overline{Y} with \\overline{Y}_{i\\cdot} = average of all Y for which X1 = i.\n:Estimate for Bj : \\overline{Y}_{\\cdot j} - \\overline{Y} with \\overline{Y}_{\\cdot j} = average of all Y for which X2 = j.\nGeneralizations\n*Generalized randomized block designs (GRBD) allow tests of block–treatment interaction, and has exactly one blocking factor like the RCBD.\n*Latin squares (and other row–column designs) have two blocking factors that are believed to have no interaction.\n*Latin hypercube sampling\n*Graeco-Latin squares\n*Hyper-Graeco-Latin square designs\nSee also\n*Algebraic statistics\n*Block design\n*Combinatorial design\n*Generalized randomized block design\n*Glossary of experimental design\n*Optimal design\n*Paired difference test\n*Dependent and independent variables\n*Blockmodeling\n*Paired data\n*Block bootstrap\nReferences\n*\nBibliography\n*\n*\n*\n* Pre-publication chapters are available on-line.\n*\n*\n*\n*\n*\n*\n**\n**\n*\n*\n*\n*\n*\n*\n*"
    }
  ]
}