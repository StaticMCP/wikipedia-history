{
  "content": [
    {
      "type": "text",
      "text": "# Obfuscation (software)\n\nIn software development, obfuscation is the practice of creating source or machine code that is intentionally difficult for humans or computers to understand. Similar to obfuscation in natural language, code obfuscation may involve using unnecessarily roundabout ways to write statements. Programmers may obfuscate code to conceal its purpose, logic, or embedded values. The primary reasons for doing so are to prevent tampering, deter reverse engineering, or to create a puzzle or recreational challenge to deobfuscate the code, a challenge often included in crackmes. While obfuscation can be done manually, it is more commonly performed using obfuscators.\nOverview\nThe architecture and characteristics of some languages may make them easier to obfuscate than others. C, C++, and the Perl programming language are some examples of languages easy to obfuscate. Haskell is also quite obfuscatable despite being quite different in structure.\nThe properties that make a language obfuscatable are not immediately obvious.\nTechniques\nTypes of obfuscations include simple keyword substitution, use or non-use of whitespace to create artistic effects, and self-generating or heavily compressed programs.\nAccording to Nick Montfort, techniques may include:\n# naming obfuscation, which includes naming variables in a meaningless or deceptive way;\n# data/code/comment confusion, which includes making some actual code look like comments or confusing syntax with data;\n# double coding, which can be displaying code in poetry form or interesting shapes.\nPayload encoding for malware evasion\nXOR encryption and Base64 encoding are two common methods used to hide malware from antivirus detection. Both work by changing how malicious code appears in its file form, which prevents security software from recognizing dangerous patterns.\nIn XOR obfuscation, an attacker chooses a secret key and applies the XOR bitwise operation to the malware binary. This transforms the executable into what looks like random data. Function names in the import table vanish, PE headers become corrupted, and the entire file loses its structure. The obfuscated payload then gets embedded into a dropper, which is a normal-looking executable that contains the hidden malware as a resource or data section. When a user runs the dropper, it performs the XOR operation again with the same key to reconstruct the original malware, then either executes it directly from memory or writes it to disk before running it.\nThis process removes several indicators that antivirus software relies on. The MZ header, which marks the beginning of every Windows executable, gets completely obscured by the XOR operation. Security programs frequently scan for this two-byte signature when searching for embedded executables. Base64 encoding achieves similar results through a different method. It converts binary data into ASCII text, so an executable file ends up looking like plain text rather than a program.\nResearch from the 2020 Machine Learning Security Evasion Competition showed that these methods can bypass modern detection systems. Participants used combinations of XOR encoding, Base64 encoding, and dead code insertion to evade all three competition models with fewer than five attempts per sample. Entropy-based detection also failed, and in some cases Base64 encoding actually lowered the entropy compared to the original malware files.\nThe simplicity of these techniques is what makes them particularly dangerous. XOR and Base64 encoding require only basic programming skills to implement, yet they proved effective against advanced machine learning classifiers. This has pushed security researchers toward new defenses, including automated XOR key recovery tools and deeper analysis of embedded resources in executable files.\nAutomated tools\nA variety of tools exist to perform or assist with code obfuscation. These include experimental research tools developed by academics, hobbyist tools, commercial products written by professionals, and open-source software. Additionally, deobfuscation tools exist, aiming to reverse the obfuscation process.\nWhile most commercial obfuscation solutions transform either program source code or platform-independent bytecode,  portable code (as used by Java and .NET), some also work directly on compiled binaries.\n* Some Python examples can be found in the [https://docs.python.org/3/faq/programming.html#is-it-possible-to-write-obfuscated-one-liners-in-python official Python programming FAQ] and elsewhere.\n* The movfuscator C compiler for the x86_32 ISA uses only the mov instruction in order to obfuscate.\nRecreational\nWriting and reading obfuscated source code can be a brain teaser. A number of programming contests reward the most creatively obfuscated code, such as the International Obfuscated C Code Contest and the Obfuscated Perl Contest.\nShort obfuscated Perl programs may be used in signatures of Perl programmers.  These are JAPHs (\"Just another Perl hacker\").\nCryptographic\nCryptographers have explored the idea of obfuscating code so that reverse-engineering the code is cryptographically hard. This is formalized in the many proposals for indistinguishability obfuscation, a cryptographic primitive that, if possible to build securely, would allow one to construct many other kinds of cryptography, including completely novel types that no one knows how to make. (A stronger notion, black-box obfuscation, is known to be impossible in general.)\nDisadvantages of obfuscation\n* While obfuscation can make reading, writing, and reverse-engineering a program difficult and time-consuming, it will not necessarily make it impossible.\n* It adds time and complexity to the build process for the developers.\n* It can make debugging issues after the software has been obfuscated extremely difficult.\n* Once code is no longer maintained, hobbyists may want to maintain the program, add mods, or understand it better. Obfuscation makes it hard for end users to do useful things with the code.\n* Certain kinds of obfuscation (i.e. code that isn't just a local binary and downloads mini binaries from a web server as needed) can degrade performance and/or require Internet.\nNotifying users of obfuscated code\nSome anti-virus softwares, such as AVG AntiVirus, will also alert their users when they land on a website with code that is manually obfuscated, as one of the purposes of obfuscation can be to hide malicious code. However, some developers may employ code obfuscation for the purpose of reducing file size or increasing security. The average user may not expect their antivirus software to provide alerts about an otherwise harmless piece of code, especially from trusted corporations, so such a feature may actually deter users from using legitimate software.\nMozilla and Google disallow browser extensions containing obfuscated code in their add-ons store.\nObfuscation and copyleft licenses\nThere has been debate on whether it is illegal to skirt copyleft software licenses by releasing source code in obfuscated form, such as in cases in which the author is less willing to make the source code available. The issue is addressed in the GNU General Public License by requiring the \"preferred form for making modifications\" to be made available. The GNU website states \"Obfuscated 'source code' is not real source code and does not count as source code.\"\nDecompilers\nA decompiler is a tool that can reverse-engineer source code from an executable or library. This process is sometimes referred to as a man-in-the-end (mite) attack, inspired by the traditional \"man-in-the-middle attack\" in cryptography. The decompiled source code is often hard to read, containing random function and variable names, incorrect variable types, and logic that differs from the original source code due to compiler optimizations.\nModel obfuscation\nModel obfuscation is a technique to hide the internal structure of a machine learning model. Obfuscation turns a model into a black box. It is contrary to explainable AI. Obfuscation models can also be applied to training data before feeding it into the model to add random noise. This hides sensitive information about the properties of individual and groups of samples.\nSee also\n* AARD code\n* Decompilation\n* Digital rights management\n* Dotfuscator (.Net Obfuscator)\n* Esoteric programming language\n* Hardware obfuscation\n* Indistinguishability obfuscation\n* Overlapping instructions\n* Polymorphic code\n* Programming style\n* ProGuard (Java Obfuscator)\n* Quine\n* Source code beautification\n* Source-to-source compiler\n* Spaghetti code\n* Underhanded C Contest\nReferences\nFurther reading\n* Seyyedhamzeh, Javad, [https://archive.today/20121227220116/http://www.csi.org.ir/paper?conf=30&author_name=&paper_name=&abstract=&page=14 ABCME: A Novel Metamorphic Engine], 17th National Computer Conference, Sharif University of Technology, Tehran, Iran, 2012.\n* B. Barak, O. Goldreich, R. Impagliazzo, S. Rudich, A. Sahai, S. Vadhan and K. Yang. [https://web.archive.org/web/20060109155736/http://math.ias.edu/~boaz/Papers/obfuscate.ps \"On the (Im)possibility of Obfuscating Programs\"]. 21st Annual International Cryptology Conference, Santa Barbara, California, USA. Springer Verlag LNCS Volume 2139, 2001.\n*\nExternal links\n* [https://www.ioccc.org/ The International Obfuscated C Code Contest]\n* [https://web.archive.org/web/20050308231232/http://www.cs.arizona.edu/~collberg/Research/Students/DouglasLow/obfuscation.html Protecting Java Code Via Code Obfuscation], ACM Crossroads, Spring 1998 issue\n* [https://web.archive.org/web/20051124025132/http://www.cs.princeton.edu/~boaz/Papers/obf_informal.html Can we obfuscate programs?]\n* [http://yury.name/obfuscation.html Yury Lifshits. Lecture Notes on Program Obfuscation (Spring'2005)]\n* c2:BlackBoxComputation\nes:Ofuscación#Informática"
    }
  ]
}