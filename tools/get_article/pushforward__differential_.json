{
  "content": [
    {
      "type": "text",
      "text": "# Pushforward (differential)\n\nPushforward}}\nIn differential geometry, pushforward is a linear approximation of smooth maps (formulating manifold) on tangent spaces. Suppose that \\varphi\\colon M\\to N is a smooth map between smooth manifolds; then the differential of \\varphi at a point x, denoted \\mathrm d\\varphi_x, is, in some sense, the best linear approximation of \\varphi near x. It can be viewed as a generalization of the total derivative of ordinary calculus. Explicitly, the differential is a linear map from the tangent space of M at x to the tangent space of N at \\varphi(x), \\mathrm d\\varphi_x\\colon T_xM \\to T_{\\varphi(x)}N. Hence it can be used to push tangent vectors on M forward to tangent vectors on N. The differential of a map \\varphi is also called, by various authors, the derivative or total derivative of \\varphi.\nMotivation\nLet \\varphi: U \\to V be a smooth map from an open subset U of \\R^m to an open subset V of \\R^n. For any point x in U, the Jacobian of \\varphi at x (with respect to the standard coordinates) is the matrix representation of the total derivative of \\varphi at x, which is a linear map\n:d\\varphi_x:T_x\\R^m\\to T_{\\varphi(x)}\\R^n\nbetween their tangent spaces. Note the tangent spaces T_x\\R^m,T_{\\varphi(x)}\\R^n are isomorphic to \\mathbb{R}^m and \\mathbb{R}^n, respectively. The pushforward generalizes this construction to the case that \\varphi is a smooth function between any smooth manifolds M and N.\nThe differential of a smooth map\nLet \\varphi \\colon M \\to N  be a smooth map of smooth manifolds. Given  x \\in M,  the differential of  \\varphi  at  x  is a linear map\n:d\\varphi_x \\colon\\ T_xM\\to T_{\\varphi(x)}N\\,\nfrom the tangent space of  M  at  x  to the tangent space of  N  at  \\varphi(x).  The image  d\\varphi_x X  of a tangent vector  X \\in T_x M  under  d\\varphi_x  is sometimes called the pushforward of  X  by  \\varphi.  The exact definition of this pushforward depends on the definition one uses for tangent vectors (for the various definitions see tangent space).\nIf tangent vectors are defined as equivalence classes of the curves \\gamma for which  \\gamma(0) = x,  then the differential is given by\n:d\\varphi_x(\\gamma'(0)) = (\\varphi \\circ \\gamma)'(0).\nHere,  \\gamma  is a curve in  M  with  \\gamma(0) = x,  and \\gamma'(0) is tangent vector to the curve  \\gamma  at  0.  In other words, the pushforward of the tangent vector to the curve  \\gamma  at  0  is the tangent vector to the curve \\varphi \\circ \\gamma at  0.\nAlternatively, if tangent vectors are defined as derivations acting on smooth real-valued functions, then the differential is given by\n:d\\varphi_x(X)(f) = X(f \\circ \\varphi),\nfor an arbitrary function f \\in C^\\infty(N) and an arbitrary derivation X \\in T_xM at point x \\in M (a derivation is defined as a linear map X \\colon C^\\infty(M) \\to \\R that satisfies the Leibniz rule, see: definition of tangent space via derivations). By definition, the pushforward of X is in T_{\\varphi(x)}N and therefore itself is a derivation, d\\varphi_x(X) \\colon C^\\infty(N) \\to \\R.\nAfter choosing two charts around  x  and around  \\varphi(x),   \\varphi  is locally determined by a smooth map \\widehat{\\varphi} \\colon U \\to V between open sets of \\R^m and \\R^n, and\n:d\\varphi_x\\left(\\frac{\\partial}{\\partial u^a}\\right)  = \\frac{\\partial{\\widehat{\\varphi}}^b}{\\partial u^a} \\frac{\\partial}{\\partial v^b},\nin the Einstein summation notation, where the partial derivatives are evaluated at the point in  U  corresponding to  x  in the given chart.\nExtending by linearity gives the following matrix\n:\\left(d\\varphi_x\\right)_a^{\\;b} = \\frac{\\partial{\\widehat{\\varphi}}^b}{\\partial u^a}.\nThus the differential is a linear transformation, between tangent spaces, associated to the smooth map  \\varphi  at each point. Therefore, in some chosen local coordinates, it is represented by the Jacobian matrix of the corresponding smooth map from \\R^m to \\R^n. In general, the differential need not be invertible. However, if  \\varphi  is a local diffeomorphism, then  d\\varphi_x  is invertible, and the inverse gives the pullback of  T_{\\varphi(x)} N.\nThe differential is frequently expressed using a variety of other notations such as\n:D\\varphi_x,\\left(\\varphi_*\\right)_x, \\varphi'(x),T_x\\varphi.\nIt follows from the definition that the differential of a composite is the composite of the differentials (i.e., functorial behaviour). This is the chain rule for smooth maps.\nAlso, the differential of a local diffeomorphism is a linear isomorphism of tangent spaces.\nThe differential on the tangent bundle\nThe differential of a smooth map \\varphi induces, in an obvious manner, a bundle map (in fact a vector bundle homomorphism) from the tangent bundle of M to the tangent bundle of N, denoted by \\operatorname{d}\\!\\varphi, which fits into the following commutative diagram:\ncenter\nwhere \\pi_M and \\pi_N denote the bundle projections of the tangent bundles of M and N respectively.\n\\operatorname{d}\\!\\varphi induces a bundle map from TM to the pullback bundle φ∗TN over M via\n:(m,v_m) \\mapsto (\\varphi(m),\\operatorname{d}\\!\\varphi (m,v_m)),\nwhere m \\in M and v_m \\in T_mM. The latter map may in turn be viewed as a section of the vector bundle  over M. The bundle map \\operatorname{d}\\!\\varphi is also denoted by T\\varphi and called the tangent map. In this way, T is a functor.\nPushforward of vector fields\nGiven a smooth map  and a vector field X on M, it is not usually possible to identify a pushforward of X by φ with some vector field Y on N. For example, if the map φ is not surjective, there is no natural way to define such a pushforward outside of the image of φ. Also, if φ is not injective there may be more than one choice of pushforward at a given point. Nevertheless, one can make this difficulty precise, using the notion of a vector field along a map.\nA section of φ∗TN over M is called a 'vector field along φ'. For example, if M is a submanifold of N and φ is the inclusion, then a vector field along φ is just a section of the tangent bundle of N along M; in particular, a vector field on M defines such a section via the inclusion of TM inside TN. This idea generalizes to arbitrary smooth maps.\nSuppose that X is a vector field on M, i.e., a section of TM. Then, \\operatorname{d}\\!\\phi \\circ X yields, in the above sense, the pushforward φ∗X, which is a vector field along φ, i.e., a section of φ∗TN over M.\nAny vector field Y on N defines a pullback section φ∗Y of φ∗TN with . A vector field X on M and a vector field Y on N are said to be 'φ-related' if  as vector fields along φ. In other words, for all x in M, .\nIn some situations, given a X vector field on M, there is a unique vector field Y on N which is φ-related to X. This is true in particular when φ is a diffeomorphism. In this case, the pushforward defines a vector field Y on N, given by\n:Y_y = \\phi_*\\left(X_{\\phi^{-1}(y)}\\right).\nA more general situation arises when φ is surjective (for example the bundle projection of a fiber bundle). Then a vector field X on M is said to be projectable if for all y in N, dφx(Xx) is independent of the choice of x in φ−1({y}). This is precisely the condition that guarantees that a pushforward of X, as a vector field on N, is well defined.\nExamples\nPushforward from multiplication on Lie groups\nGiven a Lie group G, we can use the multiplication map m(-,-) : G\\times G \\to G to get left multiplication L_g = m(g,-) and right multiplication R_g = m(-,g) maps G \\to G. These maps can be used to construct left or right invariant vector fields on G from its tangent space at the origin \\mathfrak{g} = T_e G (which is its associated Lie algebra). For example, given X \\in \\mathfrak{g} we get an associated vector field \\mathfrak{X} on G defined by\n\\mathfrak{X}_g = (L_g)_*(X) \\in T_g G\nfor every g \\in G. This can be readily computed using the curves definition of pushforward maps. If we have a curve\n\\gamma: (-1,1) \\to G\nwhere\n\\gamma(0) = e \\, , \\quad \\gamma'(0) = X\nwe get\n\\begin{align}\n(L_g)_*(X) &= (L_g\\circ \\gamma)'(0) \\\\\n&= (g\\cdot \\gamma(t))'(0) \\\\\n&= \\frac{dg}{dt}\\gamma(0) + g\\cdot \\frac{d\\gamma}{dt} (0) \\\\\n&= g \\cdot \\gamma'(0)\n\\end{align}\nsince L_g is constant with respect to \\gamma. This implies we can interpret the tangent spaces T_g G as T_g G = g\\cdot T_e G = g\\cdot \\mathfrak{g}.\nPushforward for some Lie groups\nFor example, if G is the Heisenberg group given by matrices\nH = \\left\\{\n\\begin{bmatrix}\n1 & a & b \\\\\n0 & 1 & c \\\\\n0 & 0 & 1\n\\end{bmatrix} : a,b,c \\in \\mathbb{R}\n\\right\\}\nit has Lie algebra given by the set of matrices\n\\mathfrak{h} = \\left\\{\n\\begin{bmatrix}\n0 & a & b \\\\\n0 & 0 & c \\\\\n0 & 0 & 0\n\\end{bmatrix} : a,b,c \\in \\mathbb{R}\n\\right\\}\nsince we can find a path \\gamma:(-1,1) \\to H giving any real number in one of the upper matrix entries with i  (i-th row and j-th column). Then, for\ng = \\begin{bmatrix}\n1 & 2 & 3 \\\\\n0 & 1 & 4 \\\\\n0 & 0 & 1\n\\end{bmatrix}\nwe have\nT_gH = g\\cdot \\mathfrak{h} =\n\\left\\{\n\\begin{bmatrix}\n0 & a & b + 2c \\\\\n0 & 0 & c \\\\\n0 & 0 & 0\n\\end{bmatrix} : a,b,c \\in \\mathbb{R}\n\\right\\}\nwhich is equal to the original set of matrices. This is not always the case, for example, in the group\nG = \\left\\{\n\\begin{bmatrix}\na & b \\\\\n0 & 1/a\n\\end{bmatrix} : a,b \\in \\mathbb{R}, a \\neq 0\n\\right\\}\nwe have its Lie algebra as the set of matrices\n\\mathfrak{g} = \\left\\{\n\\begin{bmatrix}\na & b \\\\\n0 & -a\n\\end{bmatrix} : a,b \\in \\mathbb{R}\n\\right\\}\nhence for some matrix\ng = \\begin{bmatrix}\n2 & 3 \\\\\n0 & 1/2\n\\end{bmatrix}\nwe have\nT_gG = \\left\\{\n\\begin{bmatrix}\n2a & 2b - 3a \\\\\n0 & -a/2\n\\end{bmatrix} : a,b\\in \\mathbb{R}\n\\right\\}\nwhich is not the same set of matrices.\nSee also\n*Pullback (differential geometry)\n*Flow-based generative model\nReferences\n*\n*  See section 1.6.\n*  See section 1.7 and 2.3."
    }
  ]
}