{
  "content": [
    {
      "type": "text",
      "text": "# Varnish (software)__disambig_1\n\n| latest release date    = }}\n| programming language   = C\n| operating system       = BSD, Linux, Unix\n| genre                  = HTTP accelerator\n| license                = two-clause BSD license\n}}\nVarnish is a reverse caching proxy used as HTTP accelerator for content-heavy dynamic web sites as well as APIs. In contrast to other web accelerators, such as Squid, which began life as a client-side cache, or Apache and nginx, which are primarily origin servers, Varnish was designed as an HTTP accelerator. Varnish is focused exclusively on HTTP, unlike other proxy servers that often support FTP, SMTP, and other network protocols.\nHistory\nThe project was initiated by the online branch of the Norwegian tabloid newspaper Verdens Gang. The architect and lead developer is Danish independent consultant Poul-Henning Kamp (a well-known FreeBSD developer), with management, infrastructure and additional development originally provided by the Norwegian Linux consulting company Linpro. The support, management and development of Varnish was later spun off into a separate company, Varnish Software.\nVarnish is free and open-source software, available under a two-clause BSD license. Commercial support is available from Varnish Software, amongst others.\nVersion 1.0 of Varnish was released in 2006, Varnish 2.0 in 2008, Varnish 3.0 in 2011, Varnish 4.0 in 2014, Varnish 5.0 in 2016, Varnish 6.0 in March 2018, and Varnish 7.0 in September 2021.\nArchitecture\nVarnish stores data in virtual memory and leaves the task of deciding what is stored in memory and what gets paged out to disk to the operating system. This helps avoid the situation where the operating system starts caching data while it is moved to disk by the application.\nVarnish is heavily threaded, with each client connection being handled by a separate worker thread.  When the configured limit on the number of active worker threads is reached, incoming connections are placed in an overflow queue; when this queue reaches its configured limit incoming connections will be rejected.\nThe principal configuration mechanism is Varnish Configuration Language (VCL), a domain-specific language (DSL) used to write hooks that are called at critical points in the handling of each request.  Most policy decisions are left to VCL code, making Varnish more configurable and adaptable than most other HTTP accelerators. When a VCL script is loaded, it is translated to C, compiled to a shared object by the system compiler, and loaded directly into the accelerator which can thus be reconfigured without a restart.\nA number of run-time parameters control things such as the maximum and the minimum number of worker threads, various timeouts, etc.  A command-line management interface allows these parameters to be modified, and new VCL scripts to be compiled, loaded and activated, without restarting the accelerator.\nIn order to reduce the number of system calls in the fast path to a minimum, log data is stored in shared memory, and the task of monitoring, filtering, formatting and writing log data to disk is delegated to a separate application.\nPerformance metrics\nVarnish Cache can speed up information delivery by a factor of several hundred. To ensure proper operation and performance, Varnish exposes metrics that can be monitored in the following areas:\n* Client metrics: client connections and requests\n* Cache performance: cache hits, evictions\n* Thread metrics: thread creation, failures, queues\n* Backend metrics: success, failure, and health of backend connections\nMetric collection\nVarnish Cache ships with monitoring and logging tools. One of the most used is varnishstat which gives a detailed snapshot of Varnish's current performance. It provides access to in-memory statistics such as cache hits and misses, resource consumption, threads created, and more.\nvarnishstat\nRunning varnishstat from the command line returns a continuously updating list of all available Varnish metrics. If the -1 flag is added, varnishstat will exit after printing the list one time. Varnishstat can be used as a standalone tool to spot-check the health of the cache. In order to graph metrics over time, correlate with other statistics from across an infrastructure, and set up alerts about any problems that may arise, monitoring services can integrate with Varnish and collect varnishstat metrics.\nvarnishlog\nVarnishlog is a tool that can be used to debug or tune Varnish's configuration, as it provides detailed information about each individual request.\nLoad balancing\nVarnish supports load balancing using both a round robin and a random director, both with a per-backend weighting. Basic health-checking of backends is also available.\nOther features\nVarnish Cache also features:\n* Plugin support with Varnish Modules, also called VMODs\n* Support for Edge Side Includes including stitching together compressed ESI fragments\n* gzip Compression and Decompression\n* DNS, Random, Hashing and Client IP-based Directors\n* HTTP Streaming Pass & Fetch\n* Experimental support for Persistent Storage, without LRU eviction\n* Saint and Grace modes.\n** If a server malfunctions and returns HTTP status code 500, Grace mode will ignore expiry headers and continue to return cached versions. Saint mode is for use when load balancing, where a failing server is blocked for a quarantine period and excluded from the server pool.\nSee also\n* Web accelerator which discusses host-based HTTP acceleration\n* Proxy server which discusses client-side proxies\n* Reverse proxy which discusses origin-side proxies\n* Comparison of web server software\n* Internet Cache Protocol\n* Guru Meditation â€“ an error message used by Varnish\nReferences\nExternal links\n*\n* [https://www.varnish-software.com/ Official commercial web site]\n* [https://varnish-cache.org/docs/trunk/phk/notes.html Notes from the Architect]\n* \"[http://queue.acm.org/detail.cfm?id=1814327 You're Doing It Wrong]\", June 11, 2010 ACM Queue article by Varnish developer Poul-Henning Kamp describing the implementation of the LRU list.\n* [http://www.arlocarreon.com/blog/varnish/what-is-varnish-cache-in-laymans-terms Varnish in Layman's Terms]\n* [http://dimitris.apeiro.gr/2014/07/10/varnish-cache-how-to-intro-to-high-availability-for-drupal-lovers-and-wordpress-addicts/ Varnish Cache How-To]"
    }
  ]
}