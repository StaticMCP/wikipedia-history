{
  "content": [
    {
      "type": "text",
      "text": "# Netgear Switch Discovery Protocol\n\nNetgear Switch Discovery Protocol (NSDP) is a management protocol for several network device families, designed by Netgear.\nMessage structure\nCommon message header\n{| class=\"wikitable\" center\"\n|- style=\"text-align:center;\"\n! style=\"width:10%;\"| Offset\n! style=\"width:10%;\"| Length\n! colspan=\"8\" style=\"width:80%;\"| Meaning\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0000\n| style=\"width:10%;\"| 1\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| Proto version – always 0x01\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0001\n| style=\"width:10%;\"| 1\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| Operation code: may be 0x01 – read request, 0x02 – read response, 0x03 – write request, 0x04 – write response\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0002\n| style=\"width:10%;\"| 2\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| Operation result\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0004\n| style=\"width:10%;\"| 4\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| Unknown\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0008\n| style=\"width:10%;\"| 6\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| host MAC-address\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x000e\n| style=\"width:10%;\"| 6\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| network device MAC-address (value 00:00:00:00:00:00 is used as multicast address, request will be proceeded by all devices, which would receive it)\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0014\n| style=\"width:10%;\"| 2\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| Unknown\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0016\n| style=\"width:10%;\"| 2\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| Sequence number (value increments with every next request)\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0018\n| style=\"width:10%;\"| 4\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| Protocol signature NSDP\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x001С\n| style=\"width:10%;\"| 4\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| Unknown\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0020\n| style=\"width:10%;\"| N\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| Message body – the sequence of TLV records\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0020 + N\n| style=\"width:10%;\"| 4\n| colspan=\"8\"  style=\"width:80%; text-align:justify;\"| End of message marker 0xFFFF0000\n|}\nMessage body record structure\nMessage body records are type–length–value (TLV) structures. Type field may be one of following values in the table(list in incomplete):\n{| class=\"wikitable\" center\"\n|- style=\"text-align:center;\"\n! style=\"width:10%;\"| Type\n! style=\"width:90%;\"| Meaning\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0001\n|  style=\"width:90%; text-align:justify;\"| Device model\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0003\n|  style=\"width:90%; text-align:justify;\"| Device given name\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0004\n|  style=\"width:90%; text-align:justify;\"| Device MAC-address\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0005\n|  style=\"width:90%; text-align:justify;\"| Device system location\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0006\n|  style=\"width:90%; text-align:justify;\"| Device current IP-address (may be unsupported by certain devices)\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0007\n|  style=\"width:90%; text-align:justify;\"| Device IP-network mask (may be unsupported by certain devices)\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0008\n|  style=\"width:90%; text-align:justify;\"| Router IP-address (may be unsupported by certain devices)\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x000a\n|  style=\"width:90%; text-align:justify;\"| administration password\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x000b\n|  style=\"width:90%; text-align:justify;\"| DHCP Mode (Refresh DHCP = 2, DHCP = 1, Static = 0)\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x000d\n|  style=\"width:90%; text-align:justify;\"| Device Firmware version slot 1 (may be unsupported by certain devices)\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x000e\n|  style=\"width:90%; text-align:justify;\"| Device Firmware version slot 2 (may be unsupported by certain devices)\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x000f\n|  style=\"width:90%; text-align:justify;\"| Next active firmware slot after reboot (01 = 1, 02 = 2, may be unsupported by certain devices)\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x0c00\n|  style=\"width:90%; text-align:justify;\"| Speed/link status of ports\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x1000\n|  style=\"width:90%; text-align:justify;\"| Port Traffic Statistic\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x2800\n|  style=\"width:90%; text-align:justify;\"| Get VLAN info\n|- style=\"text-align:center;\"\n| style=\"width:10%;\"| 0x2c00\n|  style=\"width:90%; text-align:justify;\"| Delete VLAN (write only)\n|}\nProtocol flow examples\nNetwork devices discovery (MAC-address an device model discovery):\nHost with MAC=XX:XX:XX:XX:XX:XX from UDP-port 63321 or 63323 sending packet to broadcast IP-address 255.255.255.255 and UDP-port 63322 or 63324\nHeader    @0x00000000 0x01 0x01 0x000000000000 0xXXXXXXXXXXXX 0x000000000000 0x0000 0x0001 0x4E534450 0x00000000\nBody      @0x00000020 0x0001 0x0000 0x0004 0x0000\nMarker    @0x00000028 0xFFFF0000\nEACH Device responds with message like\nHeader    @0x00000000 0x01 0x02 0x000000000000 0xXXXXXXXXXXXX 0xYYYYYYYYYYYY 0x0000 0x0001 0x4E534450 0x00000000\nBody      @0x00000020 0x0001 0x0028 0x47 0x53 0x31 0x30 0x35 0x45 0x20*0x22 0x0004 0x0006 0xYYYYYYYYYYYY\nMarker    @0x00000058 0xFFFF0000\nDevice support for protocol\n* GS105E ProSAFE Plus\n* GS108E ProSAFE Plus\n* GS724T\n* GS748T\n* FS116E (IP-network description and Firmware version TLVs are not supported)\n* FS726TP (uses 63323 and 63324 UDP-ports for interconnection)\nDevices firmware update\nDevice firmware update is made with TFTP protocol, but you need to send NSDP request to turn on TFTP-server first.\nSee also\n* IP\n* UDP\n* MAC\n* Netgear\nReferences\nExternal links\n* [http://www.netgear.com/ NETGEAR official site]\n* [http://www.vishnivetsky.ru/%D0%B7%D0%B0%D0%BC%D0%B5%D1%82%D0%BA%D0%B8%20%D1%81%D1%82%D0%B0%D1%82%D1%8C%D0%B8%20%D0%BE%D0%B1%D0%B7%D0%BE%D1%80%D1%8B/NETGEAR%20Prosafe%20Plus%20configuration%20linux.html openSource Perl-written cross-platform toolkit for NSDP managed devices project site (in russian)]\n* [https://sourceforge.net/projects/linnetx/ LinNetx openSource C-written utility for ProsafePlus switches management via NSDP, not operational]\n* [http://www.netgeek.ovh/wiki/projets:ngadmin ngadmin] C-written admin utility; GPLv2 license\n* [https://github.com/tabacha/ProSafeLinux ProSafeLinux] Remark: sparse information; FreeBSD license\n* [https://github.com/kvishnivetsky/wireshark-dissector-nsdp NSDP Protocol Wireshark dissector] Remark: GPL license\n* [http://www.curesec.com/en/publications/tools.html Nsdtool] – a toolset of scripts to detect NETGEAR switches in local networks\n* [https://routerfirmwareupdates.com/netgear-firmware-update/ NETGEAR firmware update]"
    }
  ]
}