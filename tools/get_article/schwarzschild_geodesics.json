{
  "content": [
    {
      "type": "text",
      "text": "# Schwarzschild geodesics\n\nIn general relativity, Schwarzschild geodesics describe the motion of test particles in the gravitational field of a central fixed mass M, that is, motion in the Schwarzschild metric. Schwarzschild geodesics have been pivotal in the validation of Einstein's theory of general relativity. For example, they provide accurate predictions of the anomalous precession of the planets in the Solar System and of the deflection of light by gravity.\nSchwarzschild geodesics pertain only to the motion of particles of masses so small they contribute little to the gravitational field. However, they are highly accurate in many astrophysical scenarios provided that m is many-fold smaller than the central mass M, e.g., for planets orbiting their star.  Schwarzschild geodesics are also a good approximation to the relative motion of two bodies of arbitrary mass, provided that the Schwarzschild mass M is set equal to the sum of the two individual masses m_1 and m_2. This is important in predicting the motion of binary stars in general relativity.\nHistorical context\nThe Schwarzschild metric is named in honour of its discoverer Karl Schwarzschild, who found the solution in 1915, only about a month after the publication of Einstein's theory of general relativity. It was the first exact solution of the Einstein field equations other than the trivial flat space solution.\nIn 1931, Yusuke Hagihara published a paper showing that the trajectory of a test particle in the Schwarzschild metric can be expressed in terms of elliptic functions.\nSamuil Kaplan in 1949 has shown that there is a minimum radius for the circular orbit to be stable in Schwarzschild metric.\nSchwarzschild metric\nAn exact solution to the Einstein field equations is the Schwarzschild metric, which corresponds to the external gravitational field of an uncharged, non-rotating, spherically symmetric body of mass M.  The Schwarzschild solution can be written as\n:\nds^2=c^2 {d \\tau}^{2} =\n\\left( 1 - \\frac{r_\\text{s}}{r} \\right) c^{2} dt^{2} - \\frac{dr^{2}}{1 - \\frac{r_\\text{s}}{r}} - r^{2} (d\\theta^{2} + \\sin^{2} \\theta \\, d\\varphi^{2})\nwhere\n: \\tau, in the case of a test particle of small positive mass, is the proper time (time measured by a clock moving with the particle) in seconds,\n: c is the speed of light in meters per second,\n: t is, for r > r_\\text{s}, the time coordinate (time measured by a stationary clock at infinity) in seconds,\n: r is, for r > r_\\text{s}, the radial coordinate (circumference of a circle centered at the star divided by 2\\pi) in meters,\n: \\theta is the colatitude (angle from North) in radians,\n: \\varphi is the longitude in radians, and\n: r_\\text{s} is the Schwarzschild radius of the massive body (in meters), which is related to its mass M by\n::\nr_\\text{s} = \\frac{2GM}{c^{2}},\n: where G is the gravitational constant.  The classical Newtonian theory of gravity is recovered in the limit as the ratio \\frac{r_\\text{s}}{r} goes to zero.  In that limit, the metric returns to that defined by special relativity.\nIn practice, this ratio is almost always extremely small.  For example, the Schwarzschild radius r_\\text{s} of the Earth is roughly 9&nbsp;mm (&nbsp;inch); at the surface of the Earth, the corrections to Newtonian gravity are only one part in a billion.  The Schwarzschild radius of the Sun is much larger, roughly 2953 meters, but at its surface, the ratio \\frac{r_\\text{s}}{r} is roughly 4 parts in a million.  A white dwarf star is much denser, but even here the ratio at its surface is roughly 250 parts in a million.  The ratio only becomes large close to ultra-dense objects such as neutron stars (where the ratio is roughly 50%) and black holes.\nOrbits of test particles\non the right.]]\nWe may simplify the problem by using symmetry to eliminate one variable from consideration.  Since the Schwarzschild metric is symmetrical about \\theta = \\frac{\\pi}{2}, any geodesic that begins moving in that plane will remain in that plane indefinitely (the plane is totally geodesic).  Therefore, we orient the coordinate system so that the orbit of the particle lies in that plane, and fix the \\theta coordinate to be \\frac{\\pi}{2} so that the metric (of this plane) simplifies to\n:\nc^2 d \\tau^{2} =\n\\left( 1 - \\frac{r_\\text{s}}{r} \\right) c^{2} dt^{2} - \\frac{dr^{2}}{1 - \\frac{r_\\text{s}}{r}} - r^{2} d\\varphi^{2}.\nTwo constants of motion (values that do not change over proper time \\tau) can be identified (cf. the derivation given below). One is the total energy E:\n:\n\\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau} = \\frac{E}{m c^{2}}.\nand the other is the specific angular momentum:\n:\nh = \\frac{L}{\\mu} = r^{2} \\frac{d\\varphi}{d\\tau},\nwhere L is the total angular momentum of the two bodies, and \\mu is the reduced mass. When M \\gg m, the reduced mass is approximately equal to m. Sometimes it is assumed that m = \\mu. In the case of the planet Mercury this simplification introduces an error more than twice as large as the relativistic effect. When discussing geodesics, m can be considered fictitious, and what matters are the constants \\frac{E}{m} and h. In order to cover all possible geodesics, we need to consider cases in which \\frac{E}{m} is infinite (giving trajectories of photons) or imaginary (for tachyonic geodesics). For the photonic case, we also need to specify a number corresponding to the ratio of the two constants, namely \\frac{mh}{E}, which may be zero or a non-zero real number.\nSubstituting these constants into the definition of the Schwarzschild metric\n:\nc^{2} = \\left( 1 - \\frac{r_\\text{s}}{r} \\right) c^{2} \\left( \\frac{dt}{d\\tau} \\right)^{2} -\n\\frac{1}{1 - \\frac{r_\\text{s}}{r}} \\left( \\frac{dr}{d\\tau} \\right)^{2} -\nr^{2} \\left( \\frac{d\\varphi}{d\\tau} \\right)^{2},\nyields an equation of motion for the radius as a function of the proper time \\tau:\n:\n\\left( \\frac{dr}{d\\tau} \\right)^{2} = \\frac{E^{2}}{m^{2}c^{2}} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( c^{2} + \\frac{h^{2}}{r^{2}} \\right).\nThe formal solution to this is\n:\n\\tau = \\int \\frac{dr}{\\pm\\sqrt{\\frac{E^{2}}{m^{2}c^{2}} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( c^{2} + \\frac{h^{2}}{r^{2}} \\right)}}.\nNote that the square root will be imaginary for tachyonic geodesics.\nUsing the relation higher up between \\frac{dt}{d\\tau} and E, we can also write\n:\nt = \\int \\frac{dr}{\\pm c\\left( 1 - \\frac{r_\\text{s}}{r} \\right)\\sqrt{1 - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( c^{2} + \\frac{h^{2}}{r^{2}}\\right)\\frac{m^2 c^2}{E^2}}}.\nSince asymptotically the integrand is inversely proportional to r - r_\\text{s}, this shows that in the r, \\theta, \\varphi, t frame of reference if r approaches r_\\text{s} it does so exponentially without ever reaching it. However, as a function of \\tau, r does reach r_\\text{s}.\nThe above solutions are valid while the integrand is finite, but a total solution may involve two or an infinity of pieces, each described by the integral but with alternating signs for the square root.\nWhen E = mc^2 and h = 0, we can solve for t and \\tau explicitly:\n:\\begin{align}\nt &= \\text{constant} \\pm \\frac{r_\\text{s}}c\\left(\\frac{2}{3}\\left(\\frac r{r_\\text{s}}\\right)^\\frac{3}{2} + 2\\sqrt{\\frac r{r_\\text{s}}} + \\ln\\frac{\\left|\\sqrt{\\frac{r}{r_\\text{s}}} - 1\\right|}{\\sqrt{\\frac{r}{r_\\text{s}}} + 1}\\right) \\\\\n\\tau &= \\text{constant}\\pm\\frac{2}{3}\\frac{r_\\text{s}}c\\left(\\frac r{r_\\text{s}}\\right)^\\frac{3}{2}\n\\end{align}\nand for photonic geodesics (m = 0) with zero angular momentum\n:\\begin{align}\nt &= \\text{constant} \\pm \\frac{1}{c}\\left(r + r_\\text{s}\\ln\\left|\\frac{r}{r_\\text{s}} - 1\\right|\\right) \\\\\n\\tau &= \\text{constant}.\n\\end{align}\n(Although the proper time is trivial in the photonic case, one can define an affine parameter \\lambda, and then the solution to the geodesic equation is r = c_1\\lambda + c_2.)\nAnother solvable case is that in which E = 0 and t and \\varphi are constant. In the volume where r  this gives for the proper time\n:\\tau=\\text{constant}\\pm\\frac{r_\\text{s}}c\\left(\\arcsin\\sqrt{\\frac r{r_\\text{s}}}-\\sqrt{\\frac r{r_\\text{s}}\\left(1-\\frac r{r_\\text{s}}\\right)}\\right).\nThis is close to solutions with \\frac{E^2}{m^2} small and positive. Outside of r_\\text{s} the E = 0 solution is tachyonic and the \"proper time\" is space-like:\n:\\tau=\\text{constant}\\pm i\\frac{r_\\text{s}}c\\left(\\ln\\left(\\sqrt{\\frac r{r_\\text{s}}}+\\sqrt{\\frac r{r_\\text{s}}-1}\\right)+\\sqrt{\\frac r{r_\\text{s}}\\left(\\frac r{r_\\text{s}}-1\\right)}\\right).\nThis is close to other tachyonic solutions with \\frac{E^2}{m^2} small and negative. The constant t tachyonic geodesic outside r_\\text{s} is not continued by a constant t geodesic inside r_\\text{s}, but rather continues into a \"parallel exterior region\" (see Kruskal–Szekeres coordinates). Other tachyonic solutions can enter a black hole and re-exit into the parallel exterior region. The constant t solution inside the event horizon (r_\\text{s}) is continued by a constant t solution in a white hole.\nWhen the angular momentum is not zero we can replace the dependence on proper time by a dependence on the angle \\varphi using the definition of h\n:\n\\left( \\frac{dr}{d\\varphi} \\right)^{2} =\n\\left( \\frac{dr}{d\\tau} \\right)^{2} \\left( \\frac{d\\tau}{d\\varphi} \\right)^{2} =\n\\left( \\frac{dr}{d\\tau} \\right)^{2} \\left( \\frac{ r^{2}}{h} \\right)^{2},\nwhich yields the equation for the orbit\n:\n\\left( \\frac{dr}{d\\varphi} \\right)^{2} = \\frac{r^{4}}{b^{2}} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( \\frac{r^{4}}{a^{2}} + r^{2} \\right)\nwhere, for brevity, two length-scales, a and b, have been defined by\n:\\begin{align}\na &= \\frac{h}{c}, \\\\\nb &= \\frac{cL}{E} = \\frac{hmc}E.\n\\end{align}\nNote that in the tachyonic case, a will be imaginary and b real or infinite.\nThe same equation can also be derived using a Lagrangian approach or the Hamilton–Jacobi equation (see below). The solution of the orbit equation is\n:\n\\varphi = \\int \\frac{dr}{\\pm r^{2} \\sqrt{\\frac{1}{b^{2}} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( \\frac{1}{a^{2}} + \\frac{1}{r^{2}} \\right)}}.\nThis can be expressed in terms of the Weierstrass elliptic function \\wp.\nLocal and delayed velocities\nUnlike in classical mechanics, in Schwarzschild coordinates \\frac{{\\rm d}r}{{\\rm d}\\tau} and r\\ \\frac{{\\rm d}\\varphi}{{\\rm d}\\tau} are not the radial v_{\\parallel} and transverse v_{\\perp} components of the local velocity v (relative to a stationary observer), instead they give the components for the celerity which are related to v by\n:\\frac{{\\rm d}r}{{\\rm d}\\tau} = v_\\parallel \\sqrt{1 - \\frac{r_\\text{s}}{r}}\\ \\gamma\nfor the radial and\n:\\frac{{\\rm d}\\varphi}{{\\rm d}\\tau} = \\frac{v_{\\perp}}{r} \\ \\gamma\nfor the transverse component of motion, with v^2 = v_{\\parallel}^2 + v_{\\perp}^2. The coordinate bookkeeper far away from the scene observes the shapiro-delayed velocity \\hat{v}, which is given by the relation\n:{\\hat v}_{\\perp} = v_{\\perp}\\sqrt{1 - \\frac{r_\\text{s}}{r}} and {\\hat v}_{\\parallel} = v_{\\parallel}\\left(1 - \\frac{r_\\text{s}}{r}\\right).\nThe time dilation factor between the bookkeeper and the moving test-particle can also be put into the form\n:\\frac{{\\rm d}\\tau}{{\\rm d}t} = \\frac{\\sqrt{1 - \\frac{r_\\text{s}}{r}}}{\\gamma}\nwhere the numerator is the gravitational, and the denominator is the kinematic component of the time dilation. For a particle falling in from infinity the left factor equals the right factor, since the in-falling velocity v matches the escape velocity c \\sqrt{\\frac{r_\\text{s}}{r}} in this case.\nThe two constants angular momentum L and total energy E of a test-particle with mass m are in terms of v\n: L = m\\ v_{\\perp}\\ r\\ \\gamma\nand\n: E = m c^2 \\ \\sqrt{1 - \\frac{r_\\text{s}}{r}}\\ \\gamma\nwhere\n: E = E_{\\rm rest} + E_{\\rm kin} + E_{\\rm pot}\nand\n: E_{\\rm rest} = m c^2\\ ,\\ \\ E_{\\rm kin} = (\\gamma - 1)mc^2\\ ,\\ \\ E_{\\rm pot} = \\left(\\sqrt{1 - \\frac{r_\\text{s}}{r}} - 1\\right)\\ \\gamma\\ m c^2\nFor massive testparticles \\gamma is the Lorentz factor \\gamma = 1/\\sqrt{1 - v^2/c^2} and \\tau is the proper time, while for massless particles like photons \\gamma is set to 1 and \\tau takes the role of an affine parameter. If the particle is massless E_{\\rm rest} is replaced with E_{\\rm kin} and m c^2 with h f, where h is the Planck constant and f the locally observed frequency.\nExact solution using elliptic functions\nThe fundamental equation of the orbit is easier to solveThis substitution of u for r is also common in classical central-force problems, since it also renders those equations easier to solve. For further information, please see the article on the classical central-force problem. if it is expressed in terms of the inverse radius u = \\frac{1}{r}\n:\n\\left( \\frac{du}{d\\varphi} \\right)^{2} = \\frac{1}{b^{2}} - \\left( 1 - u r_\\text{s} \\right) \\left( \\frac{1}{a^{2}} + u^{2} \\right)\nThe right-hand side of this equation is a cubic polynomial, which has three roots, denoted here as u_1, u_2, and u_3\n:\n\\left( \\frac{du}{d\\varphi} \\right)^{2} = r_\\text{s}  \\left( u - u_{1} \\right)  \\left( u - u_{2} \\right)  \\left( u - u_{3} \\right)\nThe sum of the three roots equals the coefficient of the u^2 term\n:\nu_{1} + u_{2} + u_{3} = \\frac{1}{r_\\text{s}}\nA cubic polynomial with real coefficients can either have three real roots, or one real root and two complex conjugate roots. If all three roots are real numbers, the roots are labeled so that u_1 .  If instead there is only one real root, then that is denoted as u_3; the complex conjugate roots are labeled u_1 and u_2.  Using Descartes' rule of signs, there can be at most one negative root; u_1 is negative if and only if b .  As discussed below, the roots are useful in determining the types of possible orbits.\nGiven this labeling of the roots, the solution of the fundamental orbital equation is\n:\nu = u_{1} + \\left( u_{2} - u_{1} \\right) \\, \\mathrm{sn}^{2}\\left( \\frac{1}{2} \\varphi \\sqrt{r_\\text{s} \\left( u_{3} - u_{1} \\right)} + \\delta \\right)\nwhere \\mathrm{sn} represents the  function (one of the Jacobi elliptic functions) and \\delta is a constant of integration reflecting the initial position. The elliptic modulus k of this elliptic function is given by the formula\n:\nk = \\sqrt{\\frac{u_{2} - u_{1}}{u_{3} - u_{1}}}\nNewtonian limit\nTo recover the Newtonian solution for the planetary orbits, one takes the limit as the Schwarzschild radius r_\\text{s} goes to zero.  In this case, the third root u_3 becomes roughly \\frac{1}{r_\\text{s}}, and much larger than u_1 or u_2.  Therefore, the modulus k tends to zero; in that limit, \\mathrm{sn} becomes the trigonometric sine function\n:\nu = u_{1} + \\left( u_{2} - u_{1} \\right) \\, \\sin^{2}\\left( \\frac{1}{2} \\varphi + \\delta \\right)\nConsistent with Newton's solutions for planetary motions, this formula describes a focal conic of eccentricity e\n:\ne = \\frac{u_{2} - u_{1}}{u_{2} + u_{1}}\nIf u_1 is a positive real number, then the orbit is an ellipse where u_1 and u_2 represent the distances of furthest and closest approach, respectively. If u_1 is zero or a negative real number, the orbit is a parabola or a hyperbola, respectively. In these latter two cases, u_2 represents the distance of closest approach; since the orbit goes to infinity (u = 0), there is no distance of furthest approach.\nRoots and overview of possible orbits\nA root represents a point of the orbit where the derivative vanishes, i.e., where \\frac{du}{d\\phi} = 0.  At such a turning point, u reaches a maximum, a minimum, or an inflection point, depending on the value of the second derivative, which is given by the formula\n:\n\\frac{d^{2}u}{d\\varphi^{2}} = \\frac{r_\\text{s}}{2} \\left[  \\left( u - u_{2} \\right)  \\left( u - u_{3} \\right)   +  \\left( u - u_{1} \\right)  \\left( u - u_{3} \\right)   +  \\left( u - u_{1} \\right)  \\left( u - u_{2} \\right)  \\right]\nIf all three roots are distinct real numbers, the second derivative is positive, negative, and positive at  u1, u2, and u3, respectively.  It follows that a graph of u versus φ may either oscillate between u1 and u2, or it may move away from u3 towards infinity (which corresponds to r going to zero). If u1 is negative, only part of an \"oscillation\" will actually occur. This corresponds to the particle coming from infinity, getting near the central mass, and then moving away again toward infinity, like the hyperbolic trajectory in the classical solution.\nIf the particle has just the right amount of energy for its angular momentum, u2 and u3 will merge. There are three solutions in this case. The orbit may spiral in to r = \\frac{1}{u_2} = \\frac{1}{u_3}, approaching that radius as (asymptotically) a decreasing exponential in φ, \\tau, or t. Or one can have a circular orbit at that radius. Or one can have an orbit that spirals down from that radius to the central point. The radius in question is called the inner radius and is between \\frac{3}{2} and 3 times rs. A circular orbit also results when u_2 is equal to u_1, and this is called the outer radius. These different types of orbits are discussed below.\nIf the particle comes at the central mass with sufficient energy and sufficiently low angular momentum then only u_1 will be real. This corresponds to the particle falling into a black hole. The orbit spirals in with a finite change in φ.\nPrecession of orbits\nThe function sn and its square sn2 have periods of 4K and 2K, respectively, where K is defined by the equation\n:\nK = \\int_0^1 \\frac{dy}{\\sqrt{\\left( 1 - y^2 \\right) \\left( 1 - k^2 y^2 \\right)}}\nTherefore, the change in φ over one oscillation of u (or, equivalently, one oscillation of r) equals\n:\n\\Delta\\varphi = \\frac{4K}{\\sqrt{r_\\text{s} \\left(u_3 - u_1\\right)}}\nIn the classical limit, u3 approaches \\frac{1}{r_\\text{s}} and is much larger than u_1 or u_2.  Hence, k^2 is approximately\n:\nk^2 = \\frac{u_2 - u_1}{u_3 - u_1} \\approx r_\\text{s} \\left(u_2 - u_1\\right) \\ll 1\nFor the same reasons, the denominator of Δφ is approximately\n:\n\\frac{1}{\\sqrt{r_\\text{s} \\left(u_3 - u_1\\right)}} =\n\\frac{1}{\\sqrt{1 - r_\\text{s} \\left(2u_1 + u_2\\right)}} \\approx\n1 + \\frac{1}{2} r_\\text{s} \\left(2u_1 + u_2\\right)\nSince the modulus k is close to zero, the period K can be expanded in powers of k; to lowest order, this expansion yields\n:\nK \\approx \\int_0^1 \\frac{dy}{\\sqrt{1 - y^2}} \\left( 1 + \\frac{1}{2} k^2 y^2 \\right) =\n\\frac{\\pi}{2} \\left( 1 + \\frac{k^2}{4} \\right)\nSubstituting these approximations into the formula for Δφ yields a formula for angular advance per radial oscillation\n:\n\\delta\\varphi = \\Delta\\varphi - 2\\pi \\approx \\frac{3}{2} \\pi r_\\text{s} \\left( u_1 + u_2 \\right)\nFor an elliptical orbit, u_1 and u_2 represent the inverses of the longest and shortest distances, respectively.  These can be expressed in terms of the ellipse's semi-major axis A and its orbital eccentricity e,\n:\\begin{align}\nr_\\text{max} &= \\frac{1}{u_{1}} = A(1 + e) \\\\\nr_\\text{min} &= \\frac{1}{u_{2}} = A(1 - e)\n\\end{align}\ngiving\n:\nu_1 + u_2 = \\frac{2}{A\\left( 1 - e^2 \\right)}\nSubstituting the definition of r_\\text{s} gives the final equation\n:\n\\delta\\varphi \\approx \\frac{6\\pi GM}{c^2 A\\left( 1 - e^2 \\right)}\nBending of light by gravity\nIn the limit as the particle mass m goes to zero (or, equivalently if the light is heading directly toward the central mass, as the length-scale a goes to infinity), the equation for the orbit becomes\n:\n\\varphi = \\int \\frac{dr}{r^{2} \\sqrt{\\frac{1}{b^{2}} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{1}{r^{2}}}}\nExpanding in powers of \\frac{r_\\text{s}}{r}, the leading order term in this formula gives the approximate angular deflection δφ for a massless particle coming in from infinity and going back out to infinity:\n:\n\\delta \\varphi \\approx \\frac{2r_\\text{s}}{b} = \\frac{4GM}{c^{2}b}.\nHere, b is the impact parameter, somewhat greater than the distance of closest approach, r_3:\nb = r_3\\sqrt{\\frac{r_3}{r_3 - r_\\text{s}}}\nAlthough this formula is approximate, it is accurate for most measurements of gravitational lensing, due to the smallness of the ratio \\frac{r_\\text{s}}{r}.  For light grazing the surface of the sun, the approximate angular deflection is roughly 1.75&nbsp;arcseconds, roughly one millionth part of a circle.\nMore generally, the geodesics of a photon with radial coordinate r\\in [ r_{s},\\infty )  can be calculated as follows, by applying the equation\n:{\\left( \\frac{dr}{d\\varphi} \\right)}^{2} = \\frac{r^4}{b^2} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( \\frac{r^4}{a^2} + r^2 \\right)\nwhich gives with u={1\\over r}\n:\n{\\left ( {du \\over d\\varphi} \\right )^2}=r_s\\ u^3-u^2+\\frac{1}{b^2}\nThe equation can be derived as\n:\n2\\ \\frac{du}{d\\varphi}\\frac{d^2u}{d\\varphi^2}=3\\ r_su^2\\frac{du}{d\\varphi}-2\\ u\\frac{du}{d\\varphi}\nwhich leads to\n:\n{d^2u\\over d\\varphi^2}=\\frac{3}{2}\\ r_s\\ u^2-\\ u\nThis equation with second derivative can be numerically integrated as follows by a 4th order Runge-Kutta method, considering a step size \\Delta\\varphi and with:\n:\nk_1={d^2u\\over d\\varphi^2}(u),\n:\nk_2={d^2u\\over d\\varphi^2}\\left(u+\\frac{\\Delta\\varphi}{2}{du\\over d\\varphi}\\right),\n:\nk_3={d^2u\\over d\\varphi^2}\\left(u+\\frac{\\Delta\\varphi}{2}{du\\over d\\varphi}+\\frac{\\Delta\\varphi^2}{4}k_{1}\\right) and\n:\nk_4={d^2u\\over d\\varphi^2}\\left(u+\\Delta\\varphi{du\\over d\\varphi}+\\frac{\\Delta\\varphi^2}{2}k_2\\right).\nThe value at the next step {du\\over d\\varphi}(\\varphi+\\Delta\\varphi) is\n:\n{du\\over d\\varphi}(\\varphi)+\\frac{\\Delta\\varphi}{6}(k_1+2k_{2}+2k_{3}+k_{4})\nand the value at the next step u(\\varphi+ \\Delta\\varphi) is\n:\nu(\\varphi)+\\Delta\\varphi{du\\over d\\varphi}(\\varphi)+\\frac{\\Delta\\varphi^2}{6}(k_{1}+k_{2}+k_{3})\nThe step \\Delta\\varphi can be chosen to be constant or adaptive, depending on the accuracy required on r = {1 \\over u}.\nRelation to Newtonian physics\nEffective radial potential energy\nThe equation of motion for the particle derived above\n:\n\\left( \\frac{dr}{d\\tau} \\right)^{2} =\n\\frac{E^2}{m^2 c^2} - c^{2} + \\frac{ r_\\text{s} c^2}{r} -\n\\frac{L^2}{ m\\mu r^2 } + \\frac{ r_\\text{s} L^2 }{ m \\mu r^3 }\ncan be rewritten using the definition of the Schwarzschild radius rs as\n:\n\\frac{1}{2} m \\left( \\frac{dr}{d\\tau} \\right)^{2} =\n\\left[ \\frac{E^2}{2 m c^2} - \\frac{1}{2} m c^2 \\right] +\n\\frac{GMm}{r} - \\frac{ L^2 }{ 2 \\mu r^2 } + \\frac{ G(M+m) L^2 }{c^2 \\mu r^3},\nwhich is equivalent to a particle moving in a one-dimensional effective potential\n:\nV(r) = -\\frac{GMm}{r} + \\frac{ L^2 }{ 2 \\mu r^2 } - \\frac{ G(M + m) L^2 }{ c^2 \\mu r^3 }\nThe first two terms are well-known classical energies, the first being the attractive Newtonian gravitational potential energy and the second corresponding to the repulsive \"centrifugal\" potential energy; however, the third term is an attractive energy unique to general relativity.  As shown below and elsewhere, this inverse-cubic energy causes elliptical orbits to precess gradually by an angle δφ per revolution\n:\n\\delta \\varphi \\approx \\frac{ 6\\pi G(M+m) }{ c^2 A \\left( 1 - e^{2} \\right)}\nwhere A is the semi-major axis and e is the eccentricity.\nThe third term is attractive and dominates at small r values, giving a critical inner radius rinner at which a particle is drawn inexorably inwards to r = 0; this inner radius is a function of the particle's angular momentum per unit mass or, equivalently, the a length-scale defined above.\nCircular orbits and their stability\nThe effective potential V can be re-written in terms of the length a = \\frac{h}{c}.\n:\nV(r) = \\frac{ \\mu c^{2}}{2} \\left[ - \\frac{r_\\text{s}}{r} + \\frac{a^{2}}{r^{2}} - \\frac{r_\\text{s} a^{2}}{r^{3}} \\right]\nCircular orbits are possible when the effective force is zero\n:\nF = -\\frac{dV}{dr} = -\\frac{ \\mu c^{2}}{2r^{4}} \\left[ r_\\text{s} r^{2} - 2a^{2} r + 3r_\\text{s} a^{2} \\right] = 0\ni.e., when the two attractive forces — Newtonian gravity (first term) and the attraction unique to general relativity (third term) — are exactly balanced by the repulsive centrifugal force (second term).  There are two radii at which this balancing can occur, denoted here as rinner and router\n:\\begin{align}\nr_\\text{outer} &= \\frac{a^{2}}{r_\\text{s}} \\left( 1 + \\sqrt{1 - \\frac{3r_\\text{s}^{2}}{a^{2}}} \\right) \\\\[3pt]\nr_\\text{inner} &= \\frac{a^{2}}{r_\\text{s}} \\left( 1 - \\sqrt{1 - \\frac{3r_\\text{s}^{2}}{a^{2}}} \\right) = \\frac{3a^{2}}{r_\\text{outer}}\n\\end{align}\nwhich are obtained using the quadratic formula.  The inner radius rinner is unstable, because the attractive third force strengthens much faster than the other two forces when r becomes small; if the particle slips slightly inwards from rinner (where all three forces are in balance), the third force dominates the other two and draws the particle inexorably inwards to r = 0.  At the outer radius, however, the circular orbits are stable; the third term is less important and the system behaves more like the non-relativistic Kepler problem.\nWhen a is much greater than r_\\text{s} (the classical case), these formulae become approximately\n:\\begin{align}\nr_\\text{outer} &\\approx \\frac{2a^{2}}{r_\\text{s}} \\\\[3pt]\nr_\\text{inner} &\\approx \\frac{3}{2} r_\\text{s}\n\\end{align}\nand Newton's law of gravity is plotted in black.]]\nSubstituting the definitions of a and rs into router yields the classical formula for a particle of mass m orbiting a body of mass M.\n:\nr_{\\mathrm{outer}}^{3} = \\frac{G(M+m)}{\\omega_{\\varphi}^{2}}\nwhere ωφ is the orbital angular speed of the particle.  This formula is obtained in non-relativistic mechanics by setting the centrifugal force equal to the Newtonian gravitational force:\n:\n\\frac{GMm}{r^{2}} = \\mu \\omega_{\\varphi}^{2} r\nWhere \\mu is the reduced mass.\nIn our notation, the classical orbital angular speed equals\n:\n\\omega_{\\varphi}^{2} \\approx \\frac{GM}{r_{\\mathrm{outer}}^{3}} = \\left( \\frac{r_\\text{s} c^{2}}{2r_{\\mathrm{outer}}^{3}} \\right) = \\left( \\frac{r_\\text{s} c^{2}}{2} \\right) \\left( \\frac{r_\\text{s}^{3}}{8a^{6}}\\right) = \\frac{c^{2} r_\\text{s}^{4}}{16 a^{6}}\nAt the other extreme, when a2 approaches 3rs2 from above, the two radii converge to a single value\n:\nr_{\\mathrm{outer}} \\approx r_{\\mathrm{inner}} \\approx 3 r_\\text{s}\nThe quadratic solutions above ensure that router is always greater than 3rs, whereas rinner lies between &nbsp;rs and 3rs.  Circular orbits smaller than &nbsp;rs are not possible.  For massless particles, a goes to infinity, implying that there is a circular orbit for photons at rinner = rs. The sphere of this radius is sometimes known as the photon sphere.\nPrecession of elliptical orbits\n, a particle follows the same perfect ellipse (red orbit) eternally. General relativity introduces a third force that attracts the particle slightly more strongly than Newtonian gravity, especially at small radii.  This third force causes the particle's elliptical orbit to precess (cyan orbit) in the direction of its rotation; this effect has been measured in Mercury, Venus and Earth.  The yellow dot within the orbits represents the center of attraction, such as the Sun.]]\nThe orbital precession rate may be derived using this radial effective potential V.  A small radial deviation from a circular orbit of radius router will oscillate stably with an angular frequency\n:\n\\omega_{r}^{2} = \\frac{1}{m} \\left[ \\frac{d^{2}V}{dr^{2}} \\right]_{r=r_{\\mathrm{outer}}}\nwhich equals\n:\n\\omega_{r}^{2} = \\left( \\frac{c^{2} r_\\text{s}}{2 r_{\\mathrm{outer}}^{4}} \\right) \\left( r_{\\mathrm{outer}} - r_{\\mathrm{inner}}\\right) =\n\\omega_{\\varphi}^{2} \\sqrt{1 - \\frac{3r_\\text{s}^{2}}{a^{2}}}\nTaking the square root of both sides and performing a Taylor series expansion yields\n:\n\\omega_{r} = \\omega_{\\varphi} \\left[ 1 - \\frac{3r_\\text{s}^{2}}{4a^{2}} + \\mathcal{O}\\left( \\frac{r_\\text{s}^{4}}{a^{4}} \\right) \\right]\nMultiplying by the period T of one revolution gives the precession of the orbit per revolution\n:\n\\delta \\varphi = T \\left( \\omega_{\\varphi} - \\omega_{r} \\right) \\approx 2\\pi \\left( \\frac{3r_\\text{s}^{2}}{4a^{2}} \\right) =\n\\frac{3\\pi m^{2} c^{2}}{2L^{2}} r_\\text{s}^{2}\nwhere we have used ωφT = 2п and the definition of the length-scale a.  Substituting the definition of the Schwarzschild radius rs gives\n:\n\\delta \\varphi \\approx \\frac{3\\pi m^{2} c^{2}}{2L^{2}} \\left( \\frac{4G^{2} M^{2}}{c^{4}} \\right) = \\frac{6\\pi G^{2} M^{2} m^{2}}{c^{2} L^{2}}\nThis may be simplified using the elliptical orbit's semiaxis A and eccentricity e related by the formula\n:\n\\frac{ h^2 }{ G(M+m) } = A \\left( 1 - e^2 \\right)\nto give the precession angle\n:\n\\delta \\varphi \\approx \\frac{6\\pi G(M+m)}{c^2 A \\left( 1 - e^{2} \\right)}\nMathematical derivations of the orbital equation\nChristoffel symbols\nThe non-vanishing Christoffel symbols for the Schwarzschild-metric are:\n: \\begin{align}\n\\Gamma^t_{rt} = -\\Gamma^r_{rr} &=  \\frac{r_\\text{s}}{2r(r - r_\\text{s})} \\\\[3pt]\n\\Gamma^r_{tt} &=  \\frac{r_\\text{s}(r - r_\\text{s})}{2r^3} \\\\[3pt]\n\\Gamma^r_{\\phi\\phi} &=  (r_\\text{s} - r)\\sin^2(\\theta) \\\\[3pt]\n\\Gamma^r_{\\theta\\theta} &=  r_\\text{s} - r \\\\[3pt]\n\\Gamma^\\theta_{r\\theta} = \\Gamma^\\phi_{r\\phi} &=  \\frac{1}{r} \\\\[3pt]\n\\Gamma^\\theta_{\\phi\\phi} &= -\\sin(\\theta)\\cos(\\theta) \\\\[3pt]\n\\Gamma^\\phi_{\\theta\\phi} &=  \\cot(\\theta)\n\\end{align}\nGeodesic equation\nAccording to Einstein's theory of general relativity, particles of negligible mass travel along geodesics in the space-time.  In flat space-time, far from a source of gravity, these geodesics correspond to straight lines; however, they may deviate from straight lines when the space-time is curved.  The equation for the geodesic lines is\n:\n\\frac{d^2x^{\\lambda}}{d q^2} + \\Gamma^{\\lambda}_{\\mu\\nu} \\frac{dx^{\\mu}}{d q} \\frac{dx^{\\nu}}{dq} = 0\nwhere Γ represents the Christoffel symbol and the variable q parametrizes the particle's path through space-time, its so-called world line.  The Christoffel symbol depends only on the metric tensor g_{\\mu\\nu}, or rather on how it changes with position. The variable q is a constant multiple of the proper time \\tau for timelike orbits (which are traveled by massive particles), and is usually taken to be equal to it.  For lightlike (or null) orbits (which are traveled by massless particles such as the photon), the proper time is zero and, strictly speaking, cannot be used as the variable q. Nevertheless, lightlike orbits can be derived as the ultrarelativistic limit of timelike orbits, that is, the limit as the particle mass m goes to zero while holding its total energy fixed.\nTherefore, to solve for the motion of a particle, the most straightforward way is to solve the geodesic equation, an approach adopted by Einstein and others.  The Schwarzschild metric may be written as\n:\nc^{2}d\\tau^{2} = w(r) c^2 dt^{2} - v(r) dr^{2} - r^{2} d\\theta^{2} - r^{2} \\sin^{2} \\theta d\\phi^{2}\n\\,\nwhere the two functions w(r) = 1 - \\frac{r_\\text{s}}{r}and its reciprocal v(r)= \\frac{1}{w(r)}are defined for brevity.  From this metric, the Christoffel symbols \\Gamma_{\\mu\\nu}^{\\lambda}may be calculated, and the results substituted into the geodesic equations\n:\\begin{align}\n0 &= \\frac{d^{2}\\theta}{dq^{2}} + \\frac{2}{r} \\frac{d\\theta}{dq} \\frac{dr}{dq} - \\sin \\theta \\cos \\theta \\left( \\frac{d\\phi}{dq} \\right)^{2} \\\\[3pt]\n0 &= \\frac{d^{2}\\phi}{dq^{2}} + \\frac{2}{r} \\frac{d\\phi}{dq} \\frac{dr}{dq} + 2 \\cot \\theta \\frac{d\\phi}{dq} \\frac{d\\theta}{dq} \\\\[3pt]\n0 &= \\frac{d^{2}t}{dq^{2}} + \\frac{1}{w} \\frac{dw}{dr} \\frac{dt}{dq} \\frac{dr}{dq} \\\\[3pt]\n0 &= \\frac{d^{2}r}{dq^{2}} - \\frac{1}{v} \\frac{dv}{dr} \\left( \\frac{dr}{dq} \\right)^{2} - \\frac{r}{v} \\left( \\frac{d\\theta}{dq} \\right)^{2} - \\frac{r\\sin^{2}\\theta}{v} \\left( \\frac{d\\phi}{dq} \\right)^{2} + \\frac{c^{2}}{2v} \\frac{dw}{dr} \\left( \\frac{dt}{dq} \\right)^{2}\n\\end{align}\nIt may be verified that \\theta = \\frac{\\pi}{2} is a valid solution by substitution into the first of these four equations.  By symmetry, the orbit must be planar, and we are free to arrange the coordinate frame so that the equatorial plane is the plane of the orbit.  This \\theta solution simplifies the second and fourth equations.\nTo solve the second and third equations, it suffices to divide them by \\frac{d\\phi}{dq} and \\frac{dt}{dq}, respectively.\n:\\begin{align}\n0 &= \\frac{d}{dq} \\left[ \\ln \\frac{d\\phi}{dq} + \\ln r^{2} \\right] \\\\[3pt]\n0 &= \\frac{d}{dq} \\left[ \\ln \\frac{dt}{dq} + \\ln w \\right],\n\\end{align}\nwhich yields two constants of motion.\nLagrangian approach\nBecause test particles follow geodesics in a fixed metric, the orbits of those particles may be determined using the calculus of variations, also called the Lagrangian approach.  Geodesics in space-time are defined as curves for which small local variations in their coordinates (while holding their endpoints events fixed) make no significant change in their overall length s.  This may be expressed mathematically using the calculus of variations\n:\n0 = \\delta s = \\delta \\int ds =\n\\delta \\int \\sqrt{g_{\\mu\\nu} \\frac{dx^{\\mu}}{d\\tau} \\frac{dx^{\\nu}}{d\\tau}} d\\tau =\n\\delta \\int \\sqrt{2T} d\\tau\nwhere τ is the proper time, s = cτ is the arc-length in space-time and T is defined as\n:\n2T = c^{2} = \\left( \\frac{ds}{d\\tau} \\right)^{2} =\ng_{\\mu\\nu} \\frac{dx^{\\mu}}{d\\tau} \\frac{dx^{\\nu}}{d\\tau} =\n\\left( 1 - \\frac{r_\\text{s}}{r} \\right) c^{2} \\left( \\frac{dt}{d\\tau} \\right)^{2} -\n\\frac{1}{1 - \\frac{r_\\text{s}}{r}} \\left( \\frac{dr}{d\\tau} \\right)^{2} -\nr^{2} \\left( \\frac{d\\varphi}{d\\tau} \\right)^{2}\nin analogy with kinetic energy.  If the derivative with respect to proper time is represented by a dot for brevity\n:\n\\dot{x}^{\\mu} = \\frac{dx^{\\mu}}{d\\tau}\nT may be written as\n:\n2T = c^{2} =\n\\left( 1 - \\frac{r_\\text{s}}{r} \\right) c^{2} \\left( \\dot{t} \\right)^{2} -\n\\frac{1}{1 - \\frac{r_\\text{s}}{r}} \\left( \\dot{r} \\right)^{2} -\nr^{2} \\left( \\dot{\\varphi} \\right)^{2}\nConstant factors (such as c or the square root of two) don't affect the answer to the variational problem; therefore, taking the variation inside the integral yields Hamilton's principle\n:\n0 = \\delta \\int \\sqrt{2T} d\\tau =\n\\int \\frac{\\delta T}{\\sqrt{2T}} d\\tau =\n\\frac{1}{c} \\delta \\int T d\\tau.\nThe solution of the variational problem is given by Lagrange's equations\n:\n\\frac{d}{d\\tau} \\left(\\frac{\\partial T}{\\partial \\dot{x}^{\\sigma}} \\right) =\n\\frac{\\partial T}{\\partial x^{\\sigma}}.\nWhen applied to t and φ, these equations reveal two constants of motion\n:\\begin{align}\n\\frac{d}{d\\tau} \\left[ r^{2} \\frac{d\\varphi}{d\\tau} \\right] &= 0, \\\\\n\\frac{d}{d\\tau} \\left[ \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau} \\right] &= 0,\n\\end{align}\nwhich may be expressed in terms of two constant length-scales, a and b\n:\\begin{align}\nr^{2} \\frac{d\\varphi}{d\\tau} &= ac, \\\\\n\\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau} &= \\frac{a}{b}.\n\\end{align}\nAs shown above, substitution of these equations into the definition of the Schwarzschild metric yields the equation for the orbit.\nHamiltonian approach\nA Lagrangian solution can be recast into an equivalent Hamiltonian form.  In this case, the Hamiltonian H is given by\n:\n2 H = c^{2} = \\frac{p_{t}^{2}}{c^{2} \\left( 1 - \\frac{r_\\text{s}}{r} \\right)} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) p_{r}^{2} - \\frac{p_{\\theta}^{2}}{r^{2}} - \\frac{p_{\\varphi}^{2}}{r^{2}\\sin^{2} \\theta}\nOnce again, the orbit may be restricted to \\theta = \\frac{\\pi}{2}by symmetry.  Since t and \\varphi do not appear in the Hamiltonian, their conjugate momenta are constant; they may be expressed in terms of the speed of light c and two constant length-scales a and b\n:\\begin{align}\np_{\\varphi} &= -ac \\\\\np_{\\theta} &= 0 \\\\\np_{t} &= \\frac{ac^{2}}{b}\n\\end{align}\nThe derivatives with respect to proper time are given by\n:\\begin{align}\n\\frac{dr}{d\\tau} &= \\frac{\\partial H}{\\partial p_{r}} = - \\left(1 - \\frac{r_\\text{s}}{r} \\right) p_{r} \\\\\n\\frac{d\\varphi}{d\\tau} &= \\frac{\\partial H}{\\partial p_{\\varphi}} = \\frac{-p_{\\varphi}}{r^{2}}  = \\frac{ac}{r^{2}} \\\\\n\\frac{dt}{d\\tau} &= \\frac{\\partial H}{\\partial p_{t}} = \\frac{p_{t}}{c^{2} \\left( 1 - \\frac{r_\\text{s}}{r} \\right)} = \\frac{a}{b \\left( 1 - \\frac{r_\\text{s}}{r} \\right)}\n\\end{align}\nDividing the first equation by the second yields the orbital equation\n:\n\\frac{dr}{d\\varphi} = - \\frac{r^{2}}{ac} \\left(1 - \\frac{r_\\text{s}}{r} \\right) p_{r}\nThe radial momentum pr can be expressed in terms of r using the constancy of the Hamiltonian H = \\frac{c^{2}}{2}; this yields the fundamental orbital equation\n:\n\\left( \\frac{dr}{d\\varphi} \\right)^{2} = \\frac{r^{4}}{b^{2}} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( \\frac{r^{4}}{a^{2}} + r^{2} \\right)\nHamilton&ndash;Jacobi approach\nThe orbital equation can be derived from the Hamilton&ndash;Jacobi equation.  The advantage of this approach is that it equates the motion of the particle with the propagation of a wave, and leads neatly into the derivation of the deflection of light by gravity in general relativity, through Fermat's principle.  The basic idea is that, due to gravitational slowing of time, parts of a wave-front closer to a gravitating mass move more slowly than those further away, thus bending the direction of the wave-front's propagation.\nUsing general covariance, the Hamilton&ndash;Jacobi equation for a single particle of unit mass can be expressed in arbitrary coordinates as\n:\ng^{\\mu\\nu} \\frac{\\partial S}{\\partial x^{\\mu}} \\frac{\\partial S}{\\partial x^{\\nu}} = c^{2}.\nThis is equivalent to the Hamiltonian formulation above, with the partial derivatives of the action taking the place of the generalized momenta.  Using the Schwarzschild metric gμν, this equation becomes\n:\n\\frac{1}{c^{2} \\left(1 - \\frac{r_\\text{s}}{r} \\right)} \\left( \\frac{\\partial S}{\\partial t} \\right)^{2} -\n\\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( \\frac{\\partial S}{\\partial r} \\right)^{2} -\n\\frac{1}{r^{2}} \\left( \\frac{\\partial S}{\\partial \\varphi} \\right)^{2} = c^{2}\nwhere we again orient the spherical coordinate system with the plane of the orbit.  The time t and azimuthal angle φ are cyclic coordinates, so that the solution for Hamilton's principal function S can be written\n:\nS = -p_{t} t + p_{\\varphi} \\varphi + S_{r}(r) \\,\nwhere p_t and p_{\\varphi} are the constant generalized momenta.  The Hamilton&ndash;Jacobi equation gives an integral solution for the radial part S_r(r)\n:\nS_{r}(r) = \\int^{r} \\frac{dr}{1 - \\frac{r_\\text{s}}{r}} \\sqrt{\\frac{p_{t}^{2}}{c^{2}} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( c^{2} + \\frac{p_{\\varphi}^{2}}{r^{2}} \\right)}.\nTaking the derivative of Hamilton's principal function S with respect to the conserved momentum pφ yields\n:\n\\frac{\\partial S}{\\partial p_{\\varphi}} = \\varphi + \\frac{\\partial S_{r}}{\\partial p_{\\varphi}} = \\mathrm{constant}\nwhich equals\n:\n\\varphi - \\int^{r} \\frac{p_{\\varphi} dr}{r^{2}\\sqrt{\\frac{p_{t}^{2}}{c^{2}} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( c^{2} + \\frac{p_{\\varphi}^{2}}{r^{2}} \\right)}} = \\mathrm{constant}\nTaking an infinitesimal variation in φ and r yields the fundamental orbital equation\n:\n\\left( \\frac{dr}{d\\varphi} \\right)^{2} = \\frac{r^{4}}{b^{2}} -  \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( \\frac{r^{4}}{a^{2}} + r^{2} \\right).\nwhere the conserved length-scales a and b are defined by the conserved momenta by the equations\n:\\begin{align}\n\\frac{\\partial S}{\\partial \\varphi} = p_{\\varphi} &= -ac \\\\\n\\frac{\\partial S}{\\partial t} = p_{t} &= \\frac{ac^{2}}{b}\n\\end{align}\nHamilton's principle\nThe action integral for a particle affected only by gravity is\n:\nS = \\int{ - m c^2 d\\tau} = - m c \\int{ c \\frac{d\\tau}{dq} dq} = - m c \\int{ \\sqrt{-g_{\\mu\\nu} \\frac{dx^{\\mu}}{dq} \\frac{dx^{\\nu}}{dq} } dq}\nwhere \\tau is the proper time and q is any smooth parameterization of the particle's world line. If one applies the calculus of variations to this, one again gets the equations for a geodesic. To simplify the calculations, one first takes the variation of the square of the integrand. For the metric and coordinates of this case and assuming that the particle is moving in the equatorial plane \\theta = \\frac{\\pi}{2}, that square is\n:\n\\left(c \\frac{d\\tau}{dq}\\right)^2 = - g_{\\mu\\nu} \\frac{dx^{\\mu}}{dq} \\frac{dx^{\\nu}}{dq} =\n\\left( 1 - \\frac{r_\\text{s}}{r} \\right) c^{2} \\left( \\frac{dt}{dq} \\right)^{2} -\n\\frac{1}{1 - \\frac{r_\\text{s}}{r}} \\left( \\frac{dr}{dq} \\right)^{2} -\nr^{2} \\left( \\frac{d\\varphi}{dq} \\right)^{2}\n\\,.\nTaking variation of this gives\n:\n\\delta \\left(c \\frac{d\\tau}{dq}\\right)^2 = 2 c^{2} \\frac{d\\tau}{dq} \\delta \\frac{d\\tau}{dq} =\n\\delta \\left[ \\left( 1 - \\frac{r_\\text{s}}{r} \\right) c^{2} \\left( \\frac{dt}{dq} \\right)^{2} -\n\\frac{1}{1 - \\frac{r_\\text{s}}{r}} \\left( \\frac{dr}{dq} \\right)^{2} -\nr^{2} \\left( \\frac{d\\varphi}{dq} \\right)^{2} \\right]\n\\,.\nMotion in longitude\nVary with respect to longitude \\varphi only to get\n:\n2 c^{2} \\frac{d\\tau}{dq} \\delta \\frac{d\\tau}{dq} =\n- 2 r^{2} \\frac{d\\varphi}{dq} \\delta \\frac{d\\varphi}{dq}\n\\,.\nDivide by 2 c \\frac{d\\tau}{dq} to get the variation of the integrand itself\n:\nc \\, \\delta \\frac{d\\tau}{dq} = - \\frac{r^{2}}{c} \\frac{d\\varphi}{d\\tau} \\delta \\frac{d\\varphi}{dq}\n= - \\frac{r^{2}}{c} \\frac{d\\varphi}{d\\tau} \\frac{d \\delta \\varphi}{dq}\n\\,.\nThus\n:\n0 = \\delta \\int { c \\frac{d\\tau}{dq} dq } = \\int { c \\delta \\frac{d\\tau}{dq} dq } =\n\\int { - \\frac{r^{2}}{c} \\frac{d\\varphi}{d\\tau} \\frac{d \\delta \\varphi}{dq} dq }\n\\,.\nIntegrating by parts gives\n:\n0 = - \\frac{r^{2}}{c} \\frac{d\\varphi}{d\\tau} \\delta \\varphi\n- \\int { \\frac{d}{dq} \\left[ - \\frac{r^{2}}{c} \\frac{d\\varphi}{d\\tau} \\right] \\delta \\varphi dq }\n\\,.\nThe variation of the longitude is assumed to be zero at the end points, so the first term disappears. The integral can be made nonzero by a perverse choice of \\delta \\varphi unless the other factor inside is zero everywhere. So the equation of motion is\n:\n\\frac{d}{dq} \\left[ - \\frac{r^{2}}{c} \\frac{d\\varphi}{d\\tau} \\right] = 0\n\\,.\nMotion in time\nVary with respect to time t only to get\n:\n2 c^{2} \\frac{d\\tau}{dq} \\delta \\frac{d\\tau}{dq} =\n2 \\left( 1 - \\frac{r_\\text{s}}{r} \\right) c^{2} \\frac{dt}{dq} \\delta \\frac{dt}{dq}\n\\,.\nDivide by 2 c \\frac{d\\tau}{dq} to get the variation of the integrand itself\n:\nc \\delta \\frac{d\\tau}{dq} =\nc \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau} \\delta \\frac{dt}{dq}\n= c \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau} \\frac{d \\delta t}{dq}\n\\,.\nThus\n:\n0 = \\delta \\int { c \\frac{d\\tau}{dq} dq }\n= \\int { c \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau} \\frac{d \\delta t}{dq} dq }\n\\,.\nIntegrating by parts gives\n:\n0 = c \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau} \\delta t\n- \\int { \\frac{d}{dq} \\left[ c \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau} \\right] \\delta t dq }\n\\,.\nSo the equation of motion is\n:\n\\frac{d}{dq} \\left[ c \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau} \\right] = 0\n\\,.\nConserved momenta\nIntegrate these equations of motion to determine the constants of integration getting\n:\\begin{align}\nL = p_{\\phi} &= m r^{2} \\frac{d\\varphi}{d\\tau}\\,, \\\\\nE = - p_{t} &= m c^2 \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{dt}{d\\tau}\\,.\n\\end{align}\nThese two equations for the constants of motion L (angular momentum) and E (energy) can be combined to form one equation that is true even for photons and other massless particles for which the proper time along a geodesic is zero.\n:\n\\frac{d\\varphi}{dt} = \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\frac{L \\, c^2}{E \\, r^2}\n\\,.\nRadial motion\nSubstituting\n:\n\\frac{d\\varphi}{d\\tau} = \\frac{L}{m \\, r^2}\n\\,\nand\n:\n\\frac{dt}{d\\tau} = \\frac{E}{\\left( 1 - \\frac{r_\\text{s}}{r} \\right) m \\, c^2}\n\\,\ninto the metric equation (and using \\theta = \\frac{\\pi}{2}) gives\n:\nc^{2} = \\frac{1}{1 - \\frac{r_\\text{s}}{r}} \\, \\frac{E^2}{m^2 c^2} -\n\\frac{1}{1 - \\frac{r_\\text{s}}{r}} \\left( \\frac{dr}{d\\tau} \\right)^{2} -\n\\frac{1}{r^{2}} \\, \\frac{L^2}{m^2}\n\\,,\nfrom which one can derive\n:\n{\\left( \\frac{dr}{d\\tau} \\right)}^{2} = \\frac{E^2}{m^2 c^2} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( c^{2} + \\frac{L^2}{m^2 r^2} \\right)\n\\,,\nwhich is the equation of motion for r. The dependence of r on \\varphi can be found by dividing this by\n:{\\left( \\frac{d\\varphi}{d\\tau} \\right)}^2 = \\frac{L^2}{m^2 r^4}\nto get\n:\n{\\left( \\frac{dr}{d\\varphi} \\right)}^{2} = \\frac{E^2 r^4}{L^2 c^2} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( \\frac{m^2 c^{2} r^4}{L^2} + r^2 \\right)\n\\,\nwhich is true even for particles without mass. If length scales are defined by\n:\na = \\frac{L}{m \\, c}\nand\n:\nb = \\frac{L \\, c}{E}\n\\,,\nthen the dependence of r on \\varphi simplifies to\n:{\\left( \\frac{dr}{d\\varphi} \\right)}^{2} = \\frac{r^4}{b^2} - \\left( 1 - \\frac{r_\\text{s}}{r} \\right) \\left( \\frac{r^4}{a^2} + r^2 \\right)\n\\,.\nSee also\n* Classical central-force problem\n* Frame fields in general relativity\n* Kepler problem\n* Two-body problem in general relativity\nNotes\nReferences\nBibliography\n* Schwarzschild, K. (1916). Über das Gravitationsfeld eines Massenpunktes nach der Einstein'schen Theorie. Sitzungsberichte der Königlich Preussischen Akademie der Wissenschaften 1, 189–196.\n** [https://www.scribd.com/doc/25310028/schwarzschild-1916 scan of the original paper]\n** [http://de.wikisource.org/wiki/%C3%9Cber_das_Gravitationsfeld_eines_Massenpunktes_nach_der_Einsteinschen_Theorie text of the original paper, in Wikisource]\n** [https://arxiv.org/abs/physics/9905030 translation by Antoci and Loinger]\n** [https://arxiv.org/abs/0709.2257 a commentary on the paper, giving a simpler derivation]\n* Schwarzschild, K. (1916).  Über das Gravitationsfeld einer Kugel aus inkompressibler Flüssigkeit. Sitzungsberichte der Königlich Preussischen Akademie der Wissenschaften 1, 424-?.\n*\n*\n*\n*\n*\n*\n*  (See Gravitation (book).)\n*\n*\n*\n*\n*\n*\n*\n*\n*\nExternal links\n* [http://www.mathpages.com/rr/s6-02/6-02.htm Excerpt] from Reflections on Relativity by Kevin Brown."
    }
  ]
}