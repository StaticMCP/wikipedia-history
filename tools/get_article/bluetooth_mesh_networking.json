{
  "content": [
    {
      "type": "text",
      "text": "# Bluetooth mesh networking\n\n| industry    = Lighting, IoT\n| connector   =\n| hardware    =\n| range       = 100–1000 meters (depending on mesh relaying configuration)\n}}\nBluetooth Mesh is a computer mesh networking standard based on Bluetooth Low Energy that allows for many-to-many communication over Bluetooth radio. The Bluetooth Mesh specifications were defined in the Mesh Profile and Mesh Model specifications by the Bluetooth Special Interest Group (Bluetooth SIG). Bluetooth Mesh was conceived in 2014 and adopted on .\nOverview\nBluetooth Mesh is a mesh networking standard that operates on a flood network principle. It's based on the nodes relaying the messages: every relay node that receives a network packet that\n* authenticates against a known network key\n* is not in message cache\n* has a TTL ≥ 2\ncan be retransmitted with TTL = TTL − 1. Message caching is used to prevent relaying recently seen messages.\nCommunication is carried in the messages that may be up to 384 bytes long, when using Segmentation and Reassembly (SAR) mechanism, but most of the messages fit in one segment, that is 11 bytes. Each message starts with an opcode, which may be a single byte (for special messages), 2 bytes (for standard messages), or 3 bytes (for vendor-specific messages).\nEvery message has a source and a destination address, determining which devices process messages. Devices publish messages to destinations which can be single things / groups of things / everything.\nEach message has a sequence number that protects the network against replay attacks.\nEach message is encrypted and authenticated. Two keys are used to secure messages: (1) network keys – allocated to a single mesh network, (2) application keys – specific for a given application functionality, e.g. turning the light on vs reconfiguring the light.\nMessages have a time to live (TTL). Each time message is received and retransmitted, TTL is decremented which limits the number of \"hops\", eliminating endless loops.\nArchitecture\nBluetooth Mesh has a layered architecture, with multiple layers as below.\n{| class=\"wikitable\"\n!Layer\n!Functionality\n|-\n|Model&nbsp;Layer\n|It defines a standard way to exchange application specific messages. For example, a Light Lightness Model defines an interoperable way to control lightness. There are mandatory models, called Foundation Models, defining states and messages needed to manage a mesh network.\n|-\n|Access&nbsp;Layer\n|It defines mechanism to ensure that data is transmitted and received in the right context of a model and its associated application keys.\n|-\n|Upper&nbsp;Transport&nbsp;Layer\n|It defines authenticated encryption of access layer packets using an application (or device specific key). It also defines some control messages to manage Friendship or to notify the behavior of node using Heartbeat messages.\n|-\n|Lower&nbsp;Transport&nbsp;Layer\n|This layer defines a reliable (through a Block Acknowledgement) Segmented transmission upper layer packets, when a complete upper layer packet can't be carried in a single network layer packet. It also defines a mechanism to reassemble segments on the receiver.\n|-\n|Network&nbsp;Layer\n|This layer defines how transport packets are addressed over network to one or more nodes. It defines relay functionality for forwarding messages by a relay node to extended the range. It handles the network layer authenticated encryption using network key.\n|-\n|Bearer&nbsp;Layer\n|It defines how the network packets are exchanged between nodes. Mesh Profile Specification defines BLE advert bearer and BLE GATT bearer. Mesh Profile defines Proxy Protocol, through which mesh packets can be exchanged via other bearers like TCP/IP.\n|}\nTypes of nodes\nNodes that support the various features can be formed into a particular mesh network topology.\n{| class=\"wikitable\"\n!Feature\n!Functionality\n|-\n|Relay\n|receive and retransmit mesh messages over the advertising bearer\nto enable larger networks.\n|-\n|Proxy\n|receive and retransmit mesh messages between GATT and\nadvertising bearers.\n|-\n|Low Power\n|operate within a mesh network at significantly reduced receiver\nduty cycles only in conjunction with a node supporting the Friend feature.\n|-\n|Friend\n|help a node supporting the Low Power feature to operate by storing\nmessages destined for those nodes.\n|}\nTheoretical limits\nThe practical limits of Bluetooth Mesh technology are unknown. Some limits that are built into the specification include:\n{| class=\"wikitable\"\n!Limit for a network\n!Value\n!Remarks\n|-\n|Maximum number of nodes\n|32 767\n|The limit is 32768 addresses and while a node may occupy more than one address, the practical limit is most likely lower.\n|-\n|Maximum number of groups\n|16 384\nNumber of virtual groups is 2128.\n|\n|-\n|Maximum number of scenes\n|65 535\n|\n|-\n|Maximum number of subnets\n|4 096\n|\n|-\n|Maximum TTL\n|127\n|\n|}\nMesh models\nAs of version 1.0 of Bluetooth Mesh specification, the following standard models and model groups have been defined:\nFoundation models\nFoundation models have been defined in the core specification. Two of them are mandatory for all mesh nodes.\n* Configuration Server (mandatory)\n* Configuration Client\n* Health Server (mandatory)\n* Health Client\nGeneric models\n* Generic OnOff Server, used to represent devices that do not fit any of the model descriptions defined but support the generic properties of On/Off\n* Generic Level Server, keeping the state of an element in a 16-bit signed integer\n* Generic Default Transition Time Server, used to represent a default transition time for a variety of devices\n* Generic Power OnOff Server & Generic Power OnOff Setup Server, used to represent devices that do not fit any of the model descriptions but support the generic properties of On/Off\n* Generic Power Level Server & Generic Power Level Setup Server, including a Generic Power Actual state, a Generic Power Last state, a Generic Power Default state and a Generic Power Range state\n* Generic Battery Server, representing a set of four values representing the state of a battery\n* Generic Location Server & Generic Location Setup Server, representing location information of an element, either global (Lat/Lon) or local\n* Generic User/Admin/Manufacturer/Client Property Server, representing any value to be stored by an element\n* Generic OnOff Client & Generic Level Client\n* Generic Default Transition Time Client\n* Generic Power OnOff Client & Generic Power Level Client\n* Generic Battery Client\n* Generic Location Client\n* Generic Property Client\nSensors\n* Sensor Server & Sensor Setup Server, representing a sensor device. Sensor device may be configured to return a measured value periodically or on request; measurement period (cadence) may be configured to be fixed or to change, so that more important value range is being reported faster.\n* Sensor Client\nTime and scenes\n* Time Server & Time Setup Server, allowing for time synchronization in mesh network\n* Scene Server & Scene Setup Server, allowing for up to 65535 scenes to be configured and recalled when needed.\n* Scheduler Server & Scheduler Setup Server\n* Time Client, Scene Client & Scheduler Client\nLighting\n* Light Lightness Server & Light Lightness Setup Server, representing a dimmable light source\n* Light CTL Server, Light CTL Temperature Server & Light CTL Setup Server, representing a CCT or \"tunable white\" light source\n* Light HSL Server, Light HSL Hue Server, Light HSL Saturation Server & Light HSL Setup Server, representing a light source based on Hue, Saturation, Lightness color representation\n* Light xyL Server & Light xyL Setup Server, representing a light source based on modified CIE xyY color space.\n* Light LC (Lightness Control) Server & Light LC Setup Server, representing a light control device, able to control Light Lightness model using an occupancy sensor and ambient light sensor. It may be used for light control scenarios like Auto-On, Auto-Off and/or Daylight Harvesting.\n* Light Lightness Client, Light CTL Client, Light HSL Client, Light xyL Client & Light LC Client\nProvisioning\nProvisioning is a process of installing the device into a network. It is a mandatory step to build a Bluetooth Mesh network.\nIn the provisioning process, a provisioner securely distributes a network key and a unique address space for a device. The provisioning protocol uses P256 Elliptic Curve Diffie-Hellman Key Exchange to create a temporary key to encrypt network key and other information. This provides security from a passive eavesdropper.\nIt also provides various authentication mechanisms to protect network information, from an active eavesdropper who uses man-in-the-middle attack, during provisioning process.\nA key unique to a device known as \"Device Key\" is derived from elliptic curve shared secret on provisioner and device during the provisioning process. This device key is used by the provisioner to encrypt messages for that specific device.\nThe security of the provisioning process has been analyzed in a paper presented during the IEEE CNS 2018 conference.\nThe provisioning can be performed using a Bluetooth GATT connection or advertising using the specific bearer.\nTerminology used in the Bluetooth Mesh Model and Mesh Profile specifications\n* Destination: The address to which a message is sent.\n* Element: An addressable entity within a device.\n* Model: Standardized operation of typical user scenarios.\n* Node: A provisioned device.\n* Provisioner: A node that can add a device to a mesh network.\n* Relay: A node able to retransmit messages.\n* Source: The address from which a message is sent.\nImplementations\nApproved (\"qualified\") by Bluetooth SIG\n{| class=\"wikitable sortable\"\n|+Bluetooth mesh implementations approved (\"qualified\") by Bluetooth SIG\n!Name\n!Submitter\n!Qualification date\n!QDID\n!Type\n|-\n|Bluetooth Stack for Embedded Systems - MESH profile\n|Silvair, Inc.\n|\n|98880\n|Profile Subsystem\n|-\n|Qualcomm Bluetooth Mesh\n|Qualcomm Technologies International, Ltd.\n|\n|98856\n|Profile Subsystem\n|-\n|Silvair Mesh Models\n|Silvair, Inc.\n|\n|99282\n|Profile Subsystem\n|-\n|Wireless Gecko Mesh Profile\n|Silicon Laboratories\n|\n|101318\n|Profile Subsystem\n|-\n|CYW-MESH 1.0\n|Cypress Semiconductor Corporation\n|\n|101726\n|Component (Tested)\n|-\n|Qualcomm Bluetooth Mesh Model\n|Qualcomm Technologies International, Ltd.\n|\n|102243\n|Profile Subsystem\n|-\n|EtherMind Bluetooth Protocol Stack, 5.0 (Single Mode) + Mesh\n|Mindtree Limited\n|\n|106544\n|Component (Tested)\n|-\n|Telink SIG Mesh SDK\n|Telink Semiconductor\n|\n|106546\n|Profile Subsystem\n|-\n|TOSHIBA Bluetooth_stack_mesh-1\n|Toshiba Corporation\n|\n|104143\n|Component (Tested)\n|-\n|AMICCOM Mesh Profile\n|AMICCOM Electronics Corporation\n|\n|109370\n|Profile Subsystem\n|-\n|Amiccom Bluetooth Mesh Model\n|AMICCOM Electronics Corporation\n|\n|110168\n|Profile Subsystem\n|-\n|Airoha SIG mesh\n|Airoha Technology Corp.\n|\n|110202\n|Profile Subsystem\n|-\n|Marvell Mesh stack v1.0\n|Marvell Technology Group\n|\n|110569\n|Component (Tested)\n|-\n|nRF5 SDK for Mesh\n|Nordic Semiconductor\n|May 2, 2018\n|111537\n|Profile Subsystem\n|-\n|Realtek Bluetooth 5 Mesh Solution\n|Realsil Microelectronics Inc\n|\n|115668\n|Profile Subsystem\n|-\n|STSW-BNRG-Mesh\n|STMicroelectronics\n|\n|116029\n|Profile Subsystem\n|-\n|RDA BT Host 5.0\n|RDA Microelectronics, Inc.\n|\n|115860\n|Profile Subsystem\n|-\n|JYMC-MESH-1\n|Shanghai Frequen Microelectronics Co., Ltd.\n|\n|119229\n|End Product\n|-\n|RW-BLE-MESH\n|CEVA, Inc.\n|\n|119268\n|Component (Tested)\n|-\n|ARM Ltd Cordio Mesh\n|ARM Ltd\n|\n|116593\n|Profile Subsystem\n|-\n|Samsung SLSI Bluetooth Mesh\n|Samsung Electronics Co., Ltd.\n|\n|122442\n|Profile Subsystem\n|-\n|Bluelet Host Stack V12\n|Barrot Technology Limited\n|\n|123056\n|Component (Tested)\n|-\n|ESP BLE Mesh v0.6\n|Espressif Systems (Shanghai) Pte. Ltd.\n|\n|124137\n|Profile Subsystem\n|-\n|BK3435 BLE Core Spec 5.0 with MESH\n|Beken Corp\n|\n|127926\n|End Product\n|-\n|Actions Mesh Profile Subsystem\n|Actions (Zhuhai) Technology Co., Limited\n|\n|127646\n|Profile Subsystem\n|-\n|AliOS Things BLE host and mesh profile v2.1.0\n|Alibaba (China) Co., Ltd.\n|\n|129750\n|Host Subsystem\n|-\n|Tonly SIG Mesh Stack\n|Shenzhen Tonli Science and Technology Development Co., Ltd\n|\n|130160\n|Profile Subsystem\n|-\n|Sino Wealth IBLE SIG Mesh Profile\n|Sino Wealth Electronic Ltd.\n|\n|133403\n|Profile Subsystem\n|-\n|Qualcomm Bluetooth Mesh and Mesh Model v4.0\n|Qualcomm Technologies International, Ltd.\n|\n|128410\n|Profile Subsystem\n|-\n|PAN1020 Mesh Profile subsystem\n|Shanghai Panchip Microelectronics Co., Ltd\n|\n|129291\n|Profile Subsystem\n|-\n|Apache NimBLE BLE Host including BLE Mesh\n|JUUL Labs, Inc.\n|\n|131934\n|Component (Tested)\n|-\n|Tmall mesh Stack\n|Alibaba (China) Co., Ltd.\n|\n|128246\n|Profile Subsystem\n|-\n|ClarinoxBlue\n|Clarinox Technologies Pty Ltd\n|\n|134454\n|Host Subsystem\n|-\n|BlueX Mesh\n|BlueX Microelectronics Corp Ltd.\n|\n|137436\n|Profile Subsystem\n|-\n|Zephyr OS Mesh\n|The Linux Foundation\n|\n|139259\n|Profile Subsystem\n|-\n|WCH Bluetooth Mesh\n|Nanjing Qinheng Microelectronics Co., Ltd.\n|\n|144808\n|Profile Subsystem\n|}\nFree and open-source software implementations\nFree software and open source software implementations include the following:\n* The official (included in Linux kernel by Linus Torvalds in 2001) Linux Bluetooth protocol stack BlueZ, dual free-licensed under the GPL and the LGPL, supports Mesh Profile, from release version 5.47, by providing meshctl tool (deprecated) to configure mesh devices. Release version 5.53 introduced mesh-cfgclient tool for configuring mesh networks. BlueZ was approved as a \"qualified\" software package by Bluetooth SIG in 2005. BlueZ is not considered to be a qualified Bluetooth Mesh stack as Bluetooth Mesh is not listed in aforementioned qualification record as a supported profile.\n* Apache Mynewt NimBLE, free-licensed under the Apache License 2.0, supports Bluetooth Mesh from release version 1.2.0. It was qualified on  with QDID 131934.\n* Zephyr OS Mesh, free-licensed under the Apache License 2.0, supports Bluetooth Mesh from release version 1.9.0. Zephyr OS Mesh 1.14.x was qualified on  with QDID 139259.\n}}"
    }
  ]
}