{
  "content": [
    {
      "type": "text",
      "text": "# Conditional independence\n\nIn probability theory, conditional independence describes situations in which an observation is irrelevant or redundant when evaluating the certainty of a hypothesis. It is the opposite of conditional dependence. Conditional independence is usually formulated in terms of conditional probability, as a special case where the probability of the hypothesis given the uninformative observation is equal to the probability without. If A is the hypothesis, and B and C are observations, conditional independence can be stated as an equality:\n:P(A\\mid B,C) = P(A \\mid C)\nwhere P(A \\mid B, C) is the probability of A given both B and C. Since the probability of A given C is the same as the probability of A given both B and C, this equality expresses that B contributes nothing to the certainty of A. In this case, A and B are said to be conditionally independent given C, written symbolically as: (A \\perp\\!\\!\\!\\perp B \\mid  C).\nThe concept of conditional independence is essential to graph-based theories of statistical inference, as it establishes a mathematical relation between a collection of conditional statements and a graphoid.\nConditional independence of events\nLet A, B, and C be events. A and B are said to be conditionally independent given C if and only if P(C) > 0 andP(A \\mid B, C) = P(A \\mid C). This property is symmetric (more on this below) and often written as (A \\perp\\!\\!\\!\\perp B \\mid C), which should be read as((A \\perp\\!\\!\\!\\perp B) \\vert C).\nEquivalently, conditional independence may be stated as P(A,B|C) = P(A|C)P(B|C) where P(A,B|C) is the joint probability of A and B given C. This alternate formulation states that A and B are independent events, given C.\nIt demonstrates that (A \\perp\\!\\!\\!\\perp B \\mid C) is equivalent to (B \\perp\\!\\!\\!\\perp A \\mid C).\nProof of the equivalent definition\n:\\begin{align}\nP(A, B \\mid C) = P(A \\mid C) P(B \\mid C)\n& \\iff \\frac{P(A, B, C)}{P(C)} = \\left(\\frac{P(A, C)}{P(C)}\\right) \\left(\\frac{P(B, C)}{P(C)} \\right) & \\text{definition of conditional probability} \\\\\n& \\iff P(A, B, C) = \\frac{P(A, C) P(B, C)}{P(C)} & \\text{multiply both sides by P(C)} \\\\\n& \\iff \\frac{P(A, B, C)}{P(B, C)}= \\frac{P(A, C)}{P(C)} & \\text{divide both sides by P(B, C)} \\\\\n& \\iff P(A \\mid B, C) = P(A \\mid C) &\\text{definition of conditional probability}\n\\end{align}\nExamples\nColoured boxes\nEach cell represents a possible outcome. The events \\color{red}R, \\color{blue}B and \\color{gold}Y are represented by the areas shaded ,  and  respectively. The overlap between the events \\color{red}R and \\color{blue}B is shaded   .\nThese are two examples illustrating conditional independence.\nThe probabilities of these events are shaded areas with respect to the total area. In both examples \\color{red}R and \\color{blue}B are conditionally independent given \\color{gold}Y because:\n:\\Pr({\\color{red}R}, {\\color{blue}B} \\mid {\\color{gold}Y}) =  \\Pr({\\color{red}R} \\mid {\\color{gold}Y})\\Pr({\\color{blue}B} \\mid {\\color{gold}Y})\nbut not conditionally independent given \\left[ \\text{not }{\\color{gold}Y}\\right] because:\n:\\Pr({\\color{red}R}, {\\color{blue}B} \\mid \\text{not } {\\color{gold}Y}) \\not= \\Pr({\\color{red}R} \\mid \\text{not } {\\color{gold}Y})\\Pr({\\color{blue}B} \\mid \\text{not } {\\color{gold}Y})\nProximity and delays\nLet events A and B be defined as the probability that person A and person B will be home in time for dinner where both people are randomly sampled from the entire world. Events A and B can be assumed to be independent i.e. knowledge that A is late has minimal to no change on the probability that B will be late. However, if a third event is introduced, person A and person B live in the same neighborhood, the two events are now considered not conditionally independent. Traffic conditions and weather-related events that might delay person A, might delay person B as well. Given the third event and knowledge that person A was late, the probability that person B will be late does meaningfully change.\nDice rolling\nConditional independence depends on the nature of the third event. If you roll two dice, one may assume that the two dice behave independently of each other. Looking at the results of one die will not tell you about the result of the second die. (That is, the two dice are independent.) If, however, the 1st die's result is a 3, and someone tells you about a third event - that the sum of the two results is even - then this extra unit of information restricts the options for the 2nd result to an odd number. In other words, two events can be independent, but NOT conditionally independent.\nHeight and vocabulary\nHeight and vocabulary are dependent since very small people tend to be children, known for their more basic vocabularies. But knowing that two people are 19 years old (i.e., conditional on age) there is no reason to think that one person's vocabulary is larger if we are told that they are taller.\nConditional independence of random variables\nTwo discrete random variables X and Y are conditionally independent given a third discrete random variable Z if and only if they are independent in their conditional probability distribution given Z. That is, X and Y are conditionally independent given Z if and only if, given any value of Z, the probability distribution of X is the same for all values of Y and the probability distribution of Y is the same for all values of X. Formally:\n{{Equation box 1\n|indent =\n|title=\n|equation = {{NumBlk||(X \\perp\\!\\!\\!\\perp Y) \\mid Z \\quad \\iff \\quad F_{X,Y\\,\\mid\\,Z\\,=\\,z}(x,y) = F_{X\\,\\mid\\,Z\\,=\\,z}(x) \\cdot F_{Y\\,\\mid\\,Z\\,=\\,z}(y) \\quad \\text{for all } x,y,z|}}\n|cellpadding= 6\n|border\n|border colour = #0073CF\n|background colour=#F5FFFA}}\nwhere F_{X,Y\\,\\mid\\,Z\\,=\\,z}(x,y)=\\Pr(X \\leq x, Y \\leq y \\mid Z=z) is the conditional cumulative distribution function of X and Y given Z.\nTwo events R and B are conditionally independent given a &sigma;-algebra \\Sigma if\n:\\Pr(R, B \\mid \\Sigma) = \\Pr(R \\mid \\Sigma)\\Pr(B \\mid \\Sigma) \\text{ a.s.}\nwhere \\Pr(A \\mid \\Sigma)  denotes the conditional expectation of the indicator function of the event A, \\chi_A, given the sigma algebra \\Sigma. That is,\n:\\Pr(A \\mid \\Sigma) := \\operatorname{E}[\\chi_A\\mid\\Sigma].\nTwo random variables X and Y are conditionally independent given a σ-algebra \\Sigma if the above equation holds for all R in \\sigma(X) and B in \\sigma(Y).\nTwo random variables X and Y are conditionally independent given a random variable W if they are independent given σ(W): the σ-algebra generated by W. This is commonly written:\n:X \\perp\\!\\!\\!\\perp Y \\mid W  or\n:X \\perp Y \\mid W\nThis is read \"X is independent of Y, given W\"; the conditioning applies to the whole statement: \"(X is independent of Y) given W\".\n:(X \\perp\\!\\!\\!\\perp Y) \\mid W\nThis notation extends X \\perp\\!\\!\\!\\perp Y for \"X is independent of Y.\"\nIf W assumes a countable set of values, this is equivalent to the conditional independence of X and Y for the events of the form [W=w].\nConditional independence of more than two events, or of more than two random variables, is defined analogously.\nThe following two examples show that X \\perp\\!\\!\\!\\perp Y neither implies nor is implied by (X \\perp\\!\\!\\!\\perp Y) \\mid W.\nFirst, suppose W is 0 with probability 0.5 and 1 otherwise.  When W&nbsp;=&nbsp;0 take X and Y to be independent, each having the value 0 with probability 0.99 and the value 1 otherwise.  When W=1, X and Y are again independent, but this time they take the value 1 with probability 0.99.  Then (X \\perp\\!\\!\\!\\perp Y) \\mid W. But X and Y are dependent, because Pr(X&nbsp;=&nbsp;0) &nbsp;0.5.\nFor the second example, suppose X \\perp\\!\\!\\!\\perp Y, each taking the values 0 and 1 with probability&nbsp;0.5. Let W be the product X \\cdot Y.  Then when W=0, Pr(X&nbsp;=&nbsp;0)&nbsp;=&nbsp;2/3, but Pr(X&nbsp;=&nbsp;0|Y&nbsp;=&nbsp;0)&nbsp;=&nbsp;1/2, so (X \\perp\\!\\!\\!\\perp Y) \\mid W is false.\nThis is also an example of Explaining Away. See Kevin Murphy's tutorial  where X and Y take the values \"brainy\" and \"sporty\".\nConditional independence of random vectors\nTwo random vectors \\mathbf{X}=(X_1,\\ldots,X_l)^{\\mathrm T} and \\mathbf{Y}=(Y_1,\\ldots,Y_m)^{\\mathrm T} are conditionally independent given a third random vector \\mathbf{Z}=(Z_1,\\ldots,Z_n)^{\\mathrm T} if and only if they are independent in their conditional cumulative distribution given \\mathbf{Z}. Formally:\n{{Equation box 1\n|indent =\n|title=\n|equation = {{NumBlk||(\\mathbf{X} \\perp\\!\\!\\!\\perp \\mathbf{Y}) \\mid \\mathbf{Z} \\quad \\iff \\quad F_{\\mathbf{X},\\mathbf{Y}|\\mathbf{Z}=\\mathbf{z}}(\\mathbf{x},\\mathbf{y}) = F_{\\mathbf{X}\\,\\mid\\,\\mathbf{Z}\\,=\\,\\mathbf{z}}(\\mathbf{x}) \\cdot F_{\\mathbf{Y}\\,\\mid\\,\\mathbf{Z}\\,=\\,\\mathbf{z}}(\\mathbf{y}) \\quad \\text{for all } \\mathbf{x},\\mathbf{y},\\mathbf{z}|}}\n|cellpadding= 6\n|border\n|border colour = #0073CF\n|background colour=#F5FFFA}}\nwhere \\mathbf{x}=(x_1,\\ldots,x_l)^{\\mathrm T}, \\mathbf{y}=(y_1,\\ldots,y_m)^{\\mathrm T} and \\mathbf{z}=(z_1,\\ldots,z_n)^{\\mathrm T} and the conditional cumulative distributions are defined as follows.\n: \\begin{align}\nF_{\\mathbf{X},\\mathbf{Y}\\,\\mid\\,\\mathbf{Z}\\,=\\,\\mathbf{z}}(\\mathbf{x},\\mathbf{y}) &= \\Pr(X_1 \\leq x_1,\\ldots,X_l \\leq x_l, Y_1 \\leq y_1,\\ldots,Y_m \\leq y_m \\mid Z_1=z_1,\\ldots,Z_n=z_n) \\\\[6pt]\nF_{\\mathbf{X}\\,\\mid\\,\\mathbf{Z}\\,=\\,\\mathbf{z}}(\\mathbf{x}) &= \\Pr(X_1 \\leq x_1,\\ldots,X_l \\leq x_l \\mid Z_1=z_1,\\ldots,Z_n=z_n) \\\\[6pt]\nF_{\\mathbf{Y}\\,\\mid\\,\\mathbf{Z}\\,=\\,\\mathbf{z}}(\\mathbf{y}) &= \\Pr(Y_1 \\leq y_1,\\ldots,Y_m \\leq y_m \\mid Z_1=z_1,\\ldots,Z_n=z_n)\n\\end{align}\nUses in Bayesian inference\nLet p be the proportion of voters who will vote \"yes\" in an upcoming referendum. In taking an opinion poll, one chooses n voters randomly from the population. For i&nbsp;=&nbsp;1,&nbsp;...,&nbsp;n, let Xi&nbsp;=&nbsp;1 or 0 corresponding, respectively, to whether or not the ith chosen voter will or will not vote \"yes\".\nIn a frequentist approach to statistical inference one would not attribute any probability distribution to p (unless the probabilities could be somehow interpreted as relative frequencies of occurrence of some event or as proportions of some population) and one would say that X1, ..., Xn are independent random variables.\nBy contrast, in a Bayesian approach to statistical inference, one would assign a probability distribution to p regardless of the non-existence of any such \"frequency\" interpretation, and one would construe the probabilities as degrees of belief that p is in any interval to which a probability is assigned. In that model, the random variables X1,&nbsp;...,&nbsp;Xn are not independent, but they are conditionally independent given the value of p. In particular, if a large number of the Xs are observed to be equal to 1, that would imply a high conditional probability, given that observation, that p is near 1, and thus a high conditional probability, given that observation, that the next X to be observed will be equal to 1.\nRules of conditional independence\nA set of rules governing statements of conditional independence have been derived from the basic definition.\nThese rules were termed \"Graphoid Axioms\"\nby Pearl and Paz, because they hold in graphs, where X \\perp\\!\\!\\!\\perp A\\mid B is interpreted to mean: \"All paths from X to A are intercepted by the set B\".\nSymmetry\n:\nX \\perp\\!\\!\\!\\perp Y \\mid Z \\quad\n\\Leftrightarrow\n\\quad\nY \\perp\\!\\!\\!\\perp X \\mid Z\nProof:\nFrom the definition of conditional independence,\n:\nX \\perp\\!\\!\\!\\perp Y \\mid Z \\quad\n\\Leftrightarrow\n\\quad P(X, Y \\mid Z) = P(X \\mid Z) P(Y \\mid Z) \\quad\n\\Leftrightarrow\n\\quad\nY \\perp\\!\\!\\!\\perp X \\mid Z\nDecomposition\n:\nX \\perp\\!\\!\\!\\perp Y \\mid Z\n\\quad \\Rightarrow \\quad\nh(X) \\perp\\!\\!\\!\\perp Y \\mid Z\nProof\nFrom the definition of conditional independence, we seek to show that:\n:\nX \\perp\\!\\!\\!\\perp Y \\mid Z\n\\quad \\Rightarrow \\quad\nP(h(X), Y \\mid Z) = P(h(X) \\mid Z) P(Y \\mid Z)\n. The left side of this equality is:\n:\nP(h(X)=a, Y=y \\mid Z=z) = \\sum_{X \\colon h(X)=a} P(X=x, Y=y \\mid Z=z)\n, where the expression on the right side of this equality is the summation over X such that h(X)=a of the conditional probability of X, Y on Z.\nFurther decomposing,\n:\n\\begin{align}\n\\sum_{X \\colon h(X)=a} P(X=x, Y=y \\mid Z=z) =& \\sum_{X \\colon h(X)=a} P(X=x \\mid Z=z) P(Y=y \\mid Z=z) \\\\\n=& P(Y=y \\mid Z=z) \\sum_{X \\colon h(X)=a} P(X=x \\mid Z=z) \\\\\n=& P(Y \\mid Z) P (h(X) \\mid Z)\n\\end{align}\n. Special cases of this property include\n*\n(X, W) \\perp\\!\\!\\!\\perp Y \\mid Z\n\\quad \\Rightarrow \\quad\nX \\perp\\!\\!\\!\\perp Y \\mid Z\n** Proof: Let us define  A = (X,W)  and  h(\\cdot)  be an 'extraction' function  h(X,W) = X. Then:\n: \\begin{align}\n(X,W) \\perp\\!\\!\\!\\perp Y \\mid Z\n\\quad &\\Leftrightarrow \\quad\nA \\perp\\!\\!\\!\\perp Y \\mid Z \\\\\n&\\Rightarrow \\quad\nh(A) \\perp\\!\\!\\!\\perp Y \\mid Z \\quad &\\text{Decomposition} \\\\\n&\\Leftrightarrow \\quad\nX \\perp\\!\\!\\!\\perp Y \\mid Z\n\\end{align}\n*\nX \\perp\\!\\!\\!\\perp (Y, W) \\mid Z\n\\quad \\Rightarrow \\quad\nX \\perp\\!\\!\\!\\perp Y \\mid Z\n** Proof: Let us define  V = (Y,W)  and  h(\\cdot)  be again an 'extraction' function  h(Y,W) = Y. Then:\n:\n\\begin{align}\nX \\perp\\!\\!\\!\\perp (Y,W) \\mid Z\n\\quad &\\Leftrightarrow \\quad\nX \\perp\\!\\!\\!\\perp V \\mid Z \\\\\n&\\Leftrightarrow \\quad\nV \\perp\\!\\!\\!\\perp X \\mid Z \\quad &\\text{Symmetry} \\\\\n&\\Rightarrow \\quad\nh(V) \\perp\\!\\!\\!\\perp X \\mid Z \\quad &\\text{Decomposition} \\\\\n&\\Leftrightarrow \\quad\nY \\perp\\!\\!\\!\\perp X \\mid Z \\\\\n&\\Leftrightarrow \\quad\nX \\perp\\!\\!\\!\\perp Y \\mid Z \\quad &\\text{Symmetry}\n\\end{align}\nWeak union\n:\nX \\perp\\!\\!\\!\\perp Y \\mid Z\n\\quad \\Rightarrow \\quad\nX \\perp\\!\\!\\!\\perp Y \\mid (Z, h(X))\nProof:\nGiven  X \\perp\\!\\!\\!\\perp Y \\mid Z , we aim to show\n:\n\\begin{align}\nX \\perp\\!\\!\\!\\perp Y \\mid (Z, h(X))\n\\quad &\\Leftrightarrow \\quad\nX \\perp\\!\\!\\!\\perp Y \\mid U \\quad &\\text{where} \\quad U = (Z, h(X)) \\\\\n&\\Leftrightarrow \\quad\nY \\perp\\!\\!\\!\\perp X \\mid U \\quad &\\text{Symmetry} \\\\\n&\\Leftrightarrow \\quad\nP(Y\\mid X, U) = P(Y\\mid U) \\\\\n&\\Leftrightarrow \\quad\nP(Y \\mid X, Z, h(X)) = P(Y \\mid Z, h(X))\n\\end{align}\n. We begin with the left side of the equation\n:\n\\begin{align}\nP(Y \\mid X, Z, h(X)) &= P(Y \\mid X, Z) \\\\\n&= P(Y \\mid Z) &\\text{Since by symmetry } Y \\perp\\!\\!\\!\\perp X \\mid Z\n\\end{align}\n. From the given condition\n:\n\\begin{align}\nX \\perp\\!\\!\\!\\perp Y \\mid Z\n\\quad &\\Rightarrow \\quad\nh(X) \\perp\\!\\!\\!\\perp Y \\mid Z\n\\quad &\\text{Decomposition} \\\\\n&\\Leftrightarrow \\quad\nY \\perp\\!\\!\\!\\perp h(X) \\mid Z\n\\quad &\\text{Symmetry} \\\\\n&\\Rightarrow \\quad\nP(Y \\mid Z, h(X)) = P(Y \\mid Z)\n\\end{align}\n. Thus  P(Y \\mid X, Z, h(X)) = P(Y \\mid Z, h(X))\n, so we have shown that\nX \\perp\\!\\!\\!\\perp Y \\mid (Z, h(X))\n.\nSpecial Cases:\nSome textbooks present the property as\n*  X \\perp\\!\\!\\!\\perp (Y, W) \\mid Z\n\\quad \\Rightarrow \\quad\nX \\perp\\!\\!\\!\\perp Y \\mid (Z, W) .\n*  (X,W)  \\perp\\!\\!\\!\\perp Y \\mid Z\n\\quad \\Rightarrow \\quad\nX \\perp\\!\\!\\!\\perp Y \\mid (Z,W) .\nBoth versions can be shown to follow from the weak union property given initially via the same method as in the decomposition section above.\nContraction\n:\n\\left.\\begin{align}\nX \\perp\\!\\!\\!\\perp A \\mid B \\\\\nX \\perp\\!\\!\\!\\perp B\n\\end{align}\\right\\}\\text{ and }\n\\quad \\Rightarrow \\quad\nX \\perp\\!\\!\\!\\perp A,B\nProof\nThis property can be proved by noticing \\Pr(X\\mid A,B) = \\Pr(X\\mid B) = \\Pr(X), each equality of which is asserted by X \\perp\\!\\!\\!\\perp A \\mid B and X \\perp\\!\\!\\!\\perp B, respectively.\nIntersection\nFor strictly positive probability distributions, the following also holds:\n:\n\\left.\\begin{align}\nX \\perp\\!\\!\\!\\perp Y \\mid Z, W\\\\\nX \\perp\\!\\!\\!\\perp W \\mid Z, Y\n\\end{align}\\right\\}\\text{ and }\n\\quad \\Rightarrow \\quad\nX \\perp\\!\\!\\!\\perp W, Y \\mid Z\nProof\nBy assumption:\n: P(X|Z, W, Y) = P(X|Z, W) \\land P(X|Z, W, Y) = P(X|Z, Y) \\implies P(X|Z, Y) = P(X|Z, W)\nUsing this equality, together with the Law of total probability applied to P(X|Z):\n: \\begin{align}\nP(X|Z) &= \\sum_{w \\in W} P(X|Z, W=w)P(W=w|Z) \\\\[4pt]\n&= \\sum_{w \\in W} P(X|Y, Z)P(W=w|Z) \\\\[4pt]\n&= P(X|Z, Y) \\sum_{w \\in W} P(W=w|Z) \\\\[4pt]\n&= P(X|Z, Y)\n\\end{align}\nSince P(X|Z, W, Y) = P(X|Z, Y) and P(X|Z, Y) = P(X|Z), it follows that P(X|Z, W, Y) = P(X|Z) \\iff X \\perp\\!\\!\\!\\perp Y,W | Z.\nTechnical note: since these implications hold for any probability space, they will still hold if one considers a sub-universe by conditioning everything on another variable, say&nbsp;K. For example, X \\perp\\!\\!\\!\\perp Y \\Rightarrow Y \\perp\\!\\!\\!\\perp X would also mean that X \\perp\\!\\!\\!\\perp Y \\mid K  \\Rightarrow Y \\perp\\!\\!\\!\\perp X \\mid K.\nSee also\n*Graphoid\n*Conditional dependence\n*de Finetti's theorem\n*Conditional expectation\nReferences\nExternal links\n*"
    }
  ]
}