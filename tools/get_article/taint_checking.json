{
  "content": [
    {
      "type": "text",
      "text": "# Taint checking\n\nTaint checking is a feature in some computer programming languages, such as Perl, Ruby or Ballerina designed to increase security by preventing malicious users from executing commands on a host computer.  Taint checks highlight specific security risks primarily associated with web sites which are attacked using techniques such as SQL injection or buffer overflow attack approaches.\nOverview\nThe concept behind taint checking is that any variable that can be modified by an outside user (for example a variable set by a field in a web form) poses a potential security risk.  If that variable is used in an expression that sets a second variable, that second variable is now also suspicious.  The taint checking tool can then proceed variable by variable forming a list of variables which are potentially influenced by outside input. If any of these variables is used to execute dangerous commands (such as direct commands to a SQL database or the host computer operating system), the taint checker warns that the program is using a potentially dangerous tainted variable.  The computer programmer can then redesign the program to erect a safe wall around the dangerous input.\nTaint checking may be viewed as a conservative approximation of the full verification of non-interference or the more general concept of secure information flow. Because information flow in a system cannot be verified by examining a single execution trace of that system, the results of taint analysis will necessarily reflect approximate information regarding the information flow characteristics of the system to which it is applied.\nExample\nThe following dangerous Perl code opens a large SQL injection vulnerability by not checking the value of the $name variable:\n#!/usr/bin/env perl\nmy $name = $cgi->param(\"name\");  # Get the name from the browser\n...\n$dbh->{TaintIn} = 1;\n$dbh->execute(\"SELECT * FROM users WHERE name = '$name';\"); # Execute an SQL query\nIf taint checking is turned on, Perl would refuse to run the command and exit with an error message, because a tainted variable is being used in a SQL query. Without taint checking, a user could enter foo'; DROP TABLE users --, thereby running a command that deletes the entire database table. Much safer would be to encode the tainted value of $name to a SQL string literal and use the result in the SQL query, guaranteeing that no dangerous command embedded in $name will be evaluated. Another way to achieve that is to use a prepared statement to sanitize all variable input for a query.\nOne thing to note is that Perl DBI requires one to set the TaintIn attribute of a database handle as well as enabling taint mode to check one's SQL strings.\nHistory\nPerl supported tainting in setuid scripts from at least version 3.0 (released in 1989), though it was not until version 5.0 (released in 1994) that the -T switch was introduced integrating tainting into a single runtime.\nIn 1996, Netscape implemented data tainting for JavaScript in Netscape Navigator 3. However, since support was considered experimental, it shipped disabled (requiring user intervention to activate) and required page authors to modify scripts to benefit from it. Other browser vendors never implemented the functionality.\nReferences\nExternal links\n*[http://www.w3.org/Security/Faq/wwwsf4.html#CGI-Q15 Guidelines from the W3C about taint-checking CGI scripts]\n*[http://perldoc.perl.org/perlsec.html perlsec] - Perl security documentation"
    }
  ]
}