{
  "content": [
    {
      "type": "text",
      "text": "# Mosh (software)\n\n|latest_release_version = 1.4.0\n|latest_release_date =\n|operating_system = Unix-like systems\n|genre = Utility software\n|license = GNU GPLv3 with OpenSSL and iOS exceptions\n|website =\n}}\nIn computing, Mosh (mobile shell) is a tool used to connect from a client computer to a server over the Internet, to run a remote terminal. Mosh is similar to SSH, with additional features meant to improve usability for mobile users. The major features are:\n* Mosh maintains its session even when it \"roams\" (when the client endpoint changes to different IP addresses), for example by moving to a different Wi-Fi network or when changing from Wi-Fi to 3G.\n* Mosh maintains the terminal session (not \"connection\" in the TCP-sense because Mosh uses UDP) even when a user loses their Internet connection or puts their client to \"sleep\". In comparison, SSH can lose its connection in such cases because TCP times out.\n* A Mosh client attempts to be responsive to keyboard events (typing, erasing characters with the  key, and so on) without waiting for network lag. It uses an adaptive system that predicts whether the application running on the server will decide to echo the user's keystrokes or deletions.\nThe main drawbacks of Mosh are additional prerequisites to the server, that it lacks some special features of SSH (such as connection forwarding) and the lack of a native Windows client. An alternative for Linux servers (that still require installation on the server) is to use GNU Screen on top of a regular SSH connection.\nDesign\nMosh works at a different layer from SSH. Whereas SSH transmits a stream of bytes in each direction (from server to client or client to server) using TCP, Mosh runs a terminal emulator at the server to figure out what should be on the screen. The server then transmits this screen to the client at a varying frame rate, depending on the speed of the network. This allows Mosh to save on network traffic on slow or intermittent connections.\nSupported platforms\nMosh is available for most Linux distributions, macOS, FreeBSD, NetBSD, and OpenBSD, Android, Solaris, Cygwin, and as a Chrome App. The iOS program Termius includes an independent implementation of the Mosh protocol.\nPerformance\nRoaming\nMosh is built on the State-Synchronization Protocol (SSP), which supports single-packet roaming. After the client has switched to a new IP address, a single packet that successfully reaches the server is enough to \"roam\" the connection. The client does not need to know it has roamed. (The client may be on a network with network address translation (NAT) when the NAT router roams.)\nPacket loss\nIn the Mosh research paper, the creators tested SSP on a link with 29% packet loss, and found that SSP reduced the average response time by a factor of 50 (from 16.8 seconds to 0.33 seconds) compared with SSH, which uses TCP. A different study, by students at Stanford University, found that SSP reduced the average response time by a factor of 30 (from 5.9 seconds to 0.19 seconds).\nLocal echo\nAccording to Mosh's developers, the program was found to be able to predict and immediately display 70% of user keystrokes, reducing the median response time to a keystroke to less than 5 milliseconds (masking the latency of the network). A different study, by students at Stanford University, found that Mosh was able to quickly echo 55% of user keystrokes.\nDrawbacks\nCompared to the more popular SSH, Mosh has the following drawbacks:\nPrerequisites on the server\nThe major drawback of Mosh is that it requires the server to fulfill additional prerequisites which are not needed by ssh itself. Due to its design, Mosh needs the server to allow direct connections via UDP. Servers not fulfilling these prerequisites cannot be used by Mosh. Examples of such systems include servers behind firewalls which restrict connections to the ssh-port via TCP. Also problematic are servers which are only indirectly reachable. The latter is usually accommodated by ssh via the 'ProxyCommand' option, but this is not supported by Mosh.\nOne port per connection\nBy default, the server tries to allocate the first free UDP port in the range 60001â€“61000, per connection. This dynamic port allocation is considered an extra burden and risk for firewall maintenance. A significant part of the firewall-filtering happens through connection tracking, so called stateful filtering, this is based on the SYN/ACK flags in TCP segments, UDP packets don't have such flags.\nMitigation:\n# The UDP port on the server can be set per Mosh connection, so that only a limited number of ports need to be opened\n# Deep packet inspection firewalls and application firewalls can handle this better by looking at content of the packet and associate it to the initial connection\nOutput drops and lack of terminal scrollback\nScrollback is not supported in the current release of Mosh, and when using it in a terminal emulator with scrollbars they disappear, but is planned for the 1.3 release. This functionality is a trade-off for garbage cleaning, as binary output is wiped away. One way to mitigate this is by using Mosh in combination with a terminal multiplexer like screen or tmux.\nLack of ssh-agent forwarding\nssh-agent forwarding is not currently supported.\nLack of X11 forwarding\nX11 forwarding is not yet supported.\nSee also\n* Block-oriented terminal\n* Command-line interface\nReferences"
    }
  ]
}