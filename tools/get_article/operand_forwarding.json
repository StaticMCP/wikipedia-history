{
  "content": [
    {
      "type": "text",
      "text": "# Operand forwarding\n\nOperand forwarding (or data forwarding) is an optimization in pipelined CPUs to limit performance deficits which occur due to pipeline stalls caused by data hazards. A data hazard can lead to a pipeline stall when the current operation has to wait for the results of an earlier operation which has not yet finished.\nIt is very common that an instruction requires a value computed by the immediately preceding instruction. It may take a few clock cycles to write a result to the register file and then read it back for the subsequent instruction. To improve performance, the register file write/read is bypassed. The result of an instruction is forwarded directly to the execute stage of a subsequent instruction.\nExample\nADD A B C  #A=B+C\nSUB D C A  #D=C-A\nIf these two assembly pseudocode instructions run in a pipeline, after fetching and decoding the second instruction, the pipeline stalls, waiting until the result of the addition is written and read.\n{| class=\"wikitable\" align=center style=\"margin:0.46em 0.2em\"\n|+ Without operand forwarding\n! 1 || 2 || 3 || 4 || style=\"width: 10em;\" | 5 || style=\"width: 10em;\" | 6 || 7 || 8\n|-\n| Fetch ADD || Decode ADD || Read Operands ADD || Execute ADD || Write result || || ||\n|-\n|  || Fetch SUB || Decode SUB || stall || stall || Read Operands SUB || Execute SUB || Write result\n|}\n{| class=\"wikitable\" align=center style=\"margin:0.46em 0.2em\"\n|+ With operand forwarding\n! 1 || 2 || 3 || 4 || style=\"width: 10em;\" | 5 || style=\"width: 10em;\" | 6 || 7\n|-\n| Fetch ADD || Decode ADD || Read Operands ADD || Execute ADD || Write result || ||\n|-\n|  || Fetch SUB || Decode SUB || stall || Read Operands SUB: use result from previous operation || Execute SUB || Write result\n|}\nIn some cases all stalls from such read-after-write data hazards can be completely eliminated by operand forwarding:\n{| class=\"wikitable\" align=center style=\"margin:0.46em 0.2em\"\n|+ With operand forwarding (enhanced)\n! 1 || 2 || 3 || 4 || style=\"width: 10em;\" | 5 || style=\"width: 10em;\" | 6\n|-\n| Fetch ADD || Decode ADD || Read Operands ADD || Execute ADD || Write result ||\n|-\n|  || Fetch SUB || Decode SUB || Read Operands SUB: use result from previous operation || Execute SUB || Write result\n|}\nTechnical realization\nThe CPU control unit must implement logic to detect dependencies where operand forwarding makes sense. A multiplexer can then be used to select the proper register or flip-flop to read the operand from.\nSee also\n*Feed forward (control)\nReferences\nExternal links\n* [http://www.cs.uaf.edu/2010/fall/cs441/lecture/09_16_pipelining.html Introduction to Pipelining]"
    }
  ]
}