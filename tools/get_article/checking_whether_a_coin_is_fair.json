{
  "content": [
    {
      "type": "text",
      "text": "# Checking whether a coin is fair\n\nIn statistics, the question of checking whether a coin is fair is one whose importance lies, firstly, in providing a simple problem on which to illustrate basic ideas of statistical inference and, secondly, in providing a simple problem that can be used to compare various competing methods of statistical inference, including decision theory. The practical problem of checking whether a coin is fair might be considered as easily solved by performing a sufficiently large number of trials, but statistics and probability theory can provide guidance on two types of question; specifically those of how many trials to undertake and of the accuracy of an estimate of the probability of turning up heads, derived from a given sample of trials.\nA fair coin is an idealized randomizing device with two states (usually named \"heads\" and \"tails\") which are equally likely to occur. It is based on the coin flip used widely in sports and other situations where it is required to give two parties the same chance of winning. Either a specially designed chip or more usually a simple currency coin is used, although the latter might be slightly \"unfair\" due to an asymmetrical weight distribution, which might cause one state to occur more frequently than the other, giving one party an unfair advantage.  So it might be necessary to test experimentally whether the coin is in fact \"fair\" &ndash; that is, whether the probability of the coin's falling on either side when it is tossed is exactly 50%. It is of course impossible to rule out arbitrarily small deviations from fairness such as might be expected to affect only one flip in a lifetime of flipping; also it is always possible for an unfair (or \"biased\") coin to happen to turn up exactly 10 heads in 20 flips.  Therefore, any fairness test must only establish a certain degree of confidence in a certain degree of fairness (a certain maximum bias). In more rigorous terminology, the problem is of determining the parameters of a Bernoulli process, given only a limited sample of Bernoulli trials.\nPreamble\nThis article describes experimental procedures for determining whether a coin is fair or unfair. There are many statistical methods for analyzing such an experimental procedure. This article illustrates two of them.\nBoth methods prescribe an experiment (or trial) in which the coin is tossed many times and the result of each toss is recorded. The results can then be analysed statistically to decide whether the coin is \"fair\" or \"probably not fair\".\n* Posterior probability density function, or PDF (Bayesian approach). Initially, the true probability of obtaining a particular side when a coin is tossed is unknown, but the uncertainty is represented by the \"prior distribution\". The theory of Bayesian inference is used to derive the posterior distribution by combining the prior distribution and the likelihood function which represents the information obtained from the experiment. The probability that this particular coin is a \"fair coin\" can then be obtained by integrating the PDF of the posterior distribution over the relevant interval that represents all the probabilities that can be counted as \"fair\" in a practical sense.\n* Estimator of true probability (Frequentist approach). This method assumes that the experimenter can decide to toss the coin any number of times. The experimenter first decides on the level of confidence required and the tolerable margin of error. These parameters determine the minimum number of tosses that must be performed to complete the experiment.\nAn important difference between these two approaches is that the first approach gives some weight to one's prior experience of tossing coins, while the second does not. The question of how much weight to give to prior experience, depending on the quality (credibility) of that experience, is discussed under credibility theory.\nPosterior probability density function\nOne method is to calculate the posterior probability density function of Bayesian probability theory.\nA test is performed by tossing the coin N times and noting the observed numbers of heads, h, and tails, t. The symbols H and T represent more generalised variables expressing the numbers of heads and tails respectively that might have been observed in the experiment. Thus N = H + T = h + t.\nNext, let r be the actual probability of obtaining heads in a single toss of the coin. This is the property of the coin which is being investigated. Using Bayes' theorem, the posterior probability density of r conditional on h and t is expressed as follows:\n: f(r \\mid H = h, T = t) =\n\\frac{\\Pr(H = h \\mid r, N = h + t) \\, g(r)}{\\int_0^1 \\Pr(H = h \\mid p, N = h + t) \\, g(p) \\, dp},\nwhere g(r) represents the prior probability density distribution of r, which lies in the range 0 to 1.\nThe prior probability density distribution summarizes what is known about the distribution of r in the absence of any observation. We will assume that the prior distribution of r is uniform over the interval [0,&nbsp;1]. That is, g(r) = 1. (In practice, it would be more appropriate to assume a prior distribution which is much more heavily weighted in the region around 0.5, to reflect our experience with real coins.)\nThe probability of obtaining h heads in N tosses of a coin with a probability of heads equal to r is given by the binomial distribution:\n: \\Pr(H = h \\mid r, N = h + t) = {N \\choose h} r^h (1 - r)^t.\nSubstituting this into the previous formula:\n:\nf(r \\mid H = h, T = t)\n= \\frac{{N \\choose h} r^h (1-r)^t}\n{\\int_0^1 {N \\choose h} p^h (1 - p)^t\\,dp}\n= \\frac{r^h (1 - r)^t}{\\int_0^1 p^h (1 - p)^t\\,dp}.\nThis is in fact a beta distribution (the conjugate prior for the binomial distribution), whose denominator can be expressed in terms of the beta function:\n:f(r \\mid H = h, T = t) = \\frac{1}{\\mathrm{B}(h + 1, t + 1)} r^h (1 - r)^t.\nAs a uniform prior distribution has been assumed, and because h and t are integers, this can also be written in terms of factorials:\n:f(r \\mid H = h, T = t) = \\frac{(h + t + 1)!}{h!\\,t!} r^h (1 - r)^t.\nExample\nFor example, let N = 10, h = 7, i.e. the coin is tossed 10 times and 7 heads are obtained:\n: f(r \\mid H = 7, T = 3) = \\frac{(10 + 1)!}{7!\\,3!} r^7 (1 - r)^3 = 1320 \\, r^7 (1 - r)^3.\nThe graph on the right shows the probability density function of r given that 7 heads were obtained in 10 tosses. (Note: r is the probability of obtaining heads when tossing the same coin once.)\nThe probability for an unbiased coin (defined for this purpose as one whose probability of coming down heads is somewhere between 45% and 55%)\n:\n\\Pr(0.45\nis small when compared with the alternative hypothesis (a biased coin). However, it is not small enough to cause us to  believe that the coin has a significant bias. This probability is slightly higher than our presupposition of the probability that the coin was fair corresponding to the uniform prior distribution, which was 10%.\nUsing a prior distribution that reflects our prior knowledge of what a coin is and how it acts, the posterior distribution would not favor the hypothesis of bias. However the number of trials in this example (10 tosses) is very small, and with more trials the choice of prior distribution would be somewhat less relevant.)\nWith the uniform prior, the posterior probability distribution f(r&nbsp;|&nbsp;H&nbsp;= 7,T&nbsp;=&nbsp;3) achieves its peak at r&nbsp;=&nbsp;h&nbsp;/&nbsp;(h&nbsp;+&nbsp;t)&nbsp;=&nbsp;0.7; this value is called the maximum a posteriori (MAP) estimate of r.  Also with the uniform prior, the expected value of r under the posterior distribution is\n:\\operatorname{E}[r] = \\int_0^1 r \\cdot f(r \\mid H=7, T=3) \\, \\mathrm{d}r = \\frac{h+1}{h+t+2} = \\frac{2}{3}.\nEstimator of true probability\n{| border=\"1\" cellpadding=\"5\" cellspacing=\"0\" align=\"center\"\n|-\n|The best estimator for the actual value  r\\,\\! is the estimator p\\,\\! = \\frac{h}{h+t}.\nThis estimator has a margin of error (E) where |p - r|  at a particular confidence level.\n|}\nUsing this approach, to decide the number of times the coin should be tossed, two parameters are required:\n# The confidence level which is denoted by confidence interval (Z)\n# The maximum (acceptable) error (E)\n*The confidence level is denoted by Z and is given by the Z-value of a standard normal distribution. This value can be read off a standard score statistics table for the normal distribution. Some examples are:\n{| class=\"wikitable\"\n|-\n! align=\"center\" | Z value\n! align=\"center\" | Confidence level\n! align=\"center\" | Comment\n|-\n| 0.6745\n| gives 50.000% level of confidence\n! align=\"center\" | Half\n|-\n| 1.0000\n| gives 68.269% level of confidence\n! align=\"center\"| One std dev\n|-\n| 1.6449\n| gives 90.000% level of confidence\n! align=\"center\"| \"One nine\"\n|-\n| 1.9599\n| gives 95.000% level of confidence\n! align=\"center\"| 95 percent\n|-\n| 2.0000\n| gives 95.450% level of confidence\n! align=\"center\"| Two std dev\n|-\n| 2.5759\n| gives 99.000% level of confidence\n! align=\"center\"| \"Two nines\"\n|-\n| 3.0000\n| gives 99.730% level of confidence\n! align=\"center\"| Three std dev\n|-\n| 3.2905\n| gives 99.900% level of confidence\n! align=\"center\"| \"Three nines\"\n|-\n| 3.8906\n| gives 99.990% level of confidence\n! align=\"center\"| \"Four nines\"\n|-\n| 4.0000\n| gives 99.993% level of confidence\n! align=\"center\"| Four std dev\n|-\n| 4.4172\n| gives 99.999% level of confidence\n! align=\"center\"| \"Five nines\"\n|}\n*The maximum error (E) is defined by |p - r|  where p\\,\\! is the estimated probability of obtaining heads. Note: r is the same actual probability (of obtaining heads) as  r\\,\\! of the previous section in this article.\n*In statistics, the estimate of a proportion of a sample (denoted by p) has a standard error given by:\n:s_p = \\sqrt{ \\frac {p \\, (1-p) } {n} }\nwhere n is the number of trials (which was denoted by N in the previous section).\nThis standard error s_p function of p has a maximum at p = (1-p) = 0.5. Further, in the case of a coin being tossed, it is likely that p will be not far from 0.5, so it is reasonable to take p=0.5 in the following:\n:{| border=\"0\" cellpadding=\"0\"\n|-\n|s_p\\,\\!\n|= \\sqrt{ \\frac {p \\, (1-p) } {n} } \\le \\sqrt{ \\frac {0.5 \\times 0.5 } {n} } = \\frac {1}{2 \\, \\sqrt{n}}\n|}\nAnd hence the value of maximum error (E) is given by\n:{| border=\"0\" cellpadding=\"0\"\n|-\n|E= Z \\, s_p =  \\frac {Z}{2 \\, \\sqrt{n}}\n|}\nSolving for the required number of coin tosses, n,\n:n =  \\frac {Z^2} {4 \\, E^2} \\!\nExamples\n{{ordered list\n| 1 = If a maximum error of 0.01 is desired, how many times should the coin be tossed?\n:n = \\frac {Z^2} {4 \\, E^2} = \\frac {Z^2} {4 \\times 0.01^2} = 2500 \\ Z^2\n:n = 2500\\,  at 68.27% level of confidence (Z=1)\n:n = 10000\\,  at 95.45% level of confidence (Z=2)\n:n = 27225\\,  at 99.90% level of confidence (Z=3.3)\n| 2 = If the coin is tossed 10000 times, what is the maximum error of the estimator p\\,\\! on the value of r\\,\\! (the actual probability of obtaining heads in a coin toss)?\n:E = \\frac {Z}{ 2 \\, \\sqrt{n} }\n:E = \\frac {Z}{ 2 \\, \\sqrt{ 10000 } } = \\frac {Z}{ 200 }\n:E = 0.0050\\,  at 68.27% level of confidence (Z=1)\n:E = 0.0100\\,  at 95.45% level of confidence (Z=2)\n:E = 0.0165\\,  at 99.90% level of confidence (Z=3.3)\n| 3 = The coin is tossed 12000 times with a result of 5961 heads (and 6039 tails). What interval does the value of r\\,\\! (the true probability of obtaining heads) lie within if a confidence level of 99.999% is desired?\n:p = \\frac{h}{h+t} \\, = \\frac{5961}{12000} \\, = 0.4968\nNow find the value of Z corresponding to 99.999% level of confidence.\n:Z = 4.4172 \\,\\!\nNow calculate E\n: E = \\frac{Z}{2 \\, \\sqrt{n}} \\, = \\frac{4.4172}{2 \\, \\sqrt{12000}} \\, = 0.0202\nThe interval which contains r is thus:\n: p - E\n: 0.4766\n}}\nOther approaches\nOther approaches to the question of checking whether a coin is fair are available using decision theory, whose application would require the formulation of a loss function or utility function which describes the consequences of making a given decision. An approach that avoids requiring either a loss function or a prior probability (as in the Bayesian approach) is that of \"acceptance sampling\".\nOther applications\nThe above mathematical analysis for determining if a coin is fair can also be applied to other uses. For example:\n* Determining the proportion of defective items for a product subjected to a particular (but well defined) condition. Sometimes a product can be very difficult or expensive to produce. Furthermore, if testing such products will result in their destruction, a minimum number of items should be tested. Using a similar analysis, the probability density function of the product defect rate can be found.\n* Two party polling. If a small random sample poll is taken where there are only two mutually exclusive choices, then this is similar to tossing a single coin multiple times using a possibly biased coin. A similar analysis can therefore be applied to determine the confidence to be ascribed to the actual ratio of votes cast. (If people are allowed to abstain then the analysis must take account of that, and the coin-flip analogy doesn't quite hold.)\n* Determining the sex ratio in a large group of an animal species. Provided that a small random sample (i.e. small in comparison with the total population) is taken when performing the random sampling of the population, the analysis is similar to determining the probability of obtaining heads in a coin toss.\nSee also\n*Binomial test\n*Coin flipping\n*Confidence interval\n*Estimation theory\n*Inferential statistics\n*Loaded dice\n*Margin of error\n*Point estimation\n*Statistical randomness\nReferences\n*Guttman, Wilks, and Hunter: Introductory Engineering Statistics, John Wiley & Sons, Inc. (1971)\n*Devinder Sivia: Data Analysis, a Bayesian Tutorial, Oxford University Press (1996)"
    }
  ]
}