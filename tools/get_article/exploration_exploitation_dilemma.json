{
  "content": [
    {
      "type": "text",
      "text": "# Exploration–exploitation dilemma\n\nThe exploration–exploitation dilemma, also known as the explore–exploit tradeoff, is a fundamental concept in decision-making that arises in many domains. It is depicted as the balancing act between two opposing strategies. Exploitation involves choosing the best option based on current knowledge of the system (which may be incomplete or misleading), while exploration involves trying out new options that may lead to better outcomes in the future at the expense of an exploitation opportunity. Finding the optimal balance between these two strategies is a crucial challenge in many decision-making problems whose goal is to maximize long-term benefits.\nApplication in machine learning\nIn the context of machine learning, the exploration–exploitation tradeoff is fundamental in reinforcement learning (RL), a type of machine learning that involves training agents to make decisions based on feedback from the environment. Crucially, this feedback may be incomplete or delayed. The agent must decide whether to exploit the current best-known policy or explore new policies to improve its performance.\nMulti-armed bandit methods\nThe multi-armed bandit (MAB) problem was a classic example of the tradeoff, and many methods were developed for it, such as epsilon-greedy, Thompson sampling, and the upper confidence bound (UCB). See the page on MAB for details.\nIn more complex RL situations than the MAB problem, the agent can treat each choice as a MAB, where the payoff is the expected future reward. For example, if the agent performs an epsilon-greedy method, then the agent will often \"pull the best lever\" by picking the action that had the best predicted expected reward (exploit). However, it would pick a random action with probability epsilon (explore). Monte Carlo tree search, for example, uses a variant of the UCB method.\nExploration problems\nThere are some problems that make exploration difficult.\n* Sparse reward. If rewards occur only once a long while, then the agent might not persist in exploring. Furthermore, if the space of actions is large, then the sparse reward would mean the agent would not be guided by the reward to find a good direction for deeper exploration. A standard example is ''Montezuma's Revenge''.\n* Deceptive reward. If some early actions give immediate small reward, but other actions give later large reward, then the agent might be lured away from exploring the other actions.\n* Noisy TV problem. If certain observations are irreducibly noisy (such as a television showing random images), then the agent might be trapped exploring those observations (watching the television).\nExploration reward\nThis section based on.\nThe exploration reward (also called exploration bonus) methods convert the exploration-exploitation dilemma into a balance of exploitations. That is, instead of trying to get the agent to balance exploration and exploitation, exploration is simply treated as another form of exploitation, and the agent simply attempts to maximize the sum of rewards from exploration and exploitation. The exploration reward can be treated as a form of intrinsic reward.\nWe write these as r_t^i, r_t^e, meaning the intrinsic and extrinsic rewards at time step t.\nHowever, exploration reward is different from exploitation in two regards:\n* The reward of exploitation is not freely chosen, but given by the environment, but the reward of exploration may be picked freely. Indeed, there are many different ways to design r_t^i described below.\n* The reward of exploitation is usually stationary (i.e. the same action in the same state gives the same reward), but the reward of exploration is non-stationary (i.e. the same action in the same state should give less and less reward).\nCount-based exploration uses N_n(s), the number of visits to a state s during the time-steps 1:n, to calculate the exploration reward. This is only possible in small and discrete state space. Density-based exploration extends count-based exploration by using a density model \\rho_n(s). The idea is that, if a state has been visited, then nearby states are also partly-visited.\nIn maximum entropy exploration, the entropy of the agent's policy \\pi is included as a term in the intrinsic reward. That is, r_t^i = -\\sum_a \\pi(a | s_t) \\ln \\pi(a | s_t) + \\cdots .\nPrediction-based\nThis section based on.\nThe forward dynamics model is a function for predicting the next state based on the current state and the current action: f: (s_t, a_t) \\mapsto s_{t+1}. The forward dynamics model is trained as the agent plays. The model becomes better at predicting state transition for state-action pairs that had been done many times.\nA forward dynamics model can define an exploration reward by r_t^i = \\|f(s_t, a_t) - s_{t+1}\\|_2^2. That is, the reward is the squared-error of the prediction compared to reality. This rewards the agent to perform state-action pairs that had not been done many times. This is however susceptible to the noisy TV problem.\nDynamics model can be run in latent space. That is, r_t^i = \\|f(s_t, a_t) - \\phi(s_{t+1})\\|_2^2 for some featurizer \\phi. The featurizer can be the identity function (i.e. \\phi(x) = x), randomly generated, the encoder-half of a variational autoencoder, etc. A good featurizer improves forward dynamics exploration.\nThe Intrinsic Curiosity Module (ICM) method trains simultaneously a forward dynamics model and a featurizer. The featurizer is trained by an inverse dynamics model, which is a function for predicting the current action based on the features of the current and the next state: g: (\\phi(s_t), \\phi(s_{t+1})) \\mapsto a_t. By optimizing the inverse dynamics, both the inverse dynamics model and the featurizer are improved. Then, the improved featurizer improves the forward dynamics model, which improves the exploration of the agent.\nRandom Network Distillation (RND) method attempts to solve this problem by teacher–student distillation. Instead of a forward dynamics model, it has two models f, f'. The f' teacher model is fixed, and the f student model is trained to minimize \\|f(s) - f'(s)\\|_2^2 on states s. As a state is visited more and more, the student network becomes better at predicting the teacher. Meanwhile, the prediction error is also an exploration reward for the agent, and so the agent learns to perform actions that result in higher prediction error. Thus, we have a student network attempting to minimize the prediction error, while the agent attempting to maximize it, resulting in exploration.\nThe states are normalized by subtracting a running average and dividing a running variance, which is necessary since the teacher model is frozen. The rewards are normalized by dividing with a running variance.\nExploration by disagreement trains an ensemble of forward dynamics models, each on a random subset of all (s_t, a_t, s_{t+1}) tuples. The exploration reward is the variance of the models' predictions.\nNoise\nFor neural network–based agents, the NoisyNet method changes some of its neural network modules by noisy versions. That is, some network parameters are random variables from a probability distribution. The parameters of the distribution are themselves learnable. For example, in a linear layer y = Wx + b, both W, b are sampled from Gaussian distributions \\mathcal N(\\mu_W, \\Sigma_W), \\mathcal N(\\mu_b, \\Sigma_b) at every step, and the parameters \\mu_W, \\Sigma_W, \\mu_b, \\Sigma_b are learned via the reparameterization trick.\nReferences\n*"
    }
  ]
}