{
  "content": [
    {
      "type": "text",
      "text": "# Shellshock (software bug)\n\n(initial),, , , ,\n| discovered =\n| patched =\n| discoverer = Stéphane Chazelas\n| affected software = Bash (1.0.3–4.3)\n| website =\n}}\nShellshock, also known as Bashdoor, is a family of security bugs in the Unix Bash shell, the first of which was disclosed on 24 September 2014. Shellshock could enable an attacker to cause Bash to execute arbitrary commands and gain unauthorized access to many Internet-facing services, such as web servers, that use Bash to process requests.\nOn 12 September 2014, Stéphane Chazelas informed Bash's maintainer Chet Ramey of his discovery of the original bug, which he called \"Bashdoor\". Working with security experts, Mr. Chazelas developed a patch (fix) for the issue, which by then had been assigned the vulnerability identifier '. The existence of the bug was announced to the public on 2014-09-24, when Bash updates with the fix were ready for distribution.\nThe bug Chazelas discovered caused Bash to unintentionally execute commands when the commands are concatenated to the end of function definitions stored in the values of environment variables. Within days of its publication, a variety of related vulnerabilities were discovered ('). Ramey addressed these with a series of further patches.\nAttackers exploited Shellshock within hours of the initial disclosure by creating botnets of compromised computers to perform distributed denial-of-service attacks and vulnerability scanning. Security companies recorded millions of attacks and probes related to the bug in the days following the disclosure.\nBecause of the potential to compromise millions of unpatched systems, Shellshock was compared to the Heartbleed bug in its severity.\nBackground\nThe Shellshock bug affects Bash, a program that various Unix-based systems use to execute command lines and command scripts. It is often installed as the system's default command-line interface. Analysis of the source code history of Bash shows the bug was introduced on 5 August 1989, and released in Bash version 1.03 on 1 September 1989.\nShellshock is an arbitrary code execution vulnerability that offers a way for users of a system to execute commands that should be unavailable to them. This happens through Bash's \"function export\" feature, whereby one Bash process can share command scripts with other Bash processes that it executes. This feature is implemented by encoding the scripts in a table that is shared between the processes, known as the environment variable list. Each new Bash process scans this table for encoded scripts, assembles each one into a command that defines that script in the new process, and executes that command. The new process assumes that the scripts found in the list come from another Bash process, but it cannot verify this, nor can it verify that the command that it has built is a properly formed script definition. Therefore, an attacker can execute arbitrary commands on the system or exploit other bugs that may exist in Bash's command interpreter, if the attacker has a way to manipulate the environment variable list and then cause Bash to run. At the time the bug was discovered, Bash was installed on macOS and many Linux operating systems as the main command interpreter, so that any program that used the system function to run any other program would use Bash to do so.\nThe presence of the bug was announced to the public on 2014-09-24, when Bash updates with the fix were ready for distribution, though it took some time for computers to be updated to close the potential security issue.\nReports of attacks\nWithin an hour of the announcement of the Bash vulnerability, there were reports of machines being compromised by the bug. By 25 September 2014, botnets based on computers compromised with exploits based on the bug were being used by attackers for distributed denial-of-service (DDoS) attacks and vulnerability scanning. Kaspersky Labs reported that machines compromised in an attack, dubbed \"Thanks-Rob\", were conducting DDoS attacks against three targets, which they did not identify. On 26 September 2014, a Shellshock-related botnet dubbed \"wopbot\" was reported, which was being used for a DDoS attack against Akamai Technologies and to scan the United States Department of Defense.\nOn 26 September, the security firm Incapsula noted 17,400 attacks on more than 1,800 web domains, originating from 400 unique IP addresses, in the previous 24 hours; 55% of the attacks were coming from China and the United States. By 30 September, the website performance firm CloudFlare said it was tracking approximately 1.5 million attacks and probes per day related to the bug.\nOn 6 October, it was widely reported that Yahoo! servers had been compromised in an attack related to the Shellshock issue.\nYet the next day, it was denied that it had been Shellshock that specifically had allowed these attacks.\nSpecific exploitation vectors\n; CGI-based web server\n: When a web server uses the Common Gateway Interface (CGI) to handle a document request, it copies certain information from the request into the environment variable list and then delegates the request to a handler program. If the handler is a Bash script, or if it executes Bash, then Bash will receive the environment variables passed by the server and will process them as described above. This provides a means for an attacker to trigger the Shellshock vulnerability with a specially crafted document request.\n: Security documentation for the widely used Apache web server states: \"CGI scripts can ... be extremely dangerous if they are not carefully checked,\" and other methods of handling web server requests are typically used instead. There are a number of online services which attempt to test the vulnerability against web servers exposed to the Internet.\n; OpenSSH server\n: OpenSSH has a \"ForceCommand\" feature, where a fixed command is executed when the user logs in, instead of just running an unrestricted command shell. The fixed command is executed even if the user specified that another command should be run; in that case the original command is put into the environment variable \"SSH_ORIGINAL_COMMAND\". When the forced command is run in a Bash shell (if the user's shell is set to Bash), the Bash shell will parse the SSH_ORIGINAL_COMMAND environment variable on start-up, and run the commands embedded in it. The user has used their restricted shell access to gain unrestricted shell access, using the Shellshock bug.\n; DHCP clients\n: Some DHCP clients can also pass commands to Bash; a vulnerable system could be attacked when connecting to an open Wi-Fi network. A DHCP client typically requests and gets an IP address from a DHCP server, but it can also be provided a series of additional options. A malicious DHCP server could provide, in one of these options, a string crafted to execute code on a vulnerable workstation or laptop.\n; Qmail server\n: When using Bash to process email messages (e.g. through .forward or qmail-alias piping), the qmail mail server passes external input through in a way that can exploit a vulnerable version of Bash.\n; IBM HMC restricted shell\n: The bug can be exploited to gain access to Bash from the restricted shell of the IBM Hardware Management Console, a tiny Linux variant for system administrators. IBM released a patch to resolve this.\nReported vulnerabilities\nOverview\nThe maintainer of Bash was warned about the first discovery of the bug on 2014-09-12; a fix followed soon. A few companies and distributors were informed before the matter was publicly disclosed on 2014-09-24 with CVE identifier . However, after the release of the patch there were subsequent reports of different, yet related vulnerabilities.\nOn 26 September 2014, two open-source contributors, David A. Wheeler and Norihiro Tanaka, noted that there were additional issues, even after patching systems using the most recently available patches.  In an email addressed to the oss-sec and bash-bug mailing lists, Wheeler wrote: \"This patch just continues the 'whack-a-mole'  job of fixing parsing errors that began with the first patch. Bash's parser is certain [to] have many many many other vulnerabilities\".\nOn 27 September 2014, Michał Zalewski from Google Inc. announced his discovery of other Bash vulnerabilities, one based upon the fact that Bash is typically compiled without address space layout randomization. On 1 October, Zalewski released details of the final bugs and confirmed that a patch by Florian Weimer from Red Hat posted on 25 September does indeed prevent them. He has done that using a fuzzing technique with the aid of software utility known as american fuzzy lop.\nInitial report (CVE-2014-6271)\nThis original form of the vulnerability () involves a specially crafted environment variable containing an exported function definition, followed by arbitrary commands. Bash incorrectly executes the trailing commands when it imports the function. The vulnerability can be tested with the following command:\nenv x='() { :;}; echo vulnerable' bash -c \"echo this is a test\"\nIn systems affected by the vulnerability, the above commands will display the word \"vulnerable\" as a result of Bash executing the command \"echo&nbsp;vulnerable\", which was embedded into the specially crafted environment variable named \"x\".\nCVE-2014-6277\nDiscovered by Michał Zalewski, the vulnerability , which relates to the parsing of function definitions in environment variables by Bash, can cause a segfault.\nCVE-2014-6278\nAlso discovered by Michał Zalewski, this bug () relates to the parsing of function definitions in environment variables by Bash.\nCVE-2014-7169\nOn the same day the original vulnerability was published, Tavis Ormandy discovered this related bug (), which is\ndemonstrated in the following code:\nenv X='() { (a)=>\\' bash -c \"echo date\"; cat echo\nOn a vulnerable system, this would execute the command \"date\" unintentionally.\nHere is an example of a system that has a patch for CVE-2014-6271 but not CVE-2014-7169:\n$ X='() { (a)=>\\' bash -c \"echo date\"\nbash: X: line 1: syntax error near unexpected token `='\nbash: X: line 1: `'\nbash: error importing function definition for `X'\n$ cat echo\nFri Sep 26 01:37:16 UTC 2014\nThe system displays syntax errors, notifying the user that CVE-2014-6271 has been prevented, but still writes a file named 'echo', into the working directory, containing the result of the 'date' call.\nA system patched for both CVE-2014-6271 and CVE-2014-7169 will simply echo the word \"date\" and the file \"echo\" will not be created, as shown below:\n$ X='() { (a)=>\\' bash -c \"echo date\"\ndate\n$ cat echo\ncat: echo: No such file or directory\nCVE-2014-7186\nFlorian Weimer and Todd Sabin found this bug (), which relates to an out-of-bounds memory access error in the Bash parser code.\nAn example of the vulnerability, which leverages the use of multiple \"\nbash -c 'true\nA vulnerable system will echo the text \"CVE-2014-7186 vulnerable, redir_stack\".\nCVE-2014-7187\nAlso found by Florian Weimer,  is an off-by-one error in the Bash parser code, allowing out-of-bounds memory access.\nAn example of the vulnerability, which leverages the use of multiple \"done\" declarations:\n(for x in {1..200} ; do echo \"for x$x in ; do :\"; done; for x in {1..200} ; do echo done ; done) | bash ||\necho \"CVE-2014-7187 vulnerable, word_lineno\"\nA vulnerable system will echo the text \"CVE-2014-7187 vulnerable, word_lineno\".  This test requires a shell that supports brace expansion.\nPatches\nUntil 24 September 2014, Bash maintainer Chet Ramey provided a patch version bash43-025 of Bash 4.3 addressing CVE-2014-6271, which was already packaged by distribution maintainers. On 24 September, bash43-026 followed, addressing CVE-2014-7169.\nThen CVE-2014-7186 was discovered. Florian Weimer from Red Hat posted some patch code for this \"unofficially\" on 25 September,\nwhich Ramey incorporated into Bash as bash43-027.—These patches provided source code only, helpful only for those who know how to compile (\"rebuild\") a new Bash binary executable file from the patch file and remaining source code files. The patches added a variable name prefix when functions are exported; this prevented arbitrary variables from triggering the vulnerability and enabled other programs to remove Bash functions from the environment.\nThe next day, Red Hat officially presented according updates for Red Hat Enterprise Linux, after another day for Fedora 21.\nCanonical Ltd. presented updates for its Ubuntu Long Term Support versions on Saturday, 27 September;\non Sunday, there were updates for SUSE Linux Enterprise.\nThe following Monday and Tuesday at the end of the month, Mac OS X updates appeared.\nOn 1 October 2014, Michał Zalewski from Google Inc. finally stated that Weimer's code and bash43-027 had fixed not only the first three bugs but even the remaining three that were published after bash43-027, including his own two discoveries. This means that after the earlier distribution updates, no other updates have been required to cover all the six issues.\nAll of them have also been covered for the IBM Hardware Management Console.\nReferences\nExternal links\n* NIST [http://nvd.nist.gov/home.cfm National Vulnerability Database]  & CVE [http://cve.mitre.org Common Vulnerabilities and Exposures]\n** CVE-2014-6271 - [https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6271 20140924nist] & [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271 20140909cve] (first bug)\n** CVE-2014-6277 - [https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6277 20140927nist] & [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6277 20140909cve]\n** CVE-2014-6278 - [https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6278 20140930nist] & [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6278 20140909cve]\n** CVE-2014-7169 - [https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-7169 20140924nist] & [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7169 20140924cve] (second bug)\n** CVE-2014-7186 - [https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-7186 20140929nist] & [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7186 20140925cve]\n** CVE-2014-7187 - [https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-7187 20140929nist] & [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7187 20140925cve]\n* [https://ftp.gnu.org/gnu/bash/ Bash source code] from the GNU Project, includes patches for known vulnerabilities (28 September 2014)\n* [https://www.fireeye.com/blog/threat-research/2014/09/shellshock-in-the-wild.html \"Shellshock in the Wild\", Malware droppers, Reverse shells & backdoors, Data exfiltration, and DDoS] at FireEye, Inc.\n* [https://isc.sans.edu/diary/Shellshock%3A+A+Collection+of+Exploits+seen+in+the+wild/18725 Collection of attacks seen in the wild (29 September 2014)] at SANS Institute\n* [http://www.oracle.com/technetwork/topics/security/alert-cve-2014-7169-2303276.html Security Alert for CVE-2014-7169] at Oracle\n* [http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2090740 \"VMware remediation of Bash Code Injection Vulnerability via Specially Crafted Environment Variables\"] at VMware\n* [https://www.cyberwatch.fr/en/vulnerabilities Cyberwatch Vulnerabilities Database]\n** [https://www.cyberwatch.fr/en/vulnerabilities/CVE-2014-6271 CVE-2014-6271]\n** [https://www.cyberwatch.fr/en/vulnerabilities/CVE-2014-6277 CVE-2014-6277]\n** [https://www.cyberwatch.fr/en/vulnerabilities/CVE-2014-6278 CVE-2014-6278]\n** [https://www.cyberwatch.fr/en/vulnerabilities/CVE-2014-7169 CVE-2014-7169]\n** [https://www.cyberwatch.fr/en/vulnerabilities/CVE-2014-7186 CVE-2014-7186]\n** [https://www.cyberwatch.fr/en/vulnerabilities/CVE-2014-7187 CVE-2014-7187]\n* [https://www.yeahhub.com/shellshock-vulnerability-exploitation-metasploit-framework/ ShellShock Exploitation with Metasploit Framework]"
    }
  ]
}