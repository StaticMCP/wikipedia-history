{
  "content": [
    {
      "type": "text",
      "text": "# Schwartz–Zippel lemma\n\nIn mathematics, the Schwartz–Zippel lemma (also called the DeMillo–Lipton–Schwartz–Zippel lemma) is a tool commonly used in probabilistic polynomial identity testing. Identity testing is the problem of determining whether a given multivariate polynomial is the\n0-polynomial, the polynomial that ignores all its variables and always returns zero. The lemma states that evaluating a nonzero polynomial on inputs chosen randomly from a large-enough set is likely to find an input that produces a nonzero output.\nit was discovered independently by Jack Schwartz, Richard Zippel, and Richard DeMillo and Richard J. Lipton, although DeMillo and Lipton's version was shown a year prior to Schwartz and Zippel's result. The finite field version of this bound was proved by Øystein Ore in 1922.\nStatement and proof of the lemma\nTheorem 1 (Schwartz, Zippel). Let\n: P\\in R[x_1,x_2,\\ldots,x_n]\nbe a non-zero polynomial of total degree  over an integral domain&nbsp;R. Let S be a finite subset of R and let  be selected at random independently and uniformly from&nbsp;S. Then\n: \\Pr[P(r_1,r_2,\\ldots,r_n)=0]\\leq\\frac{d}{|S|}.\nEquivalently, the Lemma states that for any finite subset S of R, if Z(P) is the zero set of P, then\n:  | Z(P) \\cap S^n | \\leq d \\cdot |S|^{n-1}.\nProof.  The proof is by mathematical induction on n. For , P can have at most d roots by the fundamental theorem of algebra.  This gives us the base case.\nNow, assume that the statement holds for all polynomials in  variables. We can then consider P to be a polynomial in x1 by writing it as\n: P(x_1,\\dots,x_n)=\\sum_{i=0}^d x_1^i P_i(x_2,\\dots,x_n).\nSince  is not identically 0, there is some  such that P_i is not identically 0. Take the largest such . Then \\deg P_i\\leq d-i, since the degree of x_1^iP_i is at most d.\nNow we randomly pick r_2,\\dots,r_n from . By the induction hypothesis, \\Pr[P_i(r_2,\\ldots,r_n)=0]\\leq\\frac{d-i}{|S|}.\nIf P_i(r_2,\\ldots,r_n)\\neq 0, then P(x_1,r_2,\\ldots,r_n) is of degree  (and thus not identically zero) so\n::: \\Pr[P(r_1,r_2,\\ldots,r_n)=0|P_i(r_2,\\ldots,r_n)\\neq 0]\\leq\\frac{i}{|S|}.\nIf we denote the event P(r_1,r_2,\\ldots,r_n)=0 by , the event P_i(r_2,\\ldots,r_n)=0 by , and the complement of  by B^c, we have\n:\\begin{align}\n\\Pr[A] & =\\Pr[A\\cap B]+\\Pr[A\\cap B^c]\n\\\\\n&=\\Pr[B]\\Pr[A|B]+\\Pr[B^c]\\Pr[A|B^c]\n\\\\\n&\\leq \\Pr[B]+\\Pr[A|B^c]\n\\\\\n&\\leq \\frac{d-i}{|S|}+\\frac{i}{|S|}=\\frac{d}{|S|}\n\\end{align}\nRemark. The Schwartz-Zippel lemma is tight in the following sense. Let  S \\subseteq R  be a finite subset and let  d \\leq |S| . Choose any  d  distinct elements  s_1, \\ldots, s_d  from  S . Then define  P \\in R[x_1, \\ldots, x_n]  by  P(x_1, \\ldots, x_n) = \\prod_{i = 1}^d (x_1 - s_i) . Let  r_1, \\ldots, r_n  be selected uniformly at random from  S . Then  \\Pr[P(r_1, \\ldots, r_n) = 0] = \\Pr[r_1 \\in \\{s_1, \\ldots, s_d\\}] = \\frac{d}{|S|}  so that the bound stated in the Schwartz-Zippel lemma is exactly matched.\nApplications\nThe importance of the Schwartz–Zippel lemma and follows\nfrom algorithms which are obtained to problems that can be reduced to the problem\nof polynomial identity testing.\nZero testing\nOne of the most common applications of the Schwartz-Zippel lemma in theoretical computer science is to testing whether a polynomial (given in terms of an arithmetic circuit or formula) is identically 0. For example, consider asking whether the arithmetic formula below is identically 0\n: (x_1 + 3x_2 - x_3)(3x_1 + x_4 - 1) \\cdots (x_{7} - x_{100}) \\equiv 0\\  ?\nTo solve deterministically, we can multiply all the terms and check whether the coefficient of every possible product of variables is &nbsp;0.  However, this can take exponential time in the number of variables $n$ since there may be at most 2^n product terms. Instead, we can evaluate the polynomial at a random tuple of points over a sufficiently large field (which can be done in linearly-many arithmetic operations in the length of the formula) and if the result is indeed 0, we can use the SZ lemma to conclude the formula is identically 0 with high probability.\nComparison of two polynomials\nGiven a pair of polynomials p_1(x) and p_2(x), is\n::: p_1(x) \\equiv p_2(x)?\nThis problem can be solved by reducing it to the problem of polynomial identity testing. It is equivalent to checking if\n::: [p_1(x) - p_2(x)] \\equiv 0.\nHence if we can determine that\n::: p(x) \\equiv 0,\nwhere\n::: p(x) = p_1(x)\\;-\\;p_2(x),\nthen we can determine whether the two polynomials are equivalent.\nComparison of polynomials has applications for branching programs (also called binary decision diagrams). A read-once branching program can be represented by a multilinear polynomial which computes (over any field) on {0,1}-inputs the same Boolean function as the branching program, and two branching programs compute the same function if and only if the corresponding polynomials are equal. Thus, identity of Boolean functions computed by read-once branching programs can be reduced to polynomial identity testing.\nComparison of two polynomials (and therefore testing polynomial identities) also has\napplications in 2D-compression, where the problem of finding the equality of two\n2D-texts A and B is reduced to the problem\nof comparing equality of two polynomials p_A(x,y) and p_B(x,y).\nPrimality testing\nGiven n \\in \\mathbb{N}, is n a prime number?\nA simple randomized algorithm developed by Manindra Agrawal and Somenath Biswas can determine probabilistically\nwhether n is prime and uses polynomial identity testing to do so.\nThey propose that all prime numbers n (and only prime numbers) satisfy the following\npolynomial identity:\n:::  (1+z)^n = 1+z^n (\\mbox{mod}\\;n).\nThis is a consequence of the Frobenius endomorphism.\nLet\n::: \\mathcal{P}_n(z) = (1+z)^n - 1 -z^n.\nThen \\mathcal{P}_n(z) = 0\\;(\\mbox{mod}\\;n) iff n is prime.  The proof can be found in [4].  However,\nsince this polynomial has degree n, where n may or may not be a prime,\nthe Schwartz–Zippel method would not work.   Agrawal and Biswas use a more sophisticated technique, which divides\n\\mathcal{P}_n by a random monic polynomial of small degree. The AKS algorithm uses a similar technique but runs in deterministic polynomial time.\nPrime numbers are used in a number of applications such as hash table sizing, pseudorandom number\ngenerators and in key generation for cryptography.  Therefore, finding very large prime numbers\n(on the order of (at least) 10^{350} \\approx 2^{1024}) becomes very important and efficient primality testing algorithms\nare required.\nPerfect matching\nLet G = (V, E) be a graph of  vertices where  is even. Does  contain a perfect matching?\nTheorem 2 : A Tutte matrix determinant is not a -polynomial if and only if there exists a perfect matching.\nA subset  of  is called a matching if each vertex in  is incident with at most one edge in .  A matching is perfect if each vertex in  has exactly one edge that is incident to it in . Create a Tutte matrix  in the following way:\n::: A = \\begin{bmatrix} a_{11} & a_{12} & \\cdots & a_{1\\mathit{n}} \\\\ a_{21} & a_{22} & \\cdots & a_{2\\mathit{n}} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ a_{\\mathit{n}1} & a_{\\mathit{n}2} & \\ldots & a_{\\mathit{nn}} \\end{bmatrix}\nwhere\n::: a_{ij} = \\begin{cases} x_{ij}\\;\\;\\mbox{if}\\;(i,j) \\in E \\mbox{ and } ij\\\\\n0\\;\\;\\;\\;\\mbox{otherwise}. \\end{cases}\nThe Tutte matrix determinant (in the variables xij,  ) is then defined as the determinant of this skew-symmetric matrix which coincides with the square of the pfaffian of the matrix A and is non-zero (as polynomial) if and only if a perfect matching exists.\nOne can then use polynomial identity testing to find whether  contains a perfect matching. There exists a deterministic black-box algorithm for graphs with polynomially bounded permanents (Grigoriev & Karpinski 1987).\nIn the special case of a balanced bipartite graph on  n =m + m  vertices this matrix takes the form of a block matrix\n::: A = \\begin{pmatrix} 0 & X \\\\ -X^t & 0 \\end{pmatrix}\nif the first m rows (resp. columns) are indexed with the first subset of the bipartition and the last m rows with the complementary subset. In this case the pfaffian coincides with the usual determinant of the m &times; m matrix X (up to sign).  Here X is the Edmonds matrix.\nDeterminant of a matrix with polynomial entries\nLet\n: p(x_1,x_2, \\ldots, x_n)\nbe the determinant of the polynomial matrix.\nCurrently, there is no known sub-exponential time algorithm that can solve this problem deterministically. However, there are randomized polynomial algorithms whose analysis requires a bound on the probability that a non-zero polynomial will have roots at randomly selected test points.\nNotes\nReferences\n*\n*\n*\n* Moshkovitz, Dana (2010). An Alternative Proof of The Schwartz-Zippel Lemma.\n*\n*\n*\n*\n*\n*\n*\nExternal links\n* [http://rjlipton.wordpress.com/2009/11/30/the-curious-history-of-the-schwartz-zippel-lemma The Curious History of the Schwartz–Zippel Lemma], by Richard J. Lipton"
    }
  ]
}