{
  "content": [
    {
      "type": "text",
      "text": "# X-Forwarded-For__disambig_1\n\nThe X-Forwarded-For (XFF) HTTP header field is a common method for identifying the originating IP address of a client connecting to a web server through an HTTP proxy or load balancer.\nThe X-Forwarded-For HTTP request header was introduced by the Squid caching proxy server's developers.\nX-Forwarded-For is also an email-header indicating that an email-message was forwarded from one or more other accounts (probably automatically).\nWithout the use of XFF or another similar technique, any connection through the proxy would reveal only the originating IP address of the proxy server, effectively turning the proxy server into an anonymizing service, thus making the detection and prevention of abusive accesses significantly harder than if the originating IP address were available. The usefulness of XFF depends on the proxy server truthfully reporting the original host's IP address; for this reason, effective use of XFF requires knowledge of which proxies are trustworthy, for instance by looking them up in a whitelist of servers whose maintainers can be trusted.\nFormat\nThe general format of the field is:\nX-Forwarded-For: client, proxy1, proxy2\nwhere the value is a comma+space separated list of IP addresses, the left-most being the original client, and each successive proxy that passed the request adding the IP address where it received the request from. In this example, the request passed through proxy1, proxy2, and then proxy3 (not shown in the header). proxy3 appears as remote address of the request.\nExamples:\nX-Forwarded-For: 203.0.113.195, 70.41.3.18, 150.172.238.178\nX-Forwarded-For: 203.0.113.195\nX-Forwarded-For: 2001:db8:85a3:8d3:1319:8a2e:370:7348\nBecause the X-Forwarded-For header is not formally standardized, some variations to the IP address format exist. For example, some implementations include the port number of clients, or enclose IPv6 addresses in square brackets even without the port number, similar to the format in the newer Forwarded header. Examples:\nX-Forwarded-For: 203.0.113.195:41237, 198.51.100.100:38523\nX-Forwarded-For: [2001:db8::1a2b:3c4d]:41237, 198.51.100.100:26321\nX-Forwarded-For: [2001:db8::aa:bb]\nUsage\nThe X-Forwarded-For header is added or edited by HTTP proxies when forwarding a request. The server appends the address of the client to an existing X-Forwarded-For header separated by a comma, or creates a new X-Forwarded-For header with the client address as the value.\nSince it is easy to forge an X-Forwarded-For field the given information should be used with care. The right-most IP address is always the IP address that connects to the last proxy, which means it is the most reliable source of information. X-Forwarded-For data can be used in a forward or reverse proxy scenario. If the server is behind a trusted reverse proxy and only allows connections from that proxy, the header value can usually be assumed to be trustworthy.\nJust logging the X-Forwarded-For field is not always enough as the last proxy IP address in a chain is not contained within the X-Forwarded-For field, it is in the actual IP header. A web server should log both the request's source IP address and the X-Forwarded-For field information for completeness.\nAlternatives and variations\nstandardized a Forwarded HTTP header with similar purpose but more features compared to the X-Forwarded-For HTTP header. An example of a Forwarded header's syntax:\nForwarded: for=192.0.2.60;proto=http;by=203.0.113.43\nForwarded: for=\"[2001:db8::1234]\"\nHAProxy defines the PROXY protocol which can communicate the originating client's IP address without using the X-Forwarded-For or Forwarded header. This protocol can be used on multiple transport protocols and does not require inspecting the inner protocol, so it is not limited to HTTP.\nSee also\n* Internet privacy\n* List of proxy software\n* X-Originating-IP for SMTP equivalent\n* List of HTTP header fields\nReferences\nExternal links\n* Apache [https://web.archive.org/web/20070218024619/http://www.openinfo.co.uk/apache/index.html mod_extract_forwarded]"
    }
  ]
}