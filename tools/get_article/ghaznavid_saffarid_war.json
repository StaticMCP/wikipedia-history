{
  "content": [
    {
      "type": "text",
      "text": "# Ghaznavid–Saffarid war\n\n| combatant1        = Ghaznavids\n| combatant2        = Saffarids\n| commander1        = Mahmud of GhazniBughrajuqAbu'l Muzaffar NasrAltuntashMuhammad at-Ta'i\n| commander2        = Khalaf ITahir\n| image             = SakastanMap.jpg\n| caption           = Map of Sistan also known as Sakastan\n| date              = 999-1002 AD\n| strength1         = 10,000\n| strength2         = --\n| campaignbox       =\n}}\nIn 999–1002 Mahmud of Ghazni invaded Sistan, ruled by the Saffarids. The last Saffarid ruler, Khalaf ibn Ahmad, carried out campaigns in Ghaznavid territories, capturing Fushanj, Bust, Kuhistan which prompted Ghaznavid Sultan Mahmud to lead campaign against the Saffarids. The campaign marked the end of dynasty in 1002 AD.\nBackground\nIn 986-7, Saffarid ruler Khalaf send an army to capture Bust and Zabulistan whilst Sabuktigin was absent fighting the Hindu Shahi Raja Jayapala, but he had to evacuate Bust on the Ghaznavid's return.\nIn 996 AD, Khalaf urged the Ilig Khan Nasr of Kara-Khanid Khanate who was pressuring the Samanids in Bukhara, to attack the Ghaznavids. After Sabuktigin'a death in 997, Mahmud and Isma'il engaged in a succession war. In 998, Seizing the opportunity, Khalaf's son Tahir, captured the regions of Fushanj and Kuhistan. After accession of Mahmud, he dispatched Bughrajuq to retake the territories. Tahir was defeated and forced to flee, but Bughrajuq, being flushed with victory, drank heavily and, rode in pursuit of the enemy. Tahir, finding him helplessly drunk, turned back and killed him.\nSieges\nIn December 999 AD, Mahmud marched on Sistan with a large army to punish Khalaf. Khalaf retreated to the fortress of Ispahbud, where he laid siege. Khalaf sought peace and offered to pay an indemnity of 100,000 dinars. Shortly after, Khalaf's son Tahir rebelled against him, who failed defeat Tahir in battle, devised a assassination to avoid ruin. He sent an affectionate message to Tahir, claiming he was near death and inviting him to claim his treasure. When Tahir arrived and was embraced by Khalaf, soldiers hidden in nearby vegetation ambushed him. Tahir was bound, taken prisoner to the fort, and executed a few days later. Khalaf's actions led discontentment amongst his commanders who invited Sultan Mahmud to overthrow Khalaf and rule Sistan.\nIn November 1002 AD, Sultan Mahmud marched to Sistan. Khalaf retreated to the fort of Taq. The fort, protected by seven layers of fortifications and a deep, wide ditch, was nearly impregnable. Mahmud initiated a siege, ordering the ditch to be filled to allow his forces to advance. Despite a barrage of stones and missiles from the defenders, Mahmud’s troops crossed the ditch and assaulted the fort’s gates, which were shattered fierce charges of war elephants. The Ghaznavid army captured the outer fortifications. Khalaf’s forces resisted fiercely, but the advance of Mahmud’s elephants overwhelmed their defenses. Khalaf surrendered the fort offering submission. Hajib Qinji was placed in charge of Sistan. During the suppression of rebellion Mahmud's Hindu troops sacked the Friday mosque of Zaranj massacring Muslims and Christians at their Church.\nAftermath\nin 1003 CE. Jami al-Tawarikh, 1314 CE]]\nKhalaf's was imprisoned and sent to Juzjanan. In September 1003, rebellion broke out in Sistan. Sultan Mahmud marched with an army of 10,000 accompanied by his brother Nasr, Altüntāsh, and Abu 'Abdu'llah Muhammad at-Ta'i. The rebels took the fort of Uk. On 15 October 1003, the Ghaznavid forces captured the fort in a surprise attack at night. Many rebels were captured and executed. Mahmud preceded to Ghazna leaving Nasr in charge of Sistan.  Khalaf lived in Juzjanan until 1007, he was moved to Gardez after establishing correspondence with Ilak Nasr Khan who was then war with Ghaznavids. He died at Gardez in 1009, ending the Saffarid dynasty.\nSee also\n* Ghaznavid campaign in Khorasan\nNotes\nReferences\nBibliography\n*\n*\n*\n*"
    }
  ]
}