{
  "content": [
    {
      "type": "text",
      "text": "# MUSCLE (alignment software)\n\n| latest release version = 5.3\n| latest release date =\n| latest preview version =\n| latest preview date =\n| programming language =\n| operating system = Linux, macOS, Windows\n| platform = IA-32, x86-64\n| size =\n| language = English\n| genre = Multiple sequence alignment\n| license = Public domain\n| website =\n| repo =  at GitHub\n| standard =\n| AsOf =\n}}\nMUltiple Sequence Comparison by Log-Expectation (MUSCLE) is a computer software for multiple sequence alignment of protein and nucleotide sequences. It is licensed as public domain. The method was published by Robert C. Edgar in two papers in 2004. The first paper, published in Nucleic Acids Research, introduced the sequence alignment algorithm. The second paper, published in BMC Bioinformatics, presented more technical details. MUSCLE up to version 3 uses a progressive-refinement method. Since version 5 it uses a hidden Markov model similar to ProbCons.\nHistory\nRobert C. Edgar\nEdgar graduated in 1982 from University College London, BSc in Physics, PhD in Particle physics. He pursued software development post-graduation and founded his own company, Parity Software, in 1988. In 2001, he began working with coding algorithms after attending a seminar at the University of California Berkley. From 2001-present day Edgar has contributed to or been the sole creator of multiple software programs, including MUSCLE and USEARCH. He has written a total of 96 papers in the field of computational biology from 2002-present, with his most recent paper being [https://www.biorxiv.org/content/10.1101/2025.03.03.641199v1 Discovery and Validation of Alternatives to VSV-G for Pseudotyping of Lentiviral Vectors for In Vivo Delivery of Anti-Tumor Transgenes]. As of April, 2025, his work has been cited over 143,126 times. The two originally published MUSCLE papers have been cited more than 58,979 times combined. The paper “MUSCLE: multiple sequence alignment with high accuracy and high throughput” has received more than 49,052 citations, while “MUSCLE: a multiple sequence alignment method with reduced time and space complexity” has been cited over 9,936 times.\nMuscle Versions History\n{| class=\"wikitable\"\n|+\n!MUSCLE Vversion\n!Date Published\n!Summary\n!Reference\n|-\n|MUSCLE v1\n|March 1, 2004\n|The method was initially published on March 1, 2004, however this version was already on v3.2. It is to be assumed MUSCLE version v1-v3.1 were unreleased to the public prior to publication as no record of previous versions exist online.\n|[https://pmc.ncbi.nlm.nih.gov/articles/PMC390337/ MUSCLE: multiple sequence alignment with high accuracy and high throughput]\n|-\n|MUSCLE v3.3 & MUSCLE-fast\n|August 19, 2004\n|In the paper [https://link.springer.com/article/10.1186/1471-2105-5-113 MUSCLE: a multiple sequence alignment method with reduced time and space complexity], published on August 19, 2004, a newer of MUSCLE (MUSCLE v3.3), was released alongside MUSCLE-fast. MUSCLE-fast, as the name suggests, was designed specifically for \"high-throughput applications\".\n|[https://link.springer.com/article/10.1186/1471-2105-5-113 MUSCLE: a multiple sequence alignment method with reduced time and space complexity]\n|-\n|MUSCLE v3.6\n|September 2005\n|In September 2005, another release of MUSCLE was published, specifically in the article [https://scholar.google.com/citations?view_op=view_citation&hl=en&user=RzVMRc0AAAAJ&pagesize=80&sortby=pubdate&citation_for_view=RzVMRc0AAAAJ:5nxA0vEk-isC MUSCLE User Guide] (PDF available in the link), which describes how to use the, at the time, latest version of the software, which was v3.6.\n|[https://scholar.google.com/citations?view_op=view_citation&hl=en&user=RzVMRc0AAAAJ&pagesize=80&sortby=pubdate&citation_for_view=RzVMRc0AAAAJ:5nxA0vEk-isC MUSCLE User Guide]\n|-\n|MUSCLE v3.8.31\n|September 15, 2010\n|MUSCLE v3.8.31 was released on September 15, 2010 and was the latest version prior to the release of MUSCLE v5.\n|[https://drive5.com/muscle/downloads_v3.htm MUSCLE 3.8.31 download on Drive5]\n|-\n|MUSCLE v5.0-5.3\n|June 21, 2021\n|MUSCLE v5 was published on June 21, 2021 in the paper [https://www.biorxiv.org/content/10.1101/2021.06.20.449169v1.full MUSCLE v5 enables improved estimates of phylogenetic tree confidence by ensemble bootstrapping]. Since then, v5.1, 5.2, and 5.3 have been released, with all versions accessible through Edgar's website https://drive5.com/software.html.\n|[https://www.biorxiv.org/content/10.1101/2021.06.20.449169v1.full MUSCLE v5 enables improved estimates of phylogenetic tree confidence by ensemble bootstrapping]\n|}\nMuscle5\nOverview\nIn late 2021, Edgar released Muscle5 (also referred to as Muscle v5), an updated version of the MUSCLE software. It introduces several innovations aimed at improving alignment accuracy and reducing bias found in other MSA algorithms. Traditional tools such as Clustal Omega, MAFFT, and earlier versions of MUSCLE rely on progressive alignment strategies that produce a single alignment. Muscle5, in contrast, generates an ensemble of high-accuracy alignments by perturbing a hidden Markov model and permuting its guide tree. At its core, the algorithm is a parallelized reimplementation of ProbCons, and is designed to scale efficiently to large datasets. Muscle5 has demonstrated improved benchmark performance compared to leading MSA methods across several datasets, including BAliBASE, BRAliBASE, and PREFAB.\nEnsembles\nA key innovation in Muscle5 is the use of alignment ensembles, which provide unbiased metrics of confidence in alignments. Each individual MSA (replicate) in the ensemble uses fixed but independently chosen parameters for the hidden Markov model and guide tree, allowing results to be averaged over a diverse set of replicates. This enables biologists to assess how sensitive their downstream analyses are to alignment uncertainty by comparing results across the ensemble.\nOld algorithm\nThe MUSCLE algorithm (before v5) proceeds in three stages: the draft progressive, improved progressive, and refinement stage.\nStage 1: Draft Progressive\nIn this first stage, the algorithm produces a multiple alignment, emphasizing speed over accuracy. This step begins by computing the k-mer distance for every pair of input sequences to create a distance matrix. UPGMA clusters the distance matrix to produce a binary tree. From this tree a progressive alignment is constructed, beginning with the creation of profiles for each leaf of the tree. For every node in the tree, a pairwise alignment is constructed of the two child profiles, creating a new profile to be assigned to that node. This continues until there is a multiple sequence alignment of all input sequences at the root of the tree.\nGiven N input sequences and L as the average sequence length, the time complexity of the draft progressive stage is\nO(N^2 \\cdot L + N \\cdot L^2).\nHere, the pairwise k-mer distance calculation is computed as O(N^2 \\cdot L), and the progressive alignment steps take O(N \\cdot L^2), where O denotes the asymptotic upper bound. The space complexity is O(N \\cdot L) as the algorithm maintains profiles and alignments for each sequence across the tree.\nStage 2: Improved Progressive\nThis stage focuses on obtaining a more optimal tree by calculating the Kimura distance for each pair of input sequences using the multiple sequence alignment obtained in Stage one, and creates a second distance matrix. UPGMA clusters this distance matrix to obtain a second binary tree. A progressive alignment is performed to obtain a multiple sequence alignment like in Stage one, but it is optimized by only computing alignments in subtrees whose branching orders have changed from the first binary tree, resulting in a more accurate alignment.\nRefined alignments are made in the second stage by recalculating a more accurate tree via the Kimura distance. Thus, the algorithm analysis involves the initial subprocedures of pairwise distance calculations and progressive alignment; however, optimizations in computation are made by limiting re-alignment to only those subtrees with altered branching orders. The optimization is thus given as\nO(N^2 \\cdot L + m \\cdot L^2),\nwhere the variable m denotes the number of subtree realignments. Similarly, the space complexity is\nO(N \\cdot L),\nas profiles and alignments for the input sequences are stored for the progressive alignment process.\nStage 3: Refinement\nIn this final stage, an edge is chosen from the second tree, with edges being visited in decreasing distance from the root. The chosen edge is deleted, dividing the tree into two subtrees. The profile of the multiple alignment is then computed for each subtree. A new multiple sequence alignment is produced by re-aligning the subtree profiles. If the SP score is improved, the new alignment is kept, otherwise, it is discarded. The process of deleting an edge and aligning is repeated until convergence, or until a user-defined limit is reached.\nThe time complexity of the refinement stage is given as O(k \\cdot L^2). Here, k denotes the number of edge deletions and L denotes the average sequence length, where re-alignment of the subtree profiles is still the dominant cost per iteration. The space complexity remains the same as given in Stage one and two: O(N \\cdot L). Since the same iterative refinement process occurs, the asymptotic complexity remains polynomial as the dominant term grows linearly with respect to the number of refinement steps.\nIn comparison, the CLUSTALW algorithm includes an optimized iterative refinement step such that selective re-alignment of the tree occurs in order to maximize alignment accuracy without repeating the entire process. The time and space complexity, however, do not change for this optimized iterative refinement step. The time complexity is O(k \\cdot L^2), where k is the number of refinement steps and L is the average alignment length. The space complexity is given as O(N \\cdot L), again, for alignment profiles and sequence data for all N input sequences.\n{| class=\"wikitable\"\n|+ Comparison of Space Complexity and Alignment Accuracy\n! Feature !! CLUSTALW !! MUSCLE v3 Version\n|-\n! Time Complexity\n| O(k \\cdot L^2) || O(k \\cdot L^2)\n|-\n! Alignment Accuracy\n| Moderate || Higher, due to iterative refinement improving SP score\n|}\nAlgorithm Flowchart\nComplexity and Comparison\nIn the first two stages of the algorithm, the time complexity is , the space complexity is . The refinement stage adds to the time complexity another term, . MUSCLE is often used as a replacement for Clustal, since it usually (but not always) gives better sequence alignments. Depending on the chosen options, MUSCLE is significantly faster than Clustal, more so for larger alignments.\nMost modern multiple sequence alignment programs are generally accepted when presenting aligned sequences but there are few differences amongst them. The main difference between programs is the method used to align the sequences. For instance, T-COFFEE and Clustal use the progressive method while MUSCLE and MAFFT perform using the iterative method of alignment. These two methods differ in their ability to handle low similarity sequences with the iterative method providing more accurate results. The other way methods differ is with their computational needs.\nOriginally MUSCLE had middling CPU demands in comparison to other programs but was definitely higher than the progressive methods. Comparisons with modern versions of MSA programs reveal that many are quite similar in capabilities. The alignments were assessed based on their sum of pairs (SP), correctly matching two nucleotides/amino acids across two sequences, and their total columns (TC), matching columns divided by the total columns. In these cases, MUSCLE was average in its ability to maximize matching pairs and columns, being slightly worse than the ProbCons, T-Coffee, Probalign and MAFFT. Outside the alignment scores, MUSCLE was less computationally demanding in both time to execute the alignment and the memory demand.\n{| class=\"wikitable sortable\"\n|+MSA Computational Properties\n!Program\n!Average Alignment Time (sec)\n!Average Memory Usage (Mb)\n!Short Sequence Average SP\n!Short Sequence Average TC\n!Long Sequence Average SP\n!Long Sequence Average TC\n|-\n|MUSCLE\n|301.4\n|60.8\n|0.718\n|0.341\n|0.789\n|0.437\n|-\n|Probalign\n|1410.2\n|162.7\n|0.774\n|0.219\n|0.800\n|0.455\n|-\n|ProbCons\n|1781.7\n|192.5\n|0.763\n|0.220\n|0.831\n|0.524\n|-\n|MAFFT\n|309.0\n|231.6\n|0.767\n|0.421\n|0.803\n|0.470\n|-\n|T-Coffee\n|1964.9\n|372.2\n|0.760\n|0.407\n|0.830\n|0.520\n|}\nIntegration\nMUSCLE is widely supported across multiple bioinformatics platforms. It is fully integrated into software programs such as CodonCode Aligner, DNASTAR's Lasergene, Geneious, and MacVector, and is also available as a plug-in for Sequencher, MEGA, UGENE, and AliView. Users can also access MUSCLE as a web service via the European Molecular Biology Laboratory (EMBL)-European Bioinformatics Institute (EBI) or T-Coffee. MUSCLE can also be downloaded by users on their personal devices via the .\n{| class=\"wikitable\"\n! Platform\n! Integration Type\n! Access Method\n! Source\n|-\n| CodonCode Aligner\n| Built-in\n| Available under Contig → Align with Muscle\n|\n|-\n| Geneious\n| Built-in\n| Available under Align/Assemble → Multiple Align → MUSCLE\n|\n|-\n| DNASTAR Lasergene\n| Built-in\n| Available in MegAlign Pro module under Align → Align using Muscle\n|\n|-\n| MacVector\n| Built-in\n| Found under Align\n|\n|-\n| Sequencher (Gene Codes Corp.)\n| Plug-in\n| Requires installation of MUSCLE plugin; accessed under Assemble → Align Using → Muscle\n|\n|-\n| MEGA\n| Plug-in\n| Found under Alignment Explorer → Align → MUSCLE\n|\n|-\n| UGENE\n| Plug-in\n| Accessible by right-clicking → Align → Align with Muscle\n|\n|-\n| AliView\n| Plug-in\n| Requires installation of MUSCLE plugin; Accessible by Preferences → External Tools → Set path to MUSCLE\n|\n|-\n| EMBL-EBI\n| Web tool\n| Accessible via the [https://www.ebi.ac.uk/Tools/msa/muscle/ MUSCLE Web Interface]\n|\n|-\n| T-Coffee\n| Web tool\n| Accessible via the more options menu and selecting muscle under the methods section\n|\n|}\nSee also\n*Sequence alignment software\n*CodonCode Aligner\n*DNASTAR\n*Clustal\n*ProbCons\n*AMAP\n*T-COFFEE\n*MAFFT\nReferences\nExternal links\n*\n*[http://www.ebi.ac.uk/Tools/muscle/index.html MUSCLE Web Server (EMBL-EBI)]"
    }
  ]
}