{
  "content": [
    {
      "type": "text",
      "text": "# Lagrangian particle tracking__disambig_1\n\nLagrangian particle tracking (LPT) is a method used in fluid mechanics to analyze the motion of particles when subjected to a flow field. It provides a Lagrangian perspective, in which the flow is described by tracking fluid parcels or tracers over time, rather than observing changes at fixed locations as in the Eulerian frame.\nIn experimental studies, LPT is typically performed using three-dimensional particle tracking velocimetry (3D-PTV).\nNeutrally buoyant tracer particles are introduced into the flow, and their positions are recorded using high-speed cameras and stereo reconstruction techniques. The resulting particle paths allow for the study of turbulent structures, transport phenomena, and time-resolved Lagrangian statistics.\nIn computational fluid dynamics, LPT refers to the numerical simulation of discrete particles embedded in a continuous flow field. The fluid phase is typically solved in an Eulerian framework, while the particle phase is resolved using Lagrangian mechanics. This approach, also termed discrete particle simulation (DPS), is particularly suited to situations where particle–fluid coupling is weak, such as dilute multiphase flows (such as aerosols), particle deposition in the human airways, and environmental particle transport. Applications of LPT also include cases where coupling is not negligible, which require more advanced numerical methods such as the discrete element method (DEM). Examples of these cases include industrial mixing, combustion modelling, sprays, and fluidized beds.\nBeyond engineering and turbulence research, LPT has been widely adopted in environmental modelling. Its capacity to resolve particle motion over complex terrain and large scales makes it suitable for studying the dispersion of atmospheric pollutants. In regional air quality assessments, LPT methods have been used for both forward simulations (predicting particle transport from known sources) and inverse modelling (inferring sources from observed concentrations). These techniques have proven effective in identifying transboundary pollution pathways and assessing exposure risks.\nExperimental field\nThe main goal of Lagrangian particle tracking in the experimental field is to extract data about the flow field, such as the flow velocity, acceleration (the material derivative), and pressure fields in the Lagrangian frame.\nExtracting data about the flow field is done by using particle tracking velocimetry (PTV) methods. PTV methods use a lower particle concentration compared to particle image velocimetry (PIV) methods, allowing individual particles in the flow field to be followed. Typical particle image densities for PTV methods are between \\sim 0.005  and  \\sim 0.02 ppp (particles per pixel) while PIV experiments can be performed with higher particle densities.\nIn both PTV and PIV methods, the flow is seeded with neutrally buoyant particles (typically fluid ones in gaseous media and solid ones in fluid media) that are sufficiently small to follow the flow streamlines. This is verified when the Stokes number is sufficiently small, the typical condition being St.\nThe particles are illuminated twice at given intervals, and a high definition camera is used to capture an image each time particles are illuminated. Each pair of images can be elaborated to extract the velocity field. Images are then post-processed to obtain the particles' velocity and positions.\nSeveral PTV methods have been proposed, and their particular setup changes are based on the specific needs of the experiment. The number of cameras used varies between one for the standard 2D-PTV method and up to six in state-of-the-art setups.\nRecent advancement in cameras (high frequency CMOS and CCD sensors), illumination technology (high frequency lasers and scalable LED illumination), calibration (volume self-calibration method), and post-processing algorithms (Shake-the-Box\nand iterative particle reconstruction techniques)\nmake it possible to develop complex setups, such as time-resolved 3D-PTV with particle image densities that reach PIV-level density ( \\sim 0.2  ppp).\nWhen performing PTV experiments, typical difficulties include:\n* Irregular scattering behavior caused by the particles' different sizes, shapes, rotation velocities, and positions with respect to the illumination source\n* Background intensity and light reflection caused by the model, which can diminish the signal-to-noise ratio (SNR)\n* Image distortions due to improper calibration or camera astigmatism, which can lead to non-Gaussian particle imaging, deteriorating the quality of post-processing results\nComputational field\nIn the field of computational fluid dynamics (CFD), Lagrangian particle tracking is typically employed in coupled CFD-DEM simulations. Unlike in experiments, in a CFD simulation a particle's position and velocity are known at a given time instant t^n—its velocity can be interpolated from the velocity of the fluid cell that contains it. Lagrangian particle tracking forecasts in which cell the particle will end at the new time instant t^{n+1}.\nSpecifically, reconstructing the particle's trajectory involves the numerical integration of the ordinary differential equation: \\frac{d\\mathbf{x}}{dt}=\\mathbf{v}(\\mathbf{x})with initial condition \\mathbf{x}(t_n)=\\mathbf{x}^{n}_p .\nAssuming the equation is integrated in time with an explicit integration scheme, the particle's velocity can be interpolated from its cell's velocity and the equation can be integrated, returning \\mathbf{x}^{n+1}_p.\nThis new particle position is then used in the next timestep to advance the equation in time. In order to do that, a tracking algorithm is needed to find the (possibly new) cell whereto the particle has moved at  t^{n+1} .\nUniform grid\nFor simple Cartesian grids, the tracking algorithm is straightforward, as the problem is decoupled along the three directions. The grid coordinates can be directly computed knowing the cell index. With the starting grid point \\mathbf{x_0}=(x_0, y_0, z_0)  and the grid spacing  \\mathbf{\\Delta}=(\\Delta_x,\\Delta_y,\\Delta_z) , the coordinate of the center of cell (i,j,k)  is uniquely identified as:\\begin{cases}\n\\begin{array}{ll}\nx_i = x_0 + i \\cdot \\Delta_x \\quad & \\text{for } i=0:n_x-1 \\\\\ny_i = y_0 + j \\cdot \\Delta_y & \\text{for } j=0:n_y-1 \\\\\nz_i = z_0 + k \\cdot \\Delta_z & \\text{for } k=0:n_z-1 \\\\\n\\end{array}\n\\end{cases}The index of the new surrounding cell of the particle at time  t^{n+1}  can be computed as: \\begin{cases}\ni = \\Big\\lfloor\\frac{x^{n+1}_p-x_0}{\\Delta_x} \\Big\\rceil \\\\\nj = \\Big\\lfloor\\frac{y^{n+1}_p-y_0}{\\Delta_y} \\Big\\rceil  \\\\\nk = \\Big\\lfloor\\frac{z^{n+1}_p-z_0}{\\Delta_z}\\Big\\rceil\n\\end{cases} where \\lfloor\\cdot\\rceil  is the rounding operator.\nRectilinear grid\nIn rectilinear grids, the coordinates of mesh elements at a given index cannot be computed directly and have to be stored explicitly. In rectilinear grids, the coordinates in a given direction only depend on the index in the same direction: x_i=f(i,j,k)=f_x(i) \\quad \\text{for } i=0:n_x-1\nThis allows the problem to decouple in the three directions like the Cartesian grid. Assuming that f_x(i) is a monotonically increasing function, by saving the values f_x(i) in an array X(i) and knowing x^{n+1}_p , the cell index is efficiently found performing a binary search algorithm, whose cost is O(\\log{n}) .\nCurvilinear grid\nCurvilinear grids have the same topological structure of rectilinear grids (i.e. they are \"structured\"), but the location of a cell center in one direction depends on all the three indices of the cell:\n\\begin{cases}\nx_{i,j,k}=f(i,j,k) \\quad & \\text{for } i=0:n_x-1 \\\\\ny_{i,j,k}=g(i,j,k) & \\text{for } j=0:n_y-1 \\\\\nz_{i,j,k}=h(i,j,k) & \\text{for } k=0:n_z-1 \\\\\n\\end{cases}\nAs interpolations and point location algorithms are more complex in curvilinear grids, a common procedure is to transform the physical space (P) in a computational space (C) where the curvilinear grid is mapped to a Cartesian grid.\nBy doing so, the problem falls back to the rectilinear case. To solve the problem in the C-space, the following equation must be solved:\n\\frac{d\\boldsymbol{\\xi}}{dt}=\\boldsymbol{u}(\\boldsymbol{\\xi})\nwhere \\boldsymbol{\\xi}=(\\xi,\\eta,\\zeta)  denotes a position in the computational space. The velocity in the C-space is computed by transforming the velocity in the P-space:\n\\mathbf{u}=\\mathbf{J}^{-1}\\cdot \\mathbf{v}\nwhere \\mathbf{J} is the Jacobian matrix of the transformation that maps the two spaces:\n\\mathbf{J} =\n\\begin{bmatrix}\nx_{\\xi} & x_{\\eta} & x_{\\zeta} \\\\\ny_{\\xi} & y_{\\eta} & y_{\\zeta} \\\\\nz_{\\xi} & z_{\\eta} & z_{\\zeta}\n\\end{bmatrix}\nwhere x_{\\xi} stands for \\frac{dx}{d\\xi} .\nTypically the velocity is not saved to memory in both spaces—rather, it is transformed to C-space when needed to avoid excessive memory usage. The Jacobian is computed locally using finite differences, and the number of different Jacobians used for each cell (e.g. one for each cell or one/multiple for each cell node) significantly affects the operation's precision.\nUnstructured grid\nUnstructured grids pose significant challenges to LPT algorithms, as the grid topology is irregular and needs to be explicitly stored at runtime. Moreover, unstructured grids can be composed of cells of arbitrary shapes, making it complex to develop an efficient location algorithm to check if a position is effectively inside a cell.\nPoint location checks can be simplified using cells of simple shapes, such as triangles or convex quadrilaterals in 2D and tetrahedra in 3D. In this case, the cells are convex and their faces are planar surfaces; therefore, a simplified in-cell-check can be performed by verifying that: (\\mathbf{r}_c -\\mathbf{r}_p) \\cdot \\mathbf{n} \\geqslant 0 where  \\mathbf{r}_c  is the face centroid and  \\mathbf{n}  is the outward normal of the face.\nOnce the new particle position has been computed, the intersection between the particle trajectory and the cell's faces must be computed to deduce the particle's destination cell. If a particle's trajectory crosses a face, the particle is assigned to the neighboring cell. During a single time step, the particle can cross multiple cell faces; therefore, this step can be iterated several times.\nSeveral methods have been proposed to effectively implement Lagrangian particle tracking in unstructured grids. Refined methods include cases with cells that have curved faces, wall reflection, algorithm robustness checks, and improved efficiency by limiting the cell search to only neighbors.\nSee also\n*Computational fluid dynamics\n*Lagrangian and Eulerian specification of the flow field\n*Particle image velocimetry\n*Regular grid\n*Unstructured grid\nReferences\nFurther reading\n*\n*\n*\nExternal links\n* [https://www.openptv.net/ openPTV], an OSS PTV post-processing library\n* [https://perso.univ-rennes1.fr/joris.heyman/trac.html TracTrac], an OSS PTV post-processing library developed by University of Rennes\n* [https://github.com/CFDEMproject/CFDEMcoupling-PUBLIC CFDEM], an OSS CFD-DEM software\n*[https://mfix.netl.doe.gov/products/mfix/ MFIX-DEM], an OSS CFD-DEM software developed by NETL"
    }
  ]
}